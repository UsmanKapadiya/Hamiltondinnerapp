import{u as Q,r as a,j as r,B as x,C as X,T as Z}from"./index-BHNVHtdT.js";import{t as V,C as ee}from"./js.cookie-dTu_y0vz.js";import{H as re,O as oe}from"./Header-Ds1_fXU1.js";import{d as ne,L as te,A as se,D as ie}from"./AdapterDayjs-BVbf_yk6.js";import{T as le,P as ae,c as ce}from"./TextField-rLvJhvSW.js";import{T as pe,a as de,b as me,c as h,d as xe}from"./TableRow-Cqe3UAt0.js";import{T as s}from"./TableCell-Cryf3PTT.js";import{M as _}from"./Tooltip-BpFh1TiE.js";import"./api-De-UYRK6.js";import"./IconButton-BDVsVlra.js";import"./InputAdornment-3yUghm8y.js";const ve=()=>{var g,j,C,k,y,S,D,T,R;const B=Q(),l=V(B.palette.mode),[d,G]=a.useState(ne()),[N,f]=a.useState(!1),[e,W]=a.useState({}),[he,z]=a.useState(!0),[c,u]=a.useState({open:!1,anchorEl:null,text:""});a.useEffect(()=>{(async()=>{try{f(!0);const t=await oe.getCharges(d.format("YYYY-MM-DD"));W(t)}catch(t){console.error("Error fetching menu list:",t)}finally{f(!1)}})()},[d]);const F=o=>{o&&!o.isSame(d,"day")&&G(o),z(!1)};return r.jsxs(x,{m:"20px",children:[r.jsx(re,{title:"Charges Report",profileScreen:!0}),r.jsxs(x,{mt:"40px",height:"75vh",flex:1,sx:{"& .MuiDataGrid-root":{border:"none"},"& .MuiDataGrid-cell":{border:"none"},"& .name-column--cell":{color:l.greenAccent[300]},"& .MuiDataGrid-columnHeaders":{backgroundColor:l.blueAccent[700],borderBottom:"none"},"& .MuiDataGrid-virtualScroller":{backgroundColor:l.primary[400]},"& .MuiDataGrid-footerContainer":{borderTop:"none",backgroundColor:l.blueAccent[700]},"& .MuiCheckbox-root":{color:`${l.greenAccent[200]} !important`},"& .MuiDataGrid-iconSeparator":{color:l.primary[100]}},children:[r.jsx(x,{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2,children:r.jsx(te,{dateAdapter:se,children:r.jsx(ie,{label:"Date",value:d,onChange:F,renderInput:o=>r.jsx(le,{...o,fullWidth:!0,variant:"filled",sx:{gridColumn:"span 1"}})})})}),N?r.jsx(X,{}):r.jsx(pe,{component:ae,children:r.jsxs(de,{sx:{border:"1px solid rgba(224, 224, 224, 1)",borderCollapse:"collapse"},children:[r.jsxs(me,{children:[r.jsxs(h,{sx:{backgroundColor:l.blueAccent[700]},children:[r.jsx(s,{align:"center",sx:{border:"1px solid rgba(224, 224, 224, 1)"},rowSpan:2,children:"#"}),r.jsx(s,{align:"center",sx:{border:"1px solid rgba(224, 224, 224, 1)"},colSpan:((g=e==null?void 0:e.breakfast_item_list)==null?void 0:g.length)||0,children:"Breakfast"}),r.jsx(s,{align:"center",sx:{border:"1px solid rgba(224, 224, 224, 1)"},colSpan:((j=e==null?void 0:e.lunch_item_list)==null?void 0:j.length)||0,children:"Lunch"}),r.jsx(s,{align:"center",sx:{border:"1px solid rgba(224, 224, 224, 1)"},colSpan:((C=e==null?void 0:e.dinner_item_list)==null?void 0:C.length)||0,children:"Dinner"})]}),r.jsxs(h,{sx:{backgroundColor:l.blueAccent[700]},children:[(k=e==null?void 0:e.breakfast_item_list)==null?void 0:k.map((o,t)=>r.jsx(s,{align:"center",sx:{border:"1px solid rgba(224, 224, 224, 1)"},children:r.jsx(_,{title:o.real_item_name,arrow:!0,children:r.jsx("span",{children:o.item_name})})},`breakfast-${t}`)),(y=e==null?void 0:e.lunch_item_list)==null?void 0:y.map((o,t)=>r.jsx(s,{align:"center",sx:{border:"1px solid rgba(224, 224, 224, 1)"},children:r.jsx(_,{title:o.real_item_name,arrow:!0,children:r.jsx("span",{children:o.item_name})})},`lunch-${t}`)),(S=e==null?void 0:e.dinner_item_list)==null?void 0:S.map((o,t)=>r.jsx(s,{align:"center",sx:{border:"1px solid rgba(224, 224, 224, 1)"},children:r.jsx(_,{title:o.real_item_name,arrow:!0,children:r.jsx("span",{children:o.item_name})})},`dinner-${t}`))]})]}),r.jsx(xe,{children:(!(e!=null&&e.report_breakfast_list)||e.report_breakfast_list.length===0)&&(!(e!=null&&e.report_lunch_list)||e.report_lunch_list.length===0)&&(!(e!=null&&e.report_dinner_list)||e.report_dinner_list.length===0)?r.jsx(h,{children:r.jsx(s,{colSpan:1+(((D=e==null?void 0:e.breakfast_item_list)==null?void 0:D.length)||0)+(((T=e==null?void 0:e.lunch_item_list)==null?void 0:T.length)||0)+(((R=e==null?void 0:e.dinner_item_list)==null?void 0:R.length)||0),align:"center",children:"No Report Found"})}):(()=>{var v,L,M;const o=[...((v=e==null?void 0:e.report_breakfast_list)==null?void 0:v.map(n=>n.room_no))||[],...((L=e==null?void 0:e.report_lunch_list)==null?void 0:L.map(n=>n.room_no))||[],...((M=e==null?void 0:e.report_dinner_list)==null?void 0:M.map(n=>n.room_no))||[]];return[...new Set(o)].map(n=>({room_no:n})).map((n,be)=>{var w,E,P;const H=((w=e==null?void 0:e.report_breakfast_list)==null?void 0:w.find(i=>i.room_no===n.room_no))||{data:[]},Y=((E=e==null?void 0:e.report_lunch_list)==null?void 0:E.find(i=>i.room_no===n.room_no))||{data:[]},q=((P=e==null?void 0:e.report_dinner_list)==null?void 0:P.find(i=>i.room_no===n.room_no))||{data:[]};return r.jsxs(h,{children:[r.jsx(s,{align:"center",sx:{border:"1px solid rgba(224, 224, 224, 1)"},children:n.room_no}),[{row:H,itemList:e==null?void 0:e.breakfast_item_list,prefix:"b"},{row:Y,itemList:e==null?void 0:e.lunch_item_list,prefix:"l"},{row:q,itemList:e==null?void 0:e.dinner_item_list,prefix:"d"}].map(({row:i,itemList:I,prefix:K})=>(I||[]).map((b,m)=>{var $;let p=($=i.data)==null?void 0:$[m];const A=i.option&&i.option[m],U=(b==null?void 0:b.real_item_name)||"",J=m>=3&&p>=1;return r.jsx(s,{align:"center",sx:{border:"1px solid rgba(224, 224, 224, 1)"},children:p==null?"-":J?r.jsx("span",{style:{textDecoration:"underline",cursor:"pointer",color:"#1976d2"},onClick:O=>{O.stopPropagation(),u({open:!0,anchorEl:O.currentTarget,text:`${U}${A?` - ${A}`:""}`})},children:p}):p},`${K}-${m}`)}))]},n.room_no)})})()})]})}),r.jsxs(ce,{open:c.open,anchorEl:c.anchorEl,onClose:()=>u({...c,open:!1}),anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},disableEnforceFocus:!0,disableRestoreFocus:!0,disableScrollLock:!0,PaperProps:{sx:{p:2,minWidth:180,maxWidth:300,pointerEvents:"auto",bgcolor:"#e3f2fd",borderRadius:2,boxShadow:3}},children:[r.jsx(Z,{variant:"body2",sx:{fontWeight:500,color:"#1976d2",mb:1},children:c.text}),r.jsx(x,{display:"flex",justifyContent:"flex-end",children:r.jsx(ee,{onClick:()=>u({...c,open:!1}),sx:{background:"#1976d2",color:"#fff",borderRadius:2,padding:"4px 16px",fontWeight:600,fontSize:14,width:"auto",margin:0,"&:hover":{background:"#1565c0",color:"#fff"}},children:"OK"})})]})]})]})};export{ve as default};
