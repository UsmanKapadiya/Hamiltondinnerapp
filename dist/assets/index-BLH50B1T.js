import{c as le,j as n,u as ve,b as Ie,a as we,r as v,B as g,C as Me,T as _}from"./index-BlhyXN4h.js";import{e as ie,H as Ae,O as K,c as Re}from"./Header-J_MDh00G.js";import{t as Se,L as Le,C as T,y as S}from"./js.cookie-D4_0Lw4j.js";import{d as oe,L as We,A as Ee,D as Te}from"./AdapterDayjs-46MJ7ncW.js";import{i as Ne,g as Ye,a as Qe,b as ze,c as V,d as $e,f as X,e as Oe,T as Pe,h as J,j as ae,t as Fe}from"./index-BW9x-iBC.js";import{u as He}from"./useApi-mxuiYqca.js";import{u as Ge}from"./useCommon-DZOERRCT.js";import{_ as ce}from"./lodash-Dn5aD5Mr.js";import{u as Ue}from"./dataProcessors-D3Lgqk_-.js";import{A as Z}from"./ArrowForwardIosOutlined-Ch7ZJOXv.js";import"./TextField-BP0bZSUc.js";import"./api-BysAAf_I.js";import"./IconButton-BWxRuJ-2.js";import"./InputAdornment-CdOpQQ0Y.js";import"./KeyboardArrowRight-CsLg4eU4.js";const Be=le(n.jsx("path",{d:"m14.06 9.02.92.92L5.92 19H5v-.92zM17.66 3c-.25 0-.51.1-.7.29l-1.83 1.83 3.75 3.75 1.83-1.83c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.2-.2-.45-.29-.71-.29m-3.6 3.19L3 17.25V21h3.75L17.81 9.94z"}),"EditOutlined"),Ke=le([n.jsx("circle",{cx:"12",cy:"4",r:"2"},"0"),n.jsx("path",{d:"M15.89 8.11C15.5 7.72 14.83 7 13.53 7h-2.54C8.24 6.99 6 4.75 6 2H4c0 3.16 2.11 5.84 5 6.71V22h2v-6h2v6h2V10.05L18.95 14l1.41-1.41z"},"1")],"EmojiPeopleOutlined"),{breakfastEndHour:$,lunchEndHour:O,dinnerEndHour:Ve}=ae.mealTimes,hn=()=>{var re;const de=ve(),k=Se(de.palette.mode),G=Ie(),P=we(),R=(re=G.state)==null?void 0:re.roomNo,[q,pe]=v.useState(ie),[M,D]=v.useState(oe()),[y,u]=v.useState({}),[F,he]=v.useState([]),[W,H]=v.useState([]),[A,me]=v.useState(1),[x,ge]=v.useState(!1),[c]=Ge("userData",null),I=v.useMemo(()=>Ne(c),[c]),ee=v.useMemo(()=>I?99:Ye(c,R,ae.defaults.maxMealQuantity),[c,R,I]),E=v.useMemo(()=>Qe(M),[M]),w=v.useMemo(()=>ze(M),[M]),N=v.useMemo(()=>E&&V($),[E]),Y=v.useMemo(()=>E&&V(O),[E]),Q=v.useMemo(()=>E&&V(Ve),[E]),{execute:ne,loading:fe}=He((i,d)=>K.getMenuData(i,d),{onSuccess:i=>{const d=Fe(i),s={...d,date:X(M)};he(o=>Ue(o,s)),u(d)},onError:i=>{console.error("Error fetching menu list:",i),S.error("Failed to load menu data")}});v.useEffect(()=>{pe($e(c,ie,Re))},[c]);const ye=v.useCallback(()=>{const i=oe();return i.hour()>O||i.hour()===O&&i.minute()>0?2:i.hour()>$||i.hour()===$&&i.minute()>0?1:0},[]),[L,U]=v.useState(ye());v.useEffect(()=>{me(ee)},[ee]),v.useEffect(()=>{ce.find(W,{date:X(M)})||te(X(M))},[M,W]),v.useEffect(()=>{const i=ce.get(G,"state.Kitchen_summery",!1);ge(i)},[G.state]);const te=v.useCallback(async i=>{const d=Oe(c,R);await ne(d,i)},[c,R,ne]);function _e(i){const d=t=>(t||[]).map(a=>({item_id:a.id,qty:a.qty,order_id:a.order_id||0,preference:(a.preference||[]).filter(l=>l.is_selected).map(l=>l.id).join(","),item_options:(a.options||[]).filter(l=>l.is_selected).map(l=>l.id).join(",")})),s=t=>[...(t.breakfastCategories||[]).flatMap(a=>[...d(a.entreeItems),...d(a.alternativeItems)]),...(t.lunchCategories||[]).flatMap(a=>[...d(a.entreeItems),...d(a.alternativeItems)]),...(t.dinnerCategories||[]).flatMap(a=>[...d(a.entreeItems),...d(a.alternativeItems)])],o=c.rooms.find(t=>t.name===R),h=(o==null?void 0:o.id)||0,p=i.map(t=>{const a=s(t),l=Array.isArray(F)?F.find(m=>m.date===t.date):F.date===t.date?F:null,b=l?s(l):[],C=new Map(b.map(m=>[`${m.item_id}_${m.order_id}`,m])),r=new Map(a.map(m=>[`${m.item_id}_${m.order_id}`,m])),e=[];a.forEach(m=>{const j=`${m.item_id}_${m.order_id}`,z=C.get(j);z?(m.qty!==z.qty||m.preference!==z.preference||m.item_options!==z.item_options)&&(z.qty>0&&m.qty===0?e.push({...m,qty:0,preference:"",item_options:""}):e.push(m)):m.qty>0&&e.push(m)}),b.forEach(m=>{const j=`${m.item_id}_${m.order_id}`;!r.has(j)&&m.qty>0&&e.push({...m,qty:0,preference:"",item_options:""})});const f=t.is_dinner_takeout_service!==(l==null?void 0:l.is_dinner_takeout_service)||t.is_dinner_tray_service!==(l==null?void 0:l.is_dinner_tray_service)||t.is_dinner_escort_service!==(l==null?void 0:l.is_dinner_escort_service)||t.is_brk_tray_service!==(l==null?void 0:l.is_brk_tray_service)||t.is_brk_escort_service!==(l==null?void 0:l.is_brk_escort_service)||t.is_brk_takeout_service!==(l==null?void 0:l.is_brk_takeout_service)||t.is_lunch_tray_service!==(l==null?void 0:l.is_lunch_tray_service)||t.is_lunch_escort_service!==(l==null?void 0:l.is_lunch_escort_service)||t.is_lunch_takeout_service!==(l==null?void 0:l.is_lunch_takeout_service);return e.length===0&&!f?null:{date:t.date,is_brk_tray_service:t.is_brk_tray_service,is_lunch_tray_service:t.is_lunch_tray_service,is_dinner_tray_service:t.is_dinner_tray_service,is_brk_escort_service:t.is_brk_escort_service,is_lunch_escort_service:t.is_lunch_escort_service,is_dinner_escort_service:t.is_dinner_escort_service,is_brk_takeout_service:t.is_brk_takeout_service,is_lunch_takeout_service:t.is_lunch_takeout_service,is_dinner_takeout_service:t.is_dinner_takeout_service,items:e}}).filter(Boolean);return{current_date:i.length?i[i.length-1].date:"",room_id:h,orders_to_change:JSON.stringify(p)}}function se(i,d,s){const o=s,h=i.findIndex(p=>(p==null?void 0:p.date)===o);if(h!==-1){const p=[...i];return p[h]={...d},p}else return[...i,d]}const B=async(i,d)=>{try{const s={...i,date:d.format("YYYY-MM-DD")};H(t=>{const a=se(t,s,d),l=[],b=new Set;for(let C=a.length-1;C>=0;C--){const r=a[C].date;b.has(r)||(l.unshift(a[C]),b.add(r))}return l});const o=se(W,s,d.format("YYYY-MM-DD")),h=_e(o,d);let p=await K.submitOrder(h);p.ResponseText==="success"?(H([]),te(d.format("YYYY-MM-DD")),S.success("Order submitted successfully!")):S.error(p.ResponseText||"Order submission failed.")}catch(s){S.error("An error occurred while submitting the order."),console.error(s)}},ue=async i=>{var d,s,o;if((d=i==null?void 0:i.selectedUser)!=null&&d.id)try{const h=((i==null?void 0:i.specialInstruction)??"").toString().trim(),p=((i==null?void 0:i.foodTexture)??"").toString().trim(),t=await K.updateRoomDetails(i.selectedUser.id,h,p);t.ResponseCode==="1"?S.success((t==null?void 0:t.ResponseText)||"Room Details Updated Successfully"):S.error(t.ResponseText||"Room Details Update failed. Please try again.")}catch(h){console.error("Error processing Room Details Update failed:",h);const p=((o=(s=h==null?void 0:h.response)==null?void 0:s.data)==null?void 0:o.error)||"An unexpected error occurred. Please try again.";S.error(p)}else S.error("No user selected for room update.")},xe=()=>{const i=M.format("YYYY-MM-DD"),d=R||(c==null?void 0:c.room_id);P("/guestOrder",{state:{roomNo:d,selectedDate:i}})};function be(i){const d=i;return d.hour()>O||d.hour()===O&&d.minute()>0?2:d.hour()>$||d.hour()===$&&d.minute()>0?1:0}const je=i=>{const d=M.format("YYYY-MM-DD");let s=W==null?void 0:W.find(o=>o.date===i.format("YYYY-MM-DD"));s!==void 0?(U(be(i)),y.date=d,H(o=>{const h=o.findIndex(p=>(p==null?void 0:p.date)===d);if(h!==-1){const p=[...o];return p[h]={...y},p}else return[...o,y]}),u(s),D(i)):(U(0),D(i),y.date=d,H(o=>[...o,y]))},Ce=(c==null?void 0:c.breakfast_guideline)&&y.breakfastCategories&&y.breakfastCategories.length>0,qe=(c==null?void 0:c.lunch_guideline)&&y.lunchCategories&&y.lunchCategories.length>0,ke=(c==null?void 0:c.dinner_guideline)&&y.dinnerCategories&&y.dinnerCategories.length>0;return n.jsxs(g,{m:"20px",children:[n.jsx(Ae,{title:x?"Kitchen Summary ":R||(c==null?void 0:c.room_id),icon:"",editRoomsDetails:(c==null?void 0:c.role)!=="kitchen",editIcon:n.jsx(Be,{}),isGuest:!x,handleGuestClick:xe,isGuestIcon:n.jsx(Ke,{}),handleRoomUpdate:ue,profileScreen:!0}),n.jsx(Le,{}),n.jsxs(g,{mt:"40px",height:"75vh",flex:1,sx:{"& .MuiDataGrid-root":{border:"none"},"& .MuiDataGrid-cell":{border:"none"},"& .name-column--cell":{color:k.greenAccent[300]},"& .MuiDataGrid-columnHeaders":{backgroundColor:k.blueAccent[700],borderBottom:"none"},"& .MuiDataGrid-virtualScroller":{backgroundColor:k.primary[400]},"& .MuiDataGrid-footerContainer":{borderTop:"none",backgroundColor:k.blueAccent[700]},"& .MuiCheckbox-root":{color:`${k.greenAccent[200]} !important`},"& .MuiDataGrid-iconSeparator":{color:k.primary[100]}},children:[n.jsx(g,{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2,children:n.jsx(We,{dateAdapter:Ee,adapterLocale:(c==null?void 0:c.langCode)==="cn"?"zh-cn":"en",children:n.jsx(Te,{label:"Date",value:M,onChange:je,renderInput:i=>n.jsx(TextField,{...i,fullWidth:!0,variant:"filled",sx:{gridColumn:"span 1"}})})})}),fe?n.jsx(Me,{}):n.jsxs(n.Fragment,{children:[n.jsxs(Pe,{value:L,onChange:(i,d)=>U(d),indicatorColor:"primary",textColor:"primary",sx:{mb:2},children:[n.jsx(J,{label:q.brk}),n.jsx(J,{label:q.lunch}),n.jsx(J,{label:q.dnr})]}),L===0&&n.jsxs(g,{children:[Array.isArray(y.breakfastCategories)&&y.breakfastCategories.map((i,d)=>n.jsxs(g,{mb:3,children:[n.jsx(_,{variant:"h6",sx:{mb:2,fontWeight:600,backgroundColor:"#f5f5f5",px:2,py:1,borderRadius:1,textAlign:"center"},children:(c==null?void 0:c.langCode)==="cn"&&i.cat_name_cn&&i.cat_name_cn.trim()!==""?i.cat_name_cn:i.cat_name}),i.entreeItems.map(s=>n.jsxs(g,{mb:1,children:[n.jsxs(g,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[n.jsxs(g,{display:"flex",alignItems:"center",children:[s.image&&n.jsx("img",{src:s.image,alt:(c==null?void 0:c.langCode)==="cn"&&s.chinese_name?s.chinese_name:s.name,style:{width:64,height:64,objectFit:"cover",borderRadius:8,marginRight:12}}),n.jsx(_,{children:(c==null?void 0:c.langCode)==="cn"&&s.chinese_name?s.chinese_name:s.name})]}),n.jsxs(g,{display:"flex",alignItems:"center",children:[!x&&n.jsx("button",{onClick:()=>u(o=>({...o,breakfastCategories:o.breakfastCategories.map((h,p)=>p===d?{...h,entreeItems:h.entreeItems.map(t=>{if(t.id===s.id){const a=Math.max((t.qty||0)-1,0);return{...t,qty:a,options:(t.options||[]).length>0&&a===0?t.options.map((l,b)=>({...l,is_selected:b===0?1:0})):t.options,preference:(t.preference||[]).length>0&&a===0?t.preference.map(l=>({...l,is_selected:0})):t.preference}}return(t.qty||0)===0?{...t,options:(t.options||[]).length>0?t.options.map((a,l)=>({...a,is_selected:l===0?1:0})):t.options,preference:(t.preference||[]).length>0?t.preference.map(a=>({...a,is_selected:0})):t.preference}:t})}:h)})),style:{marginRight:8},disabled:s.qty===0||!I&&(w||N),children:"-"}),n.jsx(_,{sx:x?{fontSize:24,fontWeight:700}:{},children:s.qty||0}),!x&&n.jsx("button",{onClick:()=>{u(o=>{var a,l,b,C;const h=(((l=(a=o.breakfastCategories[d])==null?void 0:a.entreeItems)==null?void 0:l.reduce((r,e)=>r+(e.qty||0),0))||0)+(((C=(b=o.breakfastCategories[d])==null?void 0:b.alternativeItems)==null?void 0:C.reduce((r,e)=>r+(e.qty||0),0))||0);let p=[...o.breakfastCategories[d].entreeItems],t=[...o.breakfastCategories[d].alternativeItems||[]];if((c==null?void 0:c.role)!=="kitchen"&&h>=A){let r=!1;t=t.map(e=>{if(!r&&e.qty>0){r=!0;const f=e.qty-1;return{...e,qty:f,options:(e.options||[]).length>0&&e.qty>0&&f===0?e.options.map((m,j)=>({...m,is_selected:j===0?1:0})):e.options,preference:(e.preference||[]).length>0&&e.qty>0&&f===0?e.preference.map(m=>({...m,is_selected:0})):e.preference}}return e}),r||(p=p.map(e=>{if(!r&&e.id!==s.id&&e.qty>0){r=!0;const f=e.qty-1;return{...e,qty:f,options:(e.options||[]).length>0&&e.qty>0&&f===0?e.options.map((m,j)=>({...m,is_selected:j===0?1:0})):e.options,preference:(e.preference||[]).length>0&&e.qty>0&&f===0?e.preference.map(m=>({...m,is_selected:0})):e.preference}}return e}))}return p=p.map(r=>r.id===s.id?{...r,qty:(r.qty||0)+1,options:(r.options||[]).length>0&&(r.qty||0)===0?r.options.map((e,f)=>({...e,is_selected:f===0?1:0})):r.options,preference:(r.preference||[]).length>0&&(r.qty||0)===0?r.preference.map(e=>({...e,is_selected:0})):r.preference}:r),{...o,breakfastCategories:o.breakfastCategories.map((r,e)=>e===d?{...r,entreeItems:p,alternativeItems:t}:r)}})},style:{marginLeft:8},disabled:s.qty>=A||!I&&(w||N),children:"+"})]})]}),n.jsx(g,{mt:2,ml:1,sx:{width:"100%",minHeight:s.qty>0?"auto":0},children:s.qty>0&&n.jsxs(g,{mt:2,ml:1,sx:{width:"100%"},children:[s.options&&s.options.length>0&&n.jsx(g,{mb:1,children:s.options.map(o=>n.jsxs("label",{style:{marginRight:12},children:[n.jsx("input",{type:"radio",name:`breakfast-entree-option-${i.cat_id}-${s.id}`,checked:!!o.is_selected,onChange:()=>{u(h=>({...h,breakfastCategories:h.breakfastCategories.map((p,t)=>t===d?{...p,entreeItems:p.entreeItems.map(a=>a.id===s.id?{...a,options:a.options.map(l=>l.id===o.id?{...l,is_selected:1}:{...l,is_selected:0})}:a)}:p)}))}}),n.jsx("span",{style:{marginLeft:5},children:o.name})]},o.id))}),s.preference&&s.preference.length>0&&n.jsxs(g,{children:[n.jsx(_,{sx:{fontWeight:700,fontSize:18},children:"* Preference"}),s.preference.map(o=>n.jsxs("label",{style:{marginRight:12},children:[n.jsx("input",{type:"checkbox",checked:!!o.is_selected,onChange:()=>{u(h=>({...h,breakfastCategories:h.breakfastCategories.map((p,t)=>t===d?{...p,entreeItems:p.entreeItems.map(a=>a.id===s.id?{...a,preference:a.preference.map(l=>l.id===o.id?{...l,is_selected:l.is_selected?0:1}:l)}:a)}:p)}))}}),n.jsx("span",{style:{marginLeft:5},children:o.name})]},o.id))]})]})})]},s.id)),i.alternativeCatName&&n.jsx(_,{variant:"subtitle1",sx:{mt:3,mb:2,fontWeight:700},children:(c==null?void 0:c.langCode)==="cn"&&i.alternativeCatName_cn&&i.alternativeCatName_cn.trim()!==""?i.alternativeCatName_cn:i.alternativeCatName}),i.alternativeItems.map(s=>n.jsxs(g,{mb:1,ml:2,children:[n.jsxs(g,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[n.jsxs(g,{display:"flex",alignItems:"center",children:[s.image&&n.jsx("img",{src:s.image,alt:(c==null?void 0:c.langCode)==="cn"&&s.chinese_name?s.chinese_name:s.name,style:{width:64,height:64,objectFit:"cover",borderRadius:8,marginRight:12}}),n.jsx(_,{children:(c==null?void 0:c.langCode)==="cn"&&s.chinese_name?s.chinese_name:s.name})]}),n.jsxs(g,{display:"flex",alignItems:"center",children:[!x&&n.jsx("button",{onClick:()=>u(o=>({...o,breakfastCategories:o.breakfastCategories.map((h,p)=>p===d?{...h,alternativeItems:h.alternativeItems.map(t=>t.id===s.id?{...t,qty:Math.max((t.qty||0)-1,0),options:(t.options||[]).length>0&&Math.max((t.qty||0)-1,0)===0?t.options.map((a,l)=>({...a,is_selected:l===0?1:0})):t.options,preference:(t.preference||[]).length>0&&Math.max((t.qty||0)-1,0)===0?t.preference.map(a=>({...a,is_selected:0})):t.preference}:t)}:h)})),style:{marginRight:8},disabled:s.qty===0||!I&&(w||N),children:"-"}),n.jsx(_,{sx:x?{fontSize:24,fontWeight:700}:{},children:s.qty||0}),!x&&n.jsx("button",{onClick:()=>{u(o=>{var a,l,b,C;const h=(((l=(a=o.breakfastCategories[d])==null?void 0:a.entreeItems)==null?void 0:l.reduce((r,e)=>r+(e.qty||0),0))||0)+(((C=(b=o.breakfastCategories[d])==null?void 0:b.alternativeItems)==null?void 0:C.reduce((r,e)=>r+(e.qty||0),0))||0);let p=[...o.breakfastCategories[d].alternativeItems],t=[...o.breakfastCategories[d].entreeItems||[]];if(h>=A){let r=!1;t=t.map(e=>{if(!r&&e.qty>0){r=!0;const f=e.qty-1;return{...e,qty:f,options:(e.options||[]).length>0&&e.qty>0&&f===0?e.options.map((m,j)=>({...m,is_selected:j===0?1:0})):e.options,preference:(e.preference||[]).length>0&&e.qty>0&&f===0?e.preference.map(m=>({...m,is_selected:0})):e.preference}}return e}),r||(p=p.map(e=>{if(!r&&e.id!==s.id&&e.qty>0){r=!0;const f=e.qty-1;return{...e,qty:f,options:(e.options||[]).length>0&&e.qty>0&&f===0?e.options.map((m,j)=>({...m,is_selected:j===0?1:0})):e.options,preference:(e.preference||[]).length>0&&e.qty>0&&f===0?e.preference.map(m=>({...m,is_selected:0})):e.preference}}return e}))}return p=p.map(r=>r.id===s.id?{...r,qty:(r.qty||0)+1,options:(r.options||[]).length>0&&(r.qty||0)===0?r.options.map((e,f)=>({...e,is_selected:f===0?1:0})):r.options,preference:(r.preference||[]).length>0&&(r.qty||0)===0?r.preference.map(e=>({...e,is_selected:0})):r.preference}:r),{...o,breakfastCategories:o.breakfastCategories.map((r,e)=>e===d?{...r,entreeItems:t,alternativeItems:p}:r)}})},style:{marginLeft:8},disabled:s.qty>=A||!I&&(w||N),children:"+"})]})]}),n.jsx(g,{mt:2,ml:1,sx:{width:"100%",minHeight:s.qty>0?"auto":0},children:s.qty>0&&n.jsxs(g,{mt:2,ml:1,children:[s.options&&s.options.length>0&&n.jsx(g,{mb:1,children:s.options.map(o=>n.jsxs("label",{style:{marginRight:12},children:[n.jsx("input",{type:"radio",name:`breakfast-alt-option-${i.cat_id}-${s.id}`,checked:!!o.is_selected,onChange:()=>{u(h=>({...h,breakfastCategories:h.breakfastCategories.map((p,t)=>t===d?{...p,alternativeItems:p.alternativeItems.map(a=>a.id===s.id?{...a,options:a.options.map(l=>l.id===o.id?{...l,is_selected:1}:{...l,is_selected:0})}:a)}:p)}))}}),n.jsx("span",{style:{marginLeft:5},children:o.name})]},o.id))}),s.preference&&s.preference.length>0&&n.jsxs(g,{children:[n.jsx(_,{sx:{fontWeight:700,fontSize:18},children:"* Preference"}),s.preference.map(o=>n.jsxs("label",{style:{marginRight:12},children:[n.jsx("input",{type:"checkbox",checked:!!o.is_selected,onChange:()=>{u(h=>({...h,breakfastCategories:h.breakfastCategories.map((p,t)=>t===d?{...p,alternativeItems:p.alternativeItems.map(a=>a.id===s.id?{...a,preference:a.preference.map(l=>l.id===o.id?{...l,is_selected:l.is_selected?0:1}:l)}:a)}:p)}))}}),n.jsx("span",{style:{marginLeft:5},children:o.name})]},o.id))]})]})})]},s.id))]},i.cat_id)),Array.isArray(y.breakfastCategories)&&y.breakfastCategories.some(i=>i.entreeItems&&i.entreeItems.some(d=>d.qty>0)||i.alternativeItems&&i.alternativeItems.some(d=>d.qty>0))&&!x&&n.jsx(g,{mt:3,display:"flex",gap:2,children:[{key:"is_brk_tray_service",label:q.trayService},{key:"is_brk_escort_service",label:q.escortService},{key:"is_brk_takeout_service",label:q.Takeout}].map(i=>n.jsxs("label",{style:{display:"flex",alignItems:"center"},children:[n.jsx("input",{type:"checkbox",checked:y[i.key]===1,onChange:()=>{u(d=>({...d,is_brk_tray_service:0,is_brk_escort_service:0,is_brk_takeout_service:0,[i.key]:d[i.key]===1?0:1}))}}),n.jsx("span",{style:{marginLeft:5},children:i.label})]},i.key))}),Ce&&n.jsxs(n.Fragment,{children:[n.jsx("hr",{}),n.jsx(_,{variant:"subtitle1",sx:{fontWeight:600,mb:1},children:(c==null?void 0:c.langCode)==="cn"&&(c!=null&&c.breakfast_guideline_cn)&&(c==null?void 0:c.breakfast_guideline_cn.trim())!==""?c==null?void 0:c.breakfast_guideline_cn:c==null?void 0:c.breakfast_guideline})]}),Array.isArray(y.breakfastCategories)&&y.breakfastCategories.length===0&&n.jsx(_,{variant:"subtitle1",sx:{fontWeight:600,mb:1},children:q.breakFasrMenuWarn}),x&&n.jsx(g,{mt:3,display:"flex",justifyContent:"center",children:n.jsx(T,{onClick:()=>P("/report"),endIcon:n.jsx(Z,{}),sx:{bgcolor:k.blueAccent[50],color:k.blueAccent[700],"&:hover":{bgcolor:k.blueAccent[100],color:k.blueAccent[800]},padding:"10px 32px",boxShadow:"none",borderRadius:"30px",border:"none",borderRadius:4,fontWeight:600,fontSize:16,cursor:"pointer",width:"auto"},children:q.viewReport})}),L===0&&Array.isArray(y.breakfastCategories)&&y.breakfastCategories.some(i=>i.entreeItems&&i.entreeItems.some(d=>d.qty>0)||i.alternativeItems&&i.alternativeItems.some(d=>d.qty>0))&&!x&&n.jsx(g,{mt:3,display:"flex",justifyContent:"center",children:n.jsx(T,{sx:{padding:"10px 32px",bgcolor:k.blueAccent[700],color:"#fcfcfc",border:"none",borderRadius:4,fontWeight:600,fontSize:16,cursor:"pointer",width:"auto"},disabled:!I&&(w||N),onClick:()=>{B(y,M)},children:q.submit})})]}),L===1&&n.jsxs(g,{children:[Array.isArray(y.lunchCategories)&&y.lunchCategories.map((i,d)=>n.jsxs(g,{mb:3,children:[n.jsxs(_,{variant:"h6",sx:{mb:2,fontWeight:600,backgroundColor:"#f5f5f5",px:2,py:1,borderRadius:1,textAlign:"center"},children:[(c==null?void 0:c.langCode)==="cn"&&i.cat_name_cn&&i.cat_name_cn.trim()!==""?i.cat_name_cn:i.cat_name,i.cat_name==="LUNCH ENTREE"&&` (${q.servedWithSoup})`]}),i.entreeItems.map(s=>n.jsxs(g,{mb:1,children:[n.jsxs(g,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[n.jsxs(g,{display:"flex",alignItems:"center",children:[s.image&&n.jsx("img",{src:s.image,alt:(c==null?void 0:c.langCode)==="cn"&&s.chinese_name?s.chinese_name:s.name,style:{width:64,height:64,objectFit:"cover",borderRadius:8,marginRight:12}}),n.jsx(_,{children:(c==null?void 0:c.langCode)==="cn"&&s.chinese_name?s.chinese_name:s.name})]}),n.jsxs(g,{display:"flex",alignItems:"center",children:[!x&&n.jsx("button",{onClick:()=>u(o=>({...o,lunchCategories:o.lunchCategories.map((h,p)=>p===d?{...h,entreeItems:h.entreeItems.map(t=>{if(t.id===s.id){const a=Math.max((t.qty||0)-1,0);return{...t,qty:a,options:(t.options||[]).length>0&&a===0?t.options.map((l,b)=>({...l,is_selected:b===0?1:0})):t.options,preference:(t.preference||[]).length>0&&a===0?t.preference.map(l=>({...l,is_selected:0})):t.preference}}return(t.qty||0)===0?{...t,options:(t.options||[]).length>0?t.options.map((a,l)=>({...a,is_selected:l===0?1:0})):t.options,preference:(t.preference||[]).length>0?t.preference.map(a=>({...a,is_selected:0})):t.preference}:t})}:h)})),style:{marginRight:8},disabled:s.qty===0||!I&&(w||Y),children:"-"}),n.jsx(_,{sx:x?{fontSize:24,fontWeight:700}:{},children:s.qty||0}),!x&&n.jsx("button",{onClick:()=>{u(o=>{var a,l,b,C;const h=(((l=(a=o.lunchCategories[d])==null?void 0:a.entreeItems)==null?void 0:l.reduce((r,e)=>r+(e.qty||0),0))||0)+(((C=(b=o.lunchCategories[d])==null?void 0:b.alternativeItems)==null?void 0:C.reduce((r,e)=>r+(e.qty||0),0))||0);let p=[...o.lunchCategories[d].entreeItems],t=[...o.lunchCategories[d].alternativeItems||[]];if((c==null?void 0:c.role)!=="kitchen"&&h>=A){let r=!1;t=t.map(e=>{if(!r&&e.qty>0){r=!0;const f=e.qty-1;return{...e,qty:f,options:(e.options||[]).length>0&&e.qty>0&&f===0?e.options.map((m,j)=>({...m,is_selected:j===0?1:0})):e.options,preference:(e.preference||[]).length>0&&e.qty>0&&f===0?e.preference.map(m=>({...m,is_selected:0})):e.preference}}return e}),r||(p=p.map(e=>{if(!r&&e.id!==s.id&&e.qty>0){r=!0;const f=e.qty-1;return{...e,qty:f,options:(e.options||[]).length>0&&e.qty>0&&f===0?e.options.map((m,j)=>({...m,is_selected:j===0?1:0})):e.options,preference:(e.preference||[]).length>0&&e.qty>0&&f===0?e.preference.map(m=>({...m,is_selected:0})):e.preference}}return e}))}return p=p.map(r=>r.id===s.id?{...r,qty:(r.qty||0)+1,options:(r.options||[]).length>0&&(r.qty||0)===0?r.options.map((e,f)=>({...e,is_selected:f===0?1:0})):r.options,preference:(r.preference||[]).length>0&&(r.qty||0)===0?r.preference.map(e=>({...e,is_selected:0})):r.preference}:r),{...o,lunchCategories:o.lunchCategories.map((r,e)=>e===d?{...r,entreeItems:p,alternativeItems:t}:r)}})},style:{marginLeft:8},disabled:s.qty>=A||!I&&(w||Y),children:"+"})]})]}),n.jsx(g,{mt:2,ml:1,sx:{width:"100%",minHeight:s.qty>0?"auto":0},children:s.qty>0&&n.jsxs(g,{mt:2,ml:1,sx:{width:"100%"},children:[s.options&&s.options.length>0&&n.jsx(g,{mb:1,children:s.options.map(o=>n.jsxs("label",{style:{marginRight:12},children:[n.jsx("input",{type:"radio",name:`lunch-entree-option-${i.cat_id}-${s.id}`,checked:!!o.is_selected,onChange:()=>{u(h=>({...h,lunchCategories:h.lunchCategories.map((p,t)=>t===d?{...p,entreeItems:p.entreeItems.map(a=>a.id===s.id?{...a,options:a.options.map(l=>l.id===o.id?{...l,is_selected:1}:{...l,is_selected:0})}:a)}:p)}))}}),n.jsx("span",{style:{marginLeft:5},children:o.name})]},o.id))}),s.preference&&s.preference.length>0&&n.jsxs(g,{children:[n.jsx(_,{sx:{fontWeight:700,fontSize:18},children:"* Preference"}),s.preference.map(o=>n.jsxs("label",{style:{marginRight:12},children:[n.jsx("input",{type:"checkbox",checked:!!o.is_selected,onChange:()=>{u(h=>({...h,lunchCategories:h.lunchCategories.map((p,t)=>t===d?{...p,entreeItems:p.entreeItems.map(a=>a.id===s.id?{...a,preference:a.preference.map(l=>l.id===o.id?{...l,is_selected:l.is_selected?0:1}:l)}:a)}:p)}))}}),n.jsx("span",{style:{marginLeft:5},children:o.name})]},o.id))]})]})})]},s.id)),i.alternativeCatName&&n.jsx(_,{variant:"subtitle1",sx:{mt:3,mb:2,fontWeight:700},children:(c==null?void 0:c.langCode)==="cn"&&i.alternativeCatName_cn&&i.alternativeCatName_cn.trim()!==""?i.alternativeCatName_cn:i.alternativeCatName}),i.alternativeItems.map(s=>n.jsxs(g,{mb:1,ml:2,children:[n.jsxs(g,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[n.jsxs(g,{display:"flex",alignItems:"center",children:[s.image&&n.jsx("img",{src:s.image,alt:(c==null?void 0:c.langCode)==="cn"&&s.chinese_name?s.chinese_name:s.name,style:{width:64,height:64,objectFit:"cover",borderRadius:8,marginRight:12}}),n.jsx(_,{children:(c==null?void 0:c.langCode)==="cn"&&s.chinese_name?s.chinese_name:s.name})]}),n.jsxs(g,{display:"flex",alignItems:"center",children:[!x&&n.jsx("button",{onClick:()=>u(o=>({...o,lunchCategories:o.lunchCategories.map((h,p)=>p===d?{...h,alternativeItems:h.alternativeItems.map(t=>t.id===s.id?{...t,qty:Math.max((t.qty||0)-1,0),options:(t.options||[]).length>0&&Math.max((t.qty||0)-1,0)===0?t.options.map((a,l)=>({...a,is_selected:l===0?1:0})):t.options,preference:(t.preference||[]).length>0&&Math.max((t.qty||0)-1,0)===0?t.preference.map(a=>({...a,is_selected:0})):t.preference}:t)}:h)})),style:{marginRight:8},disabled:s.qty===0||!I&&(w||Y),children:"-"}),n.jsx(_,{sx:x?{fontSize:24,fontWeight:700}:{},children:s.qty||0}),!x&&n.jsx("button",{onClick:()=>{u(o=>{var a,l,b,C;const h=(((l=(a=o.lunchCategories[d])==null?void 0:a.entreeItems)==null?void 0:l.reduce((r,e)=>r+(e.qty||0),0))||0)+(((C=(b=o.lunchCategories[d])==null?void 0:b.alternativeItems)==null?void 0:C.reduce((r,e)=>r+(e.qty||0),0))||0);let p=[...o.lunchCategories[d].alternativeItems],t=[...o.lunchCategories[d].entreeItems||[]];if(h>=A){let r=!1;t=t.map(e=>{if(!r&&e.qty>0){r=!0;const f=e.qty-1;return{...e,qty:f,options:(e.options||[]).length>0&&e.qty>0&&f===0?e.options.map((m,j)=>({...m,is_selected:j===0?1:0})):e.options,preference:(e.preference||[]).length>0&&e.qty>0&&f===0?e.preference.map(m=>({...m,is_selected:0})):e.preference}}return e}),r||(p=p.map(e=>{if(!r&&e.id!==s.id&&e.qty>0){r=!0;const f=e.qty-1;return{...e,qty:f,options:(e.options||[]).length>0&&e.qty>0&&f===0?e.options.map((m,j)=>({...m,is_selected:j===0?1:0})):e.options,preference:(e.preference||[]).length>0&&e.qty>0&&f===0?e.preference.map(m=>({...m,is_selected:0})):e.preference}}return e}))}return p=p.map(r=>r.id===s.id?{...r,qty:(r.qty||0)+1,options:(r.options||[]).length>0&&(r.qty||0)===0?r.options.map((e,f)=>({...e,is_selected:f===0?1:0})):r.options,preference:(r.preference||[]).length>0&&(r.qty||0)===0?r.preference.map(e=>({...e,is_selected:0})):r.preference}:r),{...o,lunchCategories:o.lunchCategories.map((r,e)=>e===d?{...r,entreeItems:t,alternativeItems:p}:r)}})},style:{marginLeft:8},disabled:s.qty>=A||!I&&(w||Y),children:"+"})]})]}),n.jsx(g,{mt:2,ml:1,sx:{width:"100%",minHeight:s.qty>0?"auto":0},children:s.qty>0&&n.jsxs(g,{mt:2,ml:1,children:[s.options&&s.options.length>0&&n.jsx(g,{mb:1,children:s.options.map(o=>n.jsxs("label",{style:{marginRight:12},children:[n.jsx("input",{type:"radio",name:`lunch-alt-option-${i.cat_id}-${s.id}`,checked:!!o.is_selected,onChange:()=>{u(h=>({...h,lunchCategories:h.lunchCategories.map((p,t)=>t===d?{...p,alternativeItems:p.alternativeItems.map(a=>a.id===s.id?{...a,options:a.options.map(l=>l.id===o.id?{...l,is_selected:1}:{...l,is_selected:0})}:a)}:p)}))}}),n.jsx("span",{style:{marginLeft:5},children:o.name})]},o.id))}),s.preference&&s.preference.length>0&&n.jsxs(g,{children:[n.jsx(_,{sx:{fontWeight:700,fontSize:18},children:"* Preference"}),s.preference.map(o=>n.jsxs("label",{style:{marginRight:12},children:[n.jsx("input",{type:"checkbox",checked:!!o.is_selected,onChange:()=>{u(h=>({...h,lunchCategories:h.lunchCategories.map((p,t)=>t===d?{...p,alternativeItems:p.alternativeItems.map(a=>a.id===s.id?{...a,preference:a.preference.map(l=>l.id===o.id?{...l,is_selected:l.is_selected?0:1}:l)}:a)}:p)}))}}),n.jsx("span",{style:{marginLeft:5},children:o.name})]},o.id))]})]})})]},s.id))]},i.cat_id)),Array.isArray(y.lunchCategories)&&y.lunchCategories.some(i=>i.entreeItems&&i.entreeItems.some(d=>d.qty>0)||i.alternativeItems&&i.alternativeItems.some(d=>d.qty>0))&&!x&&n.jsx(g,{mt:3,display:"flex",gap:3,children:[{key:"is_lunch_tray_service",label:q.trayService},{key:"is_lunch_escort_service",label:q.escortService},{key:"is_lunch_takeout_service",label:q.Takeout}].map(i=>n.jsxs("label",{style:{display:"flex",alignItems:"center"},children:[n.jsx("input",{type:"checkbox",checked:y[i.key]===1,onChange:()=>{u(d=>({...d,is_lunch_tray_service:0,is_lunch_escort_service:0,is_lunch_takeout_service:0,[i.key]:d[i.key]===1?0:1}))}}),n.jsx("span",{style:{marginLeft:5},children:i.label})]},i.key))}),qe&&n.jsxs(n.Fragment,{children:[n.jsx("hr",{}),n.jsx(_,{variant:"subtitle1",sx:{fontWeight:600,mb:1},children:(c==null?void 0:c.langCode)==="cn"&&(c!=null&&c.lunch_guideline_cn)&&(c==null?void 0:c.lunch_guideline_cn.trim())!==""?c==null?void 0:c.lunch_guideline_cn:c==null?void 0:c.lunch_guideline})]}),Array.isArray(y.lunchCategories)&&y.lunchCategories.length===0&&n.jsx(_,{variant:"subtitle1",sx:{fontWeight:600,mb:1},children:q.lunchMenuWarn}),x&&n.jsx(g,{mt:3,display:"flex",justifyContent:"center",children:n.jsx(T,{onClick:()=>P("/report"),endIcon:n.jsx(Z,{}),sx:{bgcolor:k.blueAccent[50],color:k.blueAccent[700],"&:hover":{bgcolor:k.blueAccent[100],color:k.blueAccent[800]},padding:"10px 32px",boxShadow:"none",borderRadius:"30px",border:"none",borderRadius:4,fontWeight:600,fontSize:16,cursor:"pointer",width:"auto"},children:q.viewReport})}),L===1&&Array.isArray(y.lunchCategories)&&y.lunchCategories.some(i=>i.entreeItems&&i.entreeItems.some(d=>d.qty>0)||i.alternativeItems&&i.alternativeItems.some(d=>d.qty>0))&&!x&&n.jsx(g,{mt:3,display:"flex",justifyContent:"center",children:n.jsx(T,{sx:{padding:"10px 32px",bgcolor:k.blueAccent[700],color:"#fcfcfc",border:"none",borderRadius:4,fontWeight:600,fontSize:16,cursor:"pointer",width:"auto"},disabled:!I&&(w||Y),onClick:()=>{B(y,M)},children:q.submit})})]}),L===2&&n.jsxs(g,{children:[Array.isArray(y.dinnerCategories)&&y.dinnerCategories.map((i,d)=>n.jsxs(g,{mb:3,children:[n.jsxs(_,{variant:"h6",sx:{mb:2,fontWeight:600,backgroundColor:"#f5f5f5",px:2,py:1,borderRadius:1,textAlign:"center"},children:[(c==null?void 0:c.langCode)==="cn"&&i.cat_name_cn&&i.cat_name_cn.trim()!==""?i.cat_name_cn:i.cat_name,i.cat_name==="DINNER ENTREE"&&` (${q.servedWithDessert})`]}),i.entreeItems.map(s=>n.jsxs(g,{mb:1,children:[n.jsxs(g,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[n.jsxs(g,{display:"flex",alignItems:"center",children:[s.image&&n.jsx("img",{src:s.image,alt:(c==null?void 0:c.langCode)==="cn"&&s.chinese_name?s.chinese_name:s.name,style:{width:64,height:64,objectFit:"cover",borderRadius:8,marginRight:12}}),n.jsx(_,{children:(c==null?void 0:c.langCode)==="cn"&&s.chinese_name?s.chinese_name:s.name})]}),n.jsxs(g,{display:"flex",alignItems:"center",children:[!x&&n.jsx("button",{onClick:()=>u(o=>({...o,dinnerCategories:o.dinnerCategories.map((h,p)=>p===d?{...h,entreeItems:h.entreeItems.map(t=>{if(t.id===s.id){const a=Math.max((t.qty||0)-1,0);return{...t,qty:a,options:(t.options||[]).length>0&&a===0?t.options.map((l,b)=>({...l,is_selected:b===0?1:0})):t.options,preference:(t.preference||[]).length>0&&a===0?t.preference.map(l=>({...l,is_selected:0})):t.preference}}return(t.qty||0)===0?{...t,options:(t.options||[]).length>0?t.options.map((a,l)=>({...a,is_selected:l===0?1:0})):t.options,preference:(t.preference||[]).length>0?t.preference.map(a=>({...a,is_selected:0})):t.preference}:t})}:h)})),style:{marginRight:8},disabled:s.qty===0||!I&&(w||Q),children:"-"}),n.jsx(_,{sx:x?{fontSize:24,fontWeight:700}:{},children:s.qty||0}),!x&&n.jsx("button",{onClick:()=>{u(o=>{var a,l,b,C;const h=(((l=(a=o.dinnerCategories[d])==null?void 0:a.entreeItems)==null?void 0:l.reduce((r,e)=>r+(e.qty||0),0))||0)+(((C=(b=o.dinnerCategories[d])==null?void 0:b.alternativeItems)==null?void 0:C.reduce((r,e)=>r+(e.qty||0),0))||0);let p=[...o.dinnerCategories[d].entreeItems],t=[...o.dinnerCategories[d].alternativeItems||[]];if((c==null?void 0:c.role)!=="kitchen"&&h>=A){let r=!1;t=t.map(e=>{if(!r&&e.qty>0){r=!0;const f=e.qty-1;return{...e,qty:f,options:(e.options||[]).length>0&&e.qty>0&&f===0?e.options.map((m,j)=>({...m,is_selected:j===0?1:0})):e.options,preference:(e.preference||[]).length>0&&e.qty>0&&f===0?e.preference.map(m=>({...m,is_selected:0})):e.preference}}return e}),r||(p=p.map(e=>{if(!r&&e.id!==s.id&&e.qty>0){r=!0;const f=e.qty-1;return{...e,qty:f,options:(e.options||[]).length>0&&e.qty>0&&f===0?e.options.map((m,j)=>({...m,is_selected:j===0?1:0})):e.options,preference:(e.preference||[]).length>0&&e.qty>0&&f===0?e.preference.map(m=>({...m,is_selected:0})):e.preference}}return e}))}return p=p.map(r=>r.id===s.id?{...r,qty:(r.qty||0)+1,options:(r.options||[]).length>0&&(r.qty||0)===0?r.options.map((e,f)=>({...e,is_selected:f===0?1:0})):r.options,preference:(r.preference||[]).length>0&&(r.qty||0)===0?r.preference.map(e=>({...e,is_selected:0})):r.preference}:r),{...o,dinnerCategories:o.dinnerCategories.map((r,e)=>e===d?{...r,entreeItems:p,alternativeItems:t}:r)}})},style:{marginLeft:8},disabled:s.qty>=A||!I&&(w||Q),children:"+"})]})]}),n.jsx(g,{mt:2,ml:1,sx:{width:"100%",minHeight:s.qty>0?"auto":0},children:s.qty>0&&n.jsxs(g,{mt:2,ml:1,children:[s.options&&s.options.length>0&&n.jsx(g,{mb:1,children:s.options.map(o=>n.jsxs("label",{style:{marginRight:12},children:[n.jsx("input",{type:"radio",name:`dinner-entree-option-${i.cat_id}-${s.id}`,checked:!!o.is_selected,onChange:()=>{u(h=>({...h,dinnerCategories:h.dinnerCategories.map((p,t)=>t===d?{...p,entreeItems:p.entreeItems.map(a=>a.id===s.id?{...a,options:a.options.map(l=>l.id===o.id?{...l,is_selected:1}:{...l,is_selected:0})}:a)}:p)}))}}),n.jsx("span",{style:{marginLeft:5},children:o.name})]},o.id))}),s.preference&&s.preference.length>0&&n.jsxs(g,{children:[n.jsx(_,{sx:{fontWeight:700,fontSize:18},children:"* Preference"}),s.preference.map(o=>n.jsxs("label",{style:{marginRight:12},children:[n.jsx("input",{type:"checkbox",checked:!!o.is_selected,onChange:()=>{u(h=>({...h,dinnerCategories:h.dinnerCategories.map((p,t)=>t===d?{...p,entreeItems:p.entreeItems.map(a=>a.id===s.id?{...a,preference:a.preference.map(l=>l.id===o.id?{...l,is_selected:l.is_selected?0:1}:l)}:a)}:p)}))}}),n.jsx("span",{style:{marginLeft:5},children:o.name})]},o.id))]})]})})]},s.id)),i.alternativeCatName&&n.jsx(_,{variant:"subtitle1",sx:{mt:3,mb:2,fontWeight:700},children:(c==null?void 0:c.langCode)==="cn"&&i.alternativeCatName_cn&&i.alternativeCatName_cn.trim()!==""?i.alternativeCatName_cn:i.alternativeCatName}),i.alternativeItems.map(s=>n.jsxs(g,{mb:1,ml:2,children:[n.jsxs(g,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[n.jsxs(g,{display:"flex",alignItems:"center",children:[s.image&&n.jsx("img",{src:s.image,alt:(c==null?void 0:c.langCode)==="cn"&&s.chinese_name?s.chinese_name:s.name,style:{width:64,height:64,objectFit:"cover",borderRadius:8,marginRight:12}}),n.jsx(_,{children:(c==null?void 0:c.langCode)==="cn"&&s.chinese_name?s.chinese_name:s.name})]}),n.jsxs(g,{display:"flex",alignItems:"center",children:[!x&&n.jsx("button",{onClick:()=>u(o=>({...o,dinnerCategories:o.dinnerCategories.map((h,p)=>p===d?{...h,alternativeItems:h.alternativeItems.map(t=>t.id===s.id?{...t,qty:Math.max((t.qty||0)-1,0),options:(t.options||[]).length>0&&Math.max((t.qty||0)-1,0)===0?t.options.map((a,l)=>({...a,is_selected:l===0?1:0})):t.options,preference:(t.preference||[]).length>0&&Math.max((t.qty||0)-1,0)===0?t.preference.map(a=>({...a,is_selected:0})):t.preference}:t)}:h)})),style:{marginRight:8},disabled:s.qty===0||!I&&(w||Q),children:"-"}),n.jsx(_,{sx:x?{fontSize:24,fontWeight:700}:{},children:s.qty||0}),!x&&n.jsx("button",{onClick:()=>{u(o=>{var a,l,b,C;const h=(((l=(a=o.dinnerCategories[d])==null?void 0:a.entreeItems)==null?void 0:l.reduce((r,e)=>r+(e.qty||0),0))||0)+(((C=(b=o.dinnerCategories[d])==null?void 0:b.alternativeItems)==null?void 0:C.reduce((r,e)=>r+(e.qty||0),0))||0);let p=[...o.dinnerCategories[d].alternativeItems],t=[...o.dinnerCategories[d].entreeItems||[]];if(h>=A){let r=!1;t=t.map(e=>{if(!r&&e.qty>0){r=!0;const f=e.qty-1;return{...e,qty:f,options:(e.options||[]).length>0&&e.qty>0&&f===0?e.options.map((m,j)=>({...m,is_selected:j===0?1:0})):e.options,preference:(e.preference||[]).length>0&&e.qty>0&&f===0?e.preference.map(m=>({...m,is_selected:0})):e.preference}}return e}),r||(p=p.map(e=>{if(!r&&e.id!==s.id&&e.qty>0){r=!0;const f=e.qty-1;return{...e,qty:f,options:(e.options||[]).length>0&&e.qty>0&&f===0?e.options.map((m,j)=>({...m,is_selected:j===0?1:0})):e.options,preference:(e.preference||[]).length>0&&e.qty>0&&f===0?e.preference.map(m=>({...m,is_selected:0})):e.preference}}return e}))}return p=p.map(r=>r.id===s.id?{...r,qty:(r.qty||0)+1,options:(r.options||[]).length>0&&(r.qty||0)===0?r.options.map((e,f)=>({...e,is_selected:f===0?1:0})):r.options,preference:(r.preference||[]).length>0&&(r.qty||0)===0?r.preference.map(e=>({...e,is_selected:0})):r.preference}:r),{...o,dinnerCategories:o.dinnerCategories.map((r,e)=>e===d?{...r,entreeItems:t,alternativeItems:p}:r)}})},style:{marginLeft:8},disabled:s.qty>=A||!I&&(w||Q),children:"+"})]})]}),n.jsx(g,{mt:2,ml:1,sx:{width:"100%",minHeight:s.qty>0?"auto":0},children:s.qty>0&&n.jsxs(g,{mt:2,ml:3,children:[s.options&&s.options.length>0&&n.jsx(g,{mb:1,children:s.options.map(o=>n.jsxs("label",{style:{marginRight:12},children:[n.jsx("input",{type:"radio",name:`dinner-alt-option-${i.cat_id}-${s.id}`,checked:!!o.is_selected,onChange:()=>{u(h=>({...h,dinnerCategories:h.dinnerCategories.map((p,t)=>t===d?{...p,alternativeItems:p.alternativeItems.map(a=>a.id===s.id?{...a,options:a.options.map(l=>l.id===o.id?{...l,is_selected:1}:{...l,is_selected:0})}:a)}:p)}))}}),n.jsx("span",{style:{marginLeft:5},children:o.name})]},o.id))}),s.preference&&s.preference.length>0&&n.jsxs(g,{children:[n.jsx(_,{sx:{fontWeight:700,fontSize:18},children:"* Preference"}),s.preference.map(o=>n.jsxs("label",{style:{marginRight:12},children:[n.jsx("input",{type:"checkbox",checked:!!o.is_selected,onChange:()=>{u(h=>({...h,dinnerCategories:h.dinnerCategories.map((p,t)=>t===d?{...p,alternativeItems:p.alternativeItems.map(a=>a.id===s.id?{...a,preference:a.preference.map(l=>l.id===o.id?{...l,is_selected:l.is_selected?0:1}:l)}:a)}:p)}))}}),n.jsx("span",{style:{marginLeft:5},children:o.name})]},o.id))]})]})})]},s.id))]},i.cat_id)),Array.isArray(y.dinnerCategories)&&y.dinnerCategories.some(i=>i.entreeItems&&i.entreeItems.some(d=>d.qty>0)||i.alternativeItems&&i.alternativeItems.some(d=>d.qty>0))&&!x&&n.jsx(g,{mt:3,display:"flex",gap:3,children:[{key:"is_dinner_tray_service",label:q.trayService},{key:"is_dinner_escort_service",label:q.escortService},{key:"is_dinner_takeout_service",label:q.Takeout}].map(i=>n.jsxs("label",{style:{display:"flex",alignItems:"center"},children:[n.jsx("input",{type:"checkbox",checked:y[i.key]===1,onChange:()=>{u(d=>({...d,is_dinner_tray_service:0,is_dinner_escort_service:0,is_dinner_takeout_service:0,[i.key]:d[i.key]===1?0:1}))}}),n.jsx("span",{style:{marginLeft:5},children:i.label})]},i.key))}),ke&&n.jsxs(n.Fragment,{children:[n.jsx("hr",{}),n.jsx(_,{variant:"subtitle1",sx:{fontWeight:600,mb:1},children:(c==null?void 0:c.langCode)==="cn"&&(c!=null&&c.dinner_guideline_cn)&&(c==null?void 0:c.dinner_guideline_cn.trim())!==""?c==null?void 0:c.dinner_guideline_cn:c==null?void 0:c.dinner_guideline})]}),Array.isArray(y.dinnerCategories)&&y.dinnerCategories.length===0&&n.jsx(_,{variant:"subtitle1",sx:{fontWeight:600,mb:1},children:q.dinnerMenuWarn}),x&&n.jsx(g,{mt:3,display:"flex",justifyContent:"center",children:n.jsx(T,{onClick:()=>P("/report"),endIcon:n.jsx(Z,{}),sx:{bgcolor:k.blueAccent[50],color:k.blueAccent[700],"&:hover":{bgcolor:k.blueAccent[100],color:k.blueAccent[800]},padding:"10px 32px",boxShadow:"none",borderRadius:"30px",border:"none",borderRadius:4,fontWeight:600,fontSize:16,cursor:"pointer",width:"auto"},children:q.viewReport})}),L===2&&Array.isArray(y.dinnerCategories)&&y.dinnerCategories.some(i=>i.entreeItems&&i.entreeItems.some(d=>d.qty>0)||i.alternativeItems&&i.alternativeItems.some(d=>d.qty>0))&&!x&&n.jsx(g,{mt:3,display:"flex",justifyContent:"center",children:n.jsx(T,{sx:{padding:"10px 32px",bgcolor:k.blueAccent[700],color:"#fcfcfc",border:"none",borderRadius:4,fontWeight:600,fontSize:16,cursor:"pointer",width:"auto"},disabled:!I&&(w||Q),onClick:()=>{B(y,M)},children:q.submit})})]})]})]})]})};export{hn as default};
