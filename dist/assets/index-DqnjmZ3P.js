import{c as ae,j as n,u as ve,b as Ie,a as we,r as v,B as g,C as Ae,T as _}from"./index-Ic96-0uI.js";import{e as le,H as Me,O as J,c as Re}from"./Header-Czk5TdvV.js";import{t as Se,L as Le,C as N,y as S}from"./js.cookie-BDhdAvxg.js";import{d as K,L as We,A as Ee,D as Te}from"./AdapterDayjs-4xP3l0wz.js";import{i as Ne,g as Ye,a as Qe,b as ze,c as Z,d as $e,f as D,e as Oe,T as Pe,h as ee,j as de,t as Fe}from"./index-BNkOVM-E.js";import{u as He}from"./useApi-DwalKIUk.js";import{u as Ge}from"./useCommon-CuZI9pEz.js";import{_ as G}from"./lodash-DAfOK3me.js";import{A as ne}from"./ArrowForwardIosOutlined-BgSfTHpc.js";import"./TextField-DUcxEuMZ.js";import"./api-DtAOtWGO.js";import"./IconButton-6QtCe6bx.js";import"./InputAdornment-QPfNViMu.js";import"./KeyboardArrowRight-DN9dzMhD.js";const Ue=ae(n.jsx("path",{d:"m14.06 9.02.92.92L5.92 19H5v-.92zM17.66 3c-.25 0-.51.1-.7.29l-1.83 1.83 3.75 3.75 1.83-1.83c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.2-.2-.45-.29-.71-.29m-3.6 3.19L3 17.25V21h3.75L17.81 9.94z"}),"EditOutlined"),Be=ae([n.jsx("circle",{cx:"12",cy:"4",r:"2"},"0"),n.jsx("path",{d:"M15.89 8.11C15.5 7.72 14.83 7 13.53 7h-2.54C8.24 6.99 6 4.75 6 2H4c0 3.16 2.11 5.84 5 6.71V22h2v-6h2v6h2V10.05L18.95 14l1.41-1.41z"},"1")],"EmojiPeopleOutlined"),Ke=(Y,C)=>{const Q=G.get(C,"date"),L=G.findIndex(Y,M=>K(M.date).isSame(K(Q),"day"));return L!==-1?G.map(Y,(M,q)=>q===L?C:M):[...Y,C]},{breakfastEndHour:F,lunchEndHour:H,dinnerEndHour:Ve}=de.mealTimes,pn=()=>{var ce;const Y=ve(),C=Se(Y.palette.mode),Q=Ie(),L=we(),M=(ce=Q.state)==null?void 0:ce.roomNo,[q,pe]=v.useState(le),[A,te]=v.useState(K()),[y,u]=v.useState({}),[U,he]=v.useState([]),[E,B]=v.useState([]),[R,me]=v.useState(1),[x,ge]=v.useState(!1),[c]=Ge("userData",null),I=v.useMemo(()=>Ne(c),[c]),se=v.useMemo(()=>I?99:Ye(c,M,de.defaults.maxMealQuantity),[c,M,I]),T=v.useMemo(()=>Qe(A),[A]),w=v.useMemo(()=>ze(A),[A]),z=v.useMemo(()=>T&&Z(F),[T]),$=v.useMemo(()=>T&&Z(H),[T]),O=v.useMemo(()=>T&&Z(Ve),[T]),{execute:re,loading:fe}=He((i,d)=>J.getMenuData(i,d),{onSuccess:i=>{const d=Fe(i),s={...d,date:D(A)};he(o=>Ke(o,s)),u(d)},onError:i=>{console.error("Error fetching menu list:",i),S.error("Failed to load menu data")}});v.useEffect(()=>{pe($e(c,le,Re))},[c]);const ye=v.useCallback(()=>{const i=K();return i.hour()>H||i.hour()===H&&i.minute()>0?2:i.hour()>F||i.hour()===F&&i.minute()>0?1:0},[]),[W,V]=v.useState(ye());v.useEffect(()=>{me(se)},[se]),v.useEffect(()=>{G.find(E,{date:D(A)})||ie(D(A))},[A,E]),v.useEffect(()=>{const i=G.get(Q,"state.Kitchen_summery",!1);ge(i)},[Q.state]);const ie=v.useCallback(async i=>{const d=Oe(c,M);await re(d,i)},[c,M,re]);function _e(i){const d=t=>(t||[]).map(a=>({item_id:a.id,qty:a.qty,order_id:a.order_id||0,preference:(a.preference||[]).filter(l=>l.is_selected).map(l=>l.id).join(","),item_options:(a.options||[]).filter(l=>l.is_selected).map(l=>l.id).join(",")})),s=t=>[...(t.breakfastCategories||[]).flatMap(a=>[...d(a.entreeItems),...d(a.alternativeItems)]),...(t.lunchCategories||[]).flatMap(a=>[...d(a.entreeItems),...d(a.alternativeItems)]),...(t.dinnerCategories||[]).flatMap(a=>[...d(a.entreeItems),...d(a.alternativeItems)])],o=c.rooms.find(t=>t.name===M),h=(o==null?void 0:o.id)||0,p=i.map(t=>{const a=s(t),l=Array.isArray(U)?U.find(m=>m.date===t.date):U.date===t.date?U:null,b=l?s(l):[],k=new Map(b.map(m=>[`${m.item_id}_${m.order_id}`,m])),r=new Map(a.map(m=>[`${m.item_id}_${m.order_id}`,m])),e=[];a.forEach(m=>{const j=`${m.item_id}_${m.order_id}`,P=k.get(j);P?(m.qty!==P.qty||m.preference!==P.preference||m.item_options!==P.item_options)&&(P.qty>0&&m.qty===0?e.push({...m,qty:0,preference:"",item_options:""}):e.push(m)):m.qty>0&&e.push(m)}),b.forEach(m=>{const j=`${m.item_id}_${m.order_id}`;!r.has(j)&&m.qty>0&&e.push({...m,qty:0,preference:"",item_options:""})});const f=t.is_dinner_takeout_service!==(l==null?void 0:l.is_dinner_takeout_service)||t.is_dinner_tray_service!==(l==null?void 0:l.is_dinner_tray_service)||t.is_dinner_escort_service!==(l==null?void 0:l.is_dinner_escort_service)||t.is_brk_tray_service!==(l==null?void 0:l.is_brk_tray_service)||t.is_brk_escort_service!==(l==null?void 0:l.is_brk_escort_service)||t.is_brk_takeout_service!==(l==null?void 0:l.is_brk_takeout_service)||t.is_lunch_tray_service!==(l==null?void 0:l.is_lunch_tray_service)||t.is_lunch_escort_service!==(l==null?void 0:l.is_lunch_escort_service)||t.is_lunch_takeout_service!==(l==null?void 0:l.is_lunch_takeout_service);return e.length===0&&!f?null:{date:t.date,is_brk_tray_service:t.is_brk_tray_service,is_lunch_tray_service:t.is_lunch_tray_service,is_dinner_tray_service:t.is_dinner_tray_service,is_brk_escort_service:t.is_brk_escort_service,is_lunch_escort_service:t.is_lunch_escort_service,is_dinner_escort_service:t.is_dinner_escort_service,is_brk_takeout_service:t.is_brk_takeout_service,is_lunch_takeout_service:t.is_lunch_takeout_service,is_dinner_takeout_service:t.is_dinner_takeout_service,items:e}}).filter(Boolean);return{current_date:i.length?i[i.length-1].date:"",room_id:h,orders_to_change:JSON.stringify(p)}}function oe(i,d,s){const o=s,h=i.findIndex(p=>(p==null?void 0:p.date)===o);if(h!==-1){const p=[...i];return p[h]={...d},p}else return[...i,d]}const X=async(i,d)=>{try{const s={...i,date:d.format("YYYY-MM-DD")};B(t=>{const a=oe(t,s,d),l=[],b=new Set;for(let k=a.length-1;k>=0;k--){const r=a[k].date;b.has(r)||(l.unshift(a[k]),b.add(r))}return l});const o=oe(E,s,d.format("YYYY-MM-DD")),h=_e(o,d);let p=await J.submitOrder(h);p.ResponseText==="success"?(B([]),ie(d.format("YYYY-MM-DD")),S.success("Order submitted successfully!")):S.error(p.ResponseText||"Order submission failed.")}catch(s){S.error("An error occurred while submitting the order."),console.error(s)}},ue=async i=>{var d,s,o;if((d=i==null?void 0:i.selectedUser)!=null&&d.id)try{const h=((i==null?void 0:i.specialInstruction)??"").toString().trim(),p=((i==null?void 0:i.foodTexture)??"").toString().trim(),t=await J.updateRoomDetails(i.selectedUser.id,h,p);t.ResponseCode==="1"?S.success((t==null?void 0:t.ResponseText)||"Room Details Updated Successfully"):S.error(t.ResponseText||"Room Details Update failed. Please try again.")}catch(h){console.error("Error processing Room Details Update failed:",h);const p=((o=(s=h==null?void 0:h.response)==null?void 0:s.data)==null?void 0:o.error)||"An unexpected error occurred. Please try again.";S.error(p)}else S.error("No user selected for room update.")},xe=()=>{const i=A.format("YYYY-MM-DD"),d=M||(c==null?void 0:c.room_id);L("/guestOrder",{state:{roomNo:d,selectedDate:i}})};function be(i){const d=i;return d.hour()>H||d.hour()===H&&d.minute()>0?2:d.hour()>F||d.hour()===F&&d.minute()>0?1:0}const je=i=>{const d=A.format("YYYY-MM-DD");let s=E==null?void 0:E.find(o=>o.date===i.format("YYYY-MM-DD"));s!==void 0?(V(be(i)),y.date=d,B(o=>{const h=o.findIndex(p=>(p==null?void 0:p.date)===d);if(h!==-1){const p=[...o];return p[h]={...y},p}else return[...o,y]}),u(s),te(i)):(V(0),te(i),y.date=d,B(o=>[...o,y]))},Ce=(c==null?void 0:c.breakfast_guideline)&&y.breakfastCategories&&y.breakfastCategories.length>0,qe=(c==null?void 0:c.lunch_guideline)&&y.lunchCategories&&y.lunchCategories.length>0,ke=(c==null?void 0:c.dinner_guideline)&&y.dinnerCategories&&y.dinnerCategories.length>0;return n.jsxs(g,{m:"20px",children:[n.jsx(Me,{title:x?"Kitchen Summary ":M||(c==null?void 0:c.room_id),icon:"",editRoomsDetails:(c==null?void 0:c.role)!=="kitchen",editIcon:n.jsx(Ue,{}),isGuest:!x,handleGuestClick:xe,isGuestIcon:n.jsx(Be,{}),handleRoomUpdate:ue,profileScreen:!0}),n.jsx(Le,{}),n.jsxs(g,{mt:"40px",height:"75vh",flex:1,sx:{"& .MuiDataGrid-root":{border:"none"},"& .MuiDataGrid-cell":{border:"none"},"& .name-column--cell":{color:C.greenAccent[300]},"& .MuiDataGrid-columnHeaders":{backgroundColor:C.blueAccent[700],borderBottom:"none"},"& .MuiDataGrid-virtualScroller":{backgroundColor:C.primary[400]},"& .MuiDataGrid-footerContainer":{borderTop:"none",backgroundColor:C.blueAccent[700]},"& .MuiCheckbox-root":{color:`${C.greenAccent[200]} !important`},"& .MuiDataGrid-iconSeparator":{color:C.primary[100]}},children:[n.jsx(g,{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2,children:n.jsx(We,{dateAdapter:Ee,adapterLocale:(c==null?void 0:c.langCode)==="cn"?"zh-cn":"en",children:n.jsx(Te,{label:"Date",value:A,onChange:je,renderInput:i=>n.jsx(TextField,{...i,fullWidth:!0,variant:"filled",sx:{gridColumn:"span 1"}})})})}),fe?n.jsx(Ae,{}):n.jsxs(n.Fragment,{children:[n.jsxs(Pe,{value:W,onChange:(i,d)=>V(d),indicatorColor:"primary",textColor:"primary",sx:{mb:2},children:[n.jsx(ee,{label:q.brk}),n.jsx(ee,{label:q.lunch}),n.jsx(ee,{label:q.dnr})]}),W===0&&n.jsxs(g,{children:[Array.isArray(y.breakfastCategories)&&y.breakfastCategories.map((i,d)=>n.jsxs(g,{mb:3,children:[n.jsx(_,{variant:"h6",sx:{mb:2,fontWeight:600,backgroundColor:"#f5f5f5",px:2,py:1,borderRadius:1,textAlign:"center"},children:(c==null?void 0:c.langCode)==="cn"&&i.cat_name_cn&&i.cat_name_cn.trim()!==""?i.cat_name_cn:i.cat_name}),i.entreeItems.map(s=>n.jsxs(g,{mb:1,children:[n.jsxs(g,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[n.jsxs(g,{display:"flex",alignItems:"center",children:[s.image&&n.jsx("img",{src:s.image,alt:(c==null?void 0:c.langCode)==="cn"&&s.chinese_name?s.chinese_name:s.name,style:{width:64,height:64,objectFit:"cover",borderRadius:8,marginRight:12}}),n.jsx(_,{children:(c==null?void 0:c.langCode)==="cn"&&s.chinese_name?s.chinese_name:s.name})]}),n.jsxs(g,{display:"flex",alignItems:"center",children:[!x&&n.jsx("button",{onClick:()=>u(o=>({...o,breakfastCategories:o.breakfastCategories.map((h,p)=>p===d?{...h,entreeItems:h.entreeItems.map(t=>{if(t.id===s.id){const a=Math.max((t.qty||0)-1,0);return{...t,qty:a,options:(t.options||[]).length>0&&a===0?t.options.map((l,b)=>({...l,is_selected:b===0?1:0})):t.options,preference:(t.preference||[]).length>0&&a===0?t.preference.map(l=>({...l,is_selected:0})):t.preference}}return(t.qty||0)===0?{...t,options:(t.options||[]).length>0?t.options.map((a,l)=>({...a,is_selected:l===0?1:0})):t.options,preference:(t.preference||[]).length>0?t.preference.map(a=>({...a,is_selected:0})):t.preference}:t})}:h)})),style:{marginRight:8},disabled:s.qty===0||!I&&(w||z),children:"-"}),n.jsx(_,{sx:x?{fontSize:24,fontWeight:700}:{},children:s.qty||0}),!x&&n.jsx("button",{onClick:()=>{u(o=>{var a,l,b,k;const h=(((l=(a=o.breakfastCategories[d])==null?void 0:a.entreeItems)==null?void 0:l.reduce((r,e)=>r+(e.qty||0),0))||0)+(((k=(b=o.breakfastCategories[d])==null?void 0:b.alternativeItems)==null?void 0:k.reduce((r,e)=>r+(e.qty||0),0))||0);let p=[...o.breakfastCategories[d].entreeItems],t=[...o.breakfastCategories[d].alternativeItems||[]];if((c==null?void 0:c.role)!=="kitchen"&&h>=R){let r=!1;t=t.map(e=>{if(!r&&e.qty>0){r=!0;const f=e.qty-1;return{...e,qty:f,options:(e.options||[]).length>0&&e.qty>0&&f===0?e.options.map((m,j)=>({...m,is_selected:j===0?1:0})):e.options,preference:(e.preference||[]).length>0&&e.qty>0&&f===0?e.preference.map(m=>({...m,is_selected:0})):e.preference}}return e}),r||(p=p.map(e=>{if(!r&&e.id!==s.id&&e.qty>0){r=!0;const f=e.qty-1;return{...e,qty:f,options:(e.options||[]).length>0&&e.qty>0&&f===0?e.options.map((m,j)=>({...m,is_selected:j===0?1:0})):e.options,preference:(e.preference||[]).length>0&&e.qty>0&&f===0?e.preference.map(m=>({...m,is_selected:0})):e.preference}}return e}))}return p=p.map(r=>r.id===s.id?{...r,qty:(r.qty||0)+1,options:(r.options||[]).length>0&&(r.qty||0)===0?r.options.map((e,f)=>({...e,is_selected:f===0?1:0})):r.options,preference:(r.preference||[]).length>0&&(r.qty||0)===0?r.preference.map(e=>({...e,is_selected:0})):r.preference}:r),{...o,breakfastCategories:o.breakfastCategories.map((r,e)=>e===d?{...r,entreeItems:p,alternativeItems:t}:r)}})},style:{marginLeft:8},disabled:s.qty>=R||!I&&(w||z),children:"+"})]})]}),n.jsx(g,{mt:2,ml:1,sx:{width:"100%",minHeight:s.qty>0?"auto":0},children:s.qty>0&&n.jsxs(g,{mt:2,ml:1,sx:{width:"100%"},children:[s.options&&s.options.length>0&&n.jsx(g,{mb:1,children:s.options.map(o=>n.jsxs("label",{style:{marginRight:12},children:[n.jsx("input",{type:"radio",name:`breakfast-entree-option-${i.cat_id}-${s.id}`,checked:!!o.is_selected,onChange:()=>{u(h=>({...h,breakfastCategories:h.breakfastCategories.map((p,t)=>t===d?{...p,entreeItems:p.entreeItems.map(a=>a.id===s.id?{...a,options:a.options.map(l=>l.id===o.id?{...l,is_selected:1}:{...l,is_selected:0})}:a)}:p)}))}}),n.jsx("span",{style:{marginLeft:5},children:o.name})]},o.id))}),s.preference&&s.preference.length>0&&n.jsxs(g,{children:[n.jsx(_,{sx:{fontWeight:700,fontSize:18},children:"* Preference"}),s.preference.map(o=>n.jsxs("label",{style:{marginRight:12},children:[n.jsx("input",{type:"checkbox",checked:!!o.is_selected,onChange:()=>{u(h=>({...h,breakfastCategories:h.breakfastCategories.map((p,t)=>t===d?{...p,entreeItems:p.entreeItems.map(a=>a.id===s.id?{...a,preference:a.preference.map(l=>l.id===o.id?{...l,is_selected:l.is_selected?0:1}:l)}:a)}:p)}))}}),n.jsx("span",{style:{marginLeft:5},children:o.name})]},o.id))]})]})})]},s.id)),i.alternativeCatName&&n.jsx(_,{variant:"subtitle1",sx:{mt:3,mb:2,fontWeight:700},children:(c==null?void 0:c.langCode)==="cn"&&i.alternativeCatName_cn&&i.alternativeCatName_cn.trim()!==""?i.alternativeCatName_cn:i.alternativeCatName}),i.alternativeItems.map(s=>n.jsxs(g,{mb:1,ml:2,children:[n.jsxs(g,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[n.jsxs(g,{display:"flex",alignItems:"center",children:[s.image&&n.jsx("img",{src:s.image,alt:(c==null?void 0:c.langCode)==="cn"&&s.chinese_name?s.chinese_name:s.name,style:{width:64,height:64,objectFit:"cover",borderRadius:8,marginRight:12}}),n.jsx(_,{children:(c==null?void 0:c.langCode)==="cn"&&s.chinese_name?s.chinese_name:s.name})]}),n.jsxs(g,{display:"flex",alignItems:"center",children:[!x&&n.jsx("button",{onClick:()=>u(o=>({...o,breakfastCategories:o.breakfastCategories.map((h,p)=>p===d?{...h,alternativeItems:h.alternativeItems.map(t=>t.id===s.id?{...t,qty:Math.max((t.qty||0)-1,0),options:(t.options||[]).length>0&&Math.max((t.qty||0)-1,0)===0?t.options.map((a,l)=>({...a,is_selected:l===0?1:0})):t.options,preference:(t.preference||[]).length>0&&Math.max((t.qty||0)-1,0)===0?t.preference.map(a=>({...a,is_selected:0})):t.preference}:t)}:h)})),style:{marginRight:8},disabled:s.qty===0||!I&&(w||z),children:"-"}),n.jsx(_,{sx:x?{fontSize:24,fontWeight:700}:{},children:s.qty||0}),!x&&n.jsx("button",{onClick:()=>{u(o=>{var a,l,b,k;const h=(((l=(a=o.breakfastCategories[d])==null?void 0:a.entreeItems)==null?void 0:l.reduce((r,e)=>r+(e.qty||0),0))||0)+(((k=(b=o.breakfastCategories[d])==null?void 0:b.alternativeItems)==null?void 0:k.reduce((r,e)=>r+(e.qty||0),0))||0);let p=[...o.breakfastCategories[d].alternativeItems],t=[...o.breakfastCategories[d].entreeItems||[]];if(h>=R){let r=!1;t=t.map(e=>{if(!r&&e.qty>0){r=!0;const f=e.qty-1;return{...e,qty:f,options:(e.options||[]).length>0&&e.qty>0&&f===0?e.options.map((m,j)=>({...m,is_selected:j===0?1:0})):e.options,preference:(e.preference||[]).length>0&&e.qty>0&&f===0?e.preference.map(m=>({...m,is_selected:0})):e.preference}}return e}),r||(p=p.map(e=>{if(!r&&e.id!==s.id&&e.qty>0){r=!0;const f=e.qty-1;return{...e,qty:f,options:(e.options||[]).length>0&&e.qty>0&&f===0?e.options.map((m,j)=>({...m,is_selected:j===0?1:0})):e.options,preference:(e.preference||[]).length>0&&e.qty>0&&f===0?e.preference.map(m=>({...m,is_selected:0})):e.preference}}return e}))}return p=p.map(r=>r.id===s.id?{...r,qty:(r.qty||0)+1,options:(r.options||[]).length>0&&(r.qty||0)===0?r.options.map((e,f)=>({...e,is_selected:f===0?1:0})):r.options,preference:(r.preference||[]).length>0&&(r.qty||0)===0?r.preference.map(e=>({...e,is_selected:0})):r.preference}:r),{...o,breakfastCategories:o.breakfastCategories.map((r,e)=>e===d?{...r,entreeItems:t,alternativeItems:p}:r)}})},style:{marginLeft:8},disabled:s.qty>=R||!I&&(w||z),children:"+"})]})]}),n.jsx(g,{mt:2,ml:1,sx:{width:"100%",minHeight:s.qty>0?"auto":0},children:s.qty>0&&n.jsxs(g,{mt:2,ml:1,children:[s.options&&s.options.length>0&&n.jsx(g,{mb:1,children:s.options.map(o=>n.jsxs("label",{style:{marginRight:12},children:[n.jsx("input",{type:"radio",name:`breakfast-alt-option-${i.cat_id}-${s.id}`,checked:!!o.is_selected,onChange:()=>{u(h=>({...h,breakfastCategories:h.breakfastCategories.map((p,t)=>t===d?{...p,alternativeItems:p.alternativeItems.map(a=>a.id===s.id?{...a,options:a.options.map(l=>l.id===o.id?{...l,is_selected:1}:{...l,is_selected:0})}:a)}:p)}))}}),n.jsx("span",{style:{marginLeft:5},children:o.name})]},o.id))}),s.preference&&s.preference.length>0&&n.jsxs(g,{children:[n.jsx(_,{sx:{fontWeight:700,fontSize:18},children:"* Preference"}),s.preference.map(o=>n.jsxs("label",{style:{marginRight:12},children:[n.jsx("input",{type:"checkbox",checked:!!o.is_selected,onChange:()=>{u(h=>({...h,breakfastCategories:h.breakfastCategories.map((p,t)=>t===d?{...p,alternativeItems:p.alternativeItems.map(a=>a.id===s.id?{...a,preference:a.preference.map(l=>l.id===o.id?{...l,is_selected:l.is_selected?0:1}:l)}:a)}:p)}))}}),n.jsx("span",{style:{marginLeft:5},children:o.name})]},o.id))]})]})})]},s.id))]},i.cat_id)),Array.isArray(y.breakfastCategories)&&y.breakfastCategories.some(i=>i.entreeItems&&i.entreeItems.some(d=>d.qty>0)||i.alternativeItems&&i.alternativeItems.some(d=>d.qty>0))&&!x&&n.jsx(g,{mt:3,display:"flex",gap:2,children:[{key:"is_brk_tray_service",label:q.trayService},{key:"is_brk_escort_service",label:q.escortService},{key:"is_brk_takeout_service",label:q.Takeout}].map(i=>n.jsxs("label",{style:{display:"flex",alignItems:"center"},children:[n.jsx("input",{type:"checkbox",checked:y[i.key]===1,onChange:()=>{u(d=>({...d,is_brk_tray_service:0,is_brk_escort_service:0,is_brk_takeout_service:0,[i.key]:d[i.key]===1?0:1}))}}),n.jsx("span",{style:{marginLeft:5},children:i.label})]},i.key))}),Ce&&n.jsxs(n.Fragment,{children:[n.jsx("hr",{}),n.jsx(_,{variant:"subtitle1",sx:{fontWeight:600,mb:1},children:(c==null?void 0:c.langCode)==="cn"&&(c!=null&&c.breakfast_guideline_cn)&&(c==null?void 0:c.breakfast_guideline_cn.trim())!==""?c==null?void 0:c.breakfast_guideline_cn:c==null?void 0:c.breakfast_guideline})]}),Array.isArray(y.breakfastCategories)&&y.breakfastCategories.length===0&&n.jsx(_,{variant:"subtitle1",sx:{fontWeight:600,mb:1},children:q.breakFasrMenuWarn}),x&&n.jsx(g,{mt:3,display:"flex",justifyContent:"center",children:n.jsx(N,{onClick:()=>L("/report"),endIcon:n.jsx(ne,{}),sx:{bgcolor:C.blueAccent[50],color:C.blueAccent[700],"&:hover":{bgcolor:C.blueAccent[100],color:C.blueAccent[800]},padding:"10px 32px",boxShadow:"none",borderRadius:"30px",border:"none",borderRadius:4,fontWeight:600,fontSize:16,cursor:"pointer",width:"auto"},children:q.viewReport})}),W===0&&Array.isArray(y.breakfastCategories)&&y.breakfastCategories.some(i=>i.entreeItems&&i.entreeItems.some(d=>d.qty>0)||i.alternativeItems&&i.alternativeItems.some(d=>d.qty>0))&&!x&&n.jsx(g,{mt:3,display:"flex",justifyContent:"center",children:n.jsx(N,{sx:{padding:"10px 32px",bgcolor:C.blueAccent[700],color:"#fcfcfc",border:"none",borderRadius:4,fontWeight:600,fontSize:16,cursor:"pointer",width:"auto"},disabled:!I&&(w||z),onClick:()=>{X(y,A)},children:q.submit})})]}),W===1&&n.jsxs(g,{children:[Array.isArray(y.lunchCategories)&&y.lunchCategories.map((i,d)=>n.jsxs(g,{mb:3,children:[n.jsxs(_,{variant:"h6",sx:{mb:2,fontWeight:600,backgroundColor:"#f5f5f5",px:2,py:1,borderRadius:1,textAlign:"center"},children:[(c==null?void 0:c.langCode)==="cn"&&i.cat_name_cn&&i.cat_name_cn.trim()!==""?i.cat_name_cn:i.cat_name,i.cat_name==="LUNCH ENTREE"&&` (${q.servedWithSoup})`]}),i.entreeItems.map(s=>n.jsxs(g,{mb:1,children:[n.jsxs(g,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[n.jsxs(g,{display:"flex",alignItems:"center",children:[s.image&&n.jsx("img",{src:s.image,alt:(c==null?void 0:c.langCode)==="cn"&&s.chinese_name?s.chinese_name:s.name,style:{width:64,height:64,objectFit:"cover",borderRadius:8,marginRight:12}}),n.jsx(_,{children:(c==null?void 0:c.langCode)==="cn"&&s.chinese_name?s.chinese_name:s.name})]}),n.jsxs(g,{display:"flex",alignItems:"center",children:[!x&&n.jsx("button",{onClick:()=>u(o=>({...o,lunchCategories:o.lunchCategories.map((h,p)=>p===d?{...h,entreeItems:h.entreeItems.map(t=>{if(t.id===s.id){const a=Math.max((t.qty||0)-1,0);return{...t,qty:a,options:(t.options||[]).length>0&&a===0?t.options.map((l,b)=>({...l,is_selected:b===0?1:0})):t.options,preference:(t.preference||[]).length>0&&a===0?t.preference.map(l=>({...l,is_selected:0})):t.preference}}return(t.qty||0)===0?{...t,options:(t.options||[]).length>0?t.options.map((a,l)=>({...a,is_selected:l===0?1:0})):t.options,preference:(t.preference||[]).length>0?t.preference.map(a=>({...a,is_selected:0})):t.preference}:t})}:h)})),style:{marginRight:8},disabled:s.qty===0||!I&&(w||$),children:"-"}),n.jsx(_,{sx:x?{fontSize:24,fontWeight:700}:{},children:s.qty||0}),!x&&n.jsx("button",{onClick:()=>{u(o=>{var a,l,b,k;const h=(((l=(a=o.lunchCategories[d])==null?void 0:a.entreeItems)==null?void 0:l.reduce((r,e)=>r+(e.qty||0),0))||0)+(((k=(b=o.lunchCategories[d])==null?void 0:b.alternativeItems)==null?void 0:k.reduce((r,e)=>r+(e.qty||0),0))||0);let p=[...o.lunchCategories[d].entreeItems],t=[...o.lunchCategories[d].alternativeItems||[]];if((c==null?void 0:c.role)!=="kitchen"&&h>=R){let r=!1;t=t.map(e=>{if(!r&&e.qty>0){r=!0;const f=e.qty-1;return{...e,qty:f,options:(e.options||[]).length>0&&e.qty>0&&f===0?e.options.map((m,j)=>({...m,is_selected:j===0?1:0})):e.options,preference:(e.preference||[]).length>0&&e.qty>0&&f===0?e.preference.map(m=>({...m,is_selected:0})):e.preference}}return e}),r||(p=p.map(e=>{if(!r&&e.id!==s.id&&e.qty>0){r=!0;const f=e.qty-1;return{...e,qty:f,options:(e.options||[]).length>0&&e.qty>0&&f===0?e.options.map((m,j)=>({...m,is_selected:j===0?1:0})):e.options,preference:(e.preference||[]).length>0&&e.qty>0&&f===0?e.preference.map(m=>({...m,is_selected:0})):e.preference}}return e}))}return p=p.map(r=>r.id===s.id?{...r,qty:(r.qty||0)+1,options:(r.options||[]).length>0&&(r.qty||0)===0?r.options.map((e,f)=>({...e,is_selected:f===0?1:0})):r.options,preference:(r.preference||[]).length>0&&(r.qty||0)===0?r.preference.map(e=>({...e,is_selected:0})):r.preference}:r),{...o,lunchCategories:o.lunchCategories.map((r,e)=>e===d?{...r,entreeItems:p,alternativeItems:t}:r)}})},style:{marginLeft:8},disabled:s.qty>=R||!I&&(w||$),children:"+"})]})]}),n.jsx(g,{mt:2,ml:1,sx:{width:"100%",minHeight:s.qty>0?"auto":0},children:s.qty>0&&n.jsxs(g,{mt:2,ml:1,sx:{width:"100%"},children:[s.options&&s.options.length>0&&n.jsx(g,{mb:1,children:s.options.map(o=>n.jsxs("label",{style:{marginRight:12},children:[n.jsx("input",{type:"radio",name:`lunch-entree-option-${i.cat_id}-${s.id}`,checked:!!o.is_selected,onChange:()=>{u(h=>({...h,lunchCategories:h.lunchCategories.map((p,t)=>t===d?{...p,entreeItems:p.entreeItems.map(a=>a.id===s.id?{...a,options:a.options.map(l=>l.id===o.id?{...l,is_selected:1}:{...l,is_selected:0})}:a)}:p)}))}}),n.jsx("span",{style:{marginLeft:5},children:o.name})]},o.id))}),s.preference&&s.preference.length>0&&n.jsxs(g,{children:[n.jsx(_,{sx:{fontWeight:700,fontSize:18},children:"* Preference"}),s.preference.map(o=>n.jsxs("label",{style:{marginRight:12},children:[n.jsx("input",{type:"checkbox",checked:!!o.is_selected,onChange:()=>{u(h=>({...h,lunchCategories:h.lunchCategories.map((p,t)=>t===d?{...p,entreeItems:p.entreeItems.map(a=>a.id===s.id?{...a,preference:a.preference.map(l=>l.id===o.id?{...l,is_selected:l.is_selected?0:1}:l)}:a)}:p)}))}}),n.jsx("span",{style:{marginLeft:5},children:o.name})]},o.id))]})]})})]},s.id)),i.alternativeCatName&&n.jsx(_,{variant:"subtitle1",sx:{mt:3,mb:2,fontWeight:700},children:(c==null?void 0:c.langCode)==="cn"&&i.alternativeCatName_cn&&i.alternativeCatName_cn.trim()!==""?i.alternativeCatName_cn:i.alternativeCatName}),i.alternativeItems.map(s=>n.jsxs(g,{mb:1,ml:2,children:[n.jsxs(g,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[n.jsxs(g,{display:"flex",alignItems:"center",children:[s.image&&n.jsx("img",{src:s.image,alt:(c==null?void 0:c.langCode)==="cn"&&s.chinese_name?s.chinese_name:s.name,style:{width:64,height:64,objectFit:"cover",borderRadius:8,marginRight:12}}),n.jsx(_,{children:(c==null?void 0:c.langCode)==="cn"&&s.chinese_name?s.chinese_name:s.name})]}),n.jsxs(g,{display:"flex",alignItems:"center",children:[!x&&n.jsx("button",{onClick:()=>u(o=>({...o,lunchCategories:o.lunchCategories.map((h,p)=>p===d?{...h,alternativeItems:h.alternativeItems.map(t=>t.id===s.id?{...t,qty:Math.max((t.qty||0)-1,0),options:(t.options||[]).length>0&&Math.max((t.qty||0)-1,0)===0?t.options.map((a,l)=>({...a,is_selected:l===0?1:0})):t.options,preference:(t.preference||[]).length>0&&Math.max((t.qty||0)-1,0)===0?t.preference.map(a=>({...a,is_selected:0})):t.preference}:t)}:h)})),style:{marginRight:8},disabled:s.qty===0||!I&&(w||$),children:"-"}),n.jsx(_,{sx:x?{fontSize:24,fontWeight:700}:{},children:s.qty||0}),!x&&n.jsx("button",{onClick:()=>{u(o=>{var a,l,b,k;const h=(((l=(a=o.lunchCategories[d])==null?void 0:a.entreeItems)==null?void 0:l.reduce((r,e)=>r+(e.qty||0),0))||0)+(((k=(b=o.lunchCategories[d])==null?void 0:b.alternativeItems)==null?void 0:k.reduce((r,e)=>r+(e.qty||0),0))||0);let p=[...o.lunchCategories[d].alternativeItems],t=[...o.lunchCategories[d].entreeItems||[]];if(h>=R){let r=!1;t=t.map(e=>{if(!r&&e.qty>0){r=!0;const f=e.qty-1;return{...e,qty:f,options:(e.options||[]).length>0&&e.qty>0&&f===0?e.options.map((m,j)=>({...m,is_selected:j===0?1:0})):e.options,preference:(e.preference||[]).length>0&&e.qty>0&&f===0?e.preference.map(m=>({...m,is_selected:0})):e.preference}}return e}),r||(p=p.map(e=>{if(!r&&e.id!==s.id&&e.qty>0){r=!0;const f=e.qty-1;return{...e,qty:f,options:(e.options||[]).length>0&&e.qty>0&&f===0?e.options.map((m,j)=>({...m,is_selected:j===0?1:0})):e.options,preference:(e.preference||[]).length>0&&e.qty>0&&f===0?e.preference.map(m=>({...m,is_selected:0})):e.preference}}return e}))}return p=p.map(r=>r.id===s.id?{...r,qty:(r.qty||0)+1,options:(r.options||[]).length>0&&(r.qty||0)===0?r.options.map((e,f)=>({...e,is_selected:f===0?1:0})):r.options,preference:(r.preference||[]).length>0&&(r.qty||0)===0?r.preference.map(e=>({...e,is_selected:0})):r.preference}:r),{...o,lunchCategories:o.lunchCategories.map((r,e)=>e===d?{...r,entreeItems:t,alternativeItems:p}:r)}})},style:{marginLeft:8},disabled:s.qty>=R||!I&&(w||$),children:"+"})]})]}),n.jsx(g,{mt:2,ml:1,sx:{width:"100%",minHeight:s.qty>0?"auto":0},children:s.qty>0&&n.jsxs(g,{mt:2,ml:1,children:[s.options&&s.options.length>0&&n.jsx(g,{mb:1,children:s.options.map(o=>n.jsxs("label",{style:{marginRight:12},children:[n.jsx("input",{type:"radio",name:`lunch-alt-option-${i.cat_id}-${s.id}`,checked:!!o.is_selected,onChange:()=>{u(h=>({...h,lunchCategories:h.lunchCategories.map((p,t)=>t===d?{...p,alternativeItems:p.alternativeItems.map(a=>a.id===s.id?{...a,options:a.options.map(l=>l.id===o.id?{...l,is_selected:1}:{...l,is_selected:0})}:a)}:p)}))}}),n.jsx("span",{style:{marginLeft:5},children:o.name})]},o.id))}),s.preference&&s.preference.length>0&&n.jsxs(g,{children:[n.jsx(_,{sx:{fontWeight:700,fontSize:18},children:"* Preference"}),s.preference.map(o=>n.jsxs("label",{style:{marginRight:12},children:[n.jsx("input",{type:"checkbox",checked:!!o.is_selected,onChange:()=>{u(h=>({...h,lunchCategories:h.lunchCategories.map((p,t)=>t===d?{...p,alternativeItems:p.alternativeItems.map(a=>a.id===s.id?{...a,preference:a.preference.map(l=>l.id===o.id?{...l,is_selected:l.is_selected?0:1}:l)}:a)}:p)}))}}),n.jsx("span",{style:{marginLeft:5},children:o.name})]},o.id))]})]})})]},s.id))]},i.cat_id)),Array.isArray(y.lunchCategories)&&y.lunchCategories.some(i=>i.entreeItems&&i.entreeItems.some(d=>d.qty>0)||i.alternativeItems&&i.alternativeItems.some(d=>d.qty>0))&&!x&&n.jsx(g,{mt:3,display:"flex",gap:3,children:[{key:"is_lunch_tray_service",label:q.trayService},{key:"is_lunch_escort_service",label:q.escortService},{key:"is_lunch_takeout_service",label:q.Takeout}].map(i=>n.jsxs("label",{style:{display:"flex",alignItems:"center"},children:[n.jsx("input",{type:"checkbox",checked:y[i.key]===1,onChange:()=>{u(d=>({...d,is_lunch_tray_service:0,is_lunch_escort_service:0,is_lunch_takeout_service:0,[i.key]:d[i.key]===1?0:1}))}}),n.jsx("span",{style:{marginLeft:5},children:i.label})]},i.key))}),qe&&n.jsxs(n.Fragment,{children:[n.jsx("hr",{}),n.jsx(_,{variant:"subtitle1",sx:{fontWeight:600,mb:1},children:(c==null?void 0:c.langCode)==="cn"&&(c!=null&&c.lunch_guideline_cn)&&(c==null?void 0:c.lunch_guideline_cn.trim())!==""?c==null?void 0:c.lunch_guideline_cn:c==null?void 0:c.lunch_guideline})]}),Array.isArray(y.lunchCategories)&&y.lunchCategories.length===0&&n.jsx(_,{variant:"subtitle1",sx:{fontWeight:600,mb:1},children:q.lunchMenuWarn}),x&&n.jsx(g,{mt:3,display:"flex",justifyContent:"center",children:n.jsx(N,{onClick:()=>L("/report"),endIcon:n.jsx(ne,{}),sx:{bgcolor:C.blueAccent[50],color:C.blueAccent[700],"&:hover":{bgcolor:C.blueAccent[100],color:C.blueAccent[800]},padding:"10px 32px",boxShadow:"none",borderRadius:"30px",border:"none",borderRadius:4,fontWeight:600,fontSize:16,cursor:"pointer",width:"auto"},children:q.viewReport})}),W===1&&Array.isArray(y.lunchCategories)&&y.lunchCategories.some(i=>i.entreeItems&&i.entreeItems.some(d=>d.qty>0)||i.alternativeItems&&i.alternativeItems.some(d=>d.qty>0))&&!x&&n.jsx(g,{mt:3,display:"flex",justifyContent:"center",children:n.jsx(N,{sx:{padding:"10px 32px",bgcolor:C.blueAccent[700],color:"#fcfcfc",border:"none",borderRadius:4,fontWeight:600,fontSize:16,cursor:"pointer",width:"auto"},disabled:!I&&(w||$),onClick:()=>{X(y,A)},children:q.submit})})]}),W===2&&n.jsxs(g,{children:[Array.isArray(y.dinnerCategories)&&y.dinnerCategories.map((i,d)=>n.jsxs(g,{mb:3,children:[n.jsxs(_,{variant:"h6",sx:{mb:2,fontWeight:600,backgroundColor:"#f5f5f5",px:2,py:1,borderRadius:1,textAlign:"center"},children:[(c==null?void 0:c.langCode)==="cn"&&i.cat_name_cn&&i.cat_name_cn.trim()!==""?i.cat_name_cn:i.cat_name,i.cat_name==="DINNER ENTREE"&&` (${q.servedWithDessert})`]}),i.entreeItems.map(s=>n.jsxs(g,{mb:1,children:[n.jsxs(g,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[n.jsxs(g,{display:"flex",alignItems:"center",children:[s.image&&n.jsx("img",{src:s.image,alt:(c==null?void 0:c.langCode)==="cn"&&s.chinese_name?s.chinese_name:s.name,style:{width:64,height:64,objectFit:"cover",borderRadius:8,marginRight:12}}),n.jsx(_,{children:(c==null?void 0:c.langCode)==="cn"&&s.chinese_name?s.chinese_name:s.name})]}),n.jsxs(g,{display:"flex",alignItems:"center",children:[!x&&n.jsx("button",{onClick:()=>u(o=>({...o,dinnerCategories:o.dinnerCategories.map((h,p)=>p===d?{...h,entreeItems:h.entreeItems.map(t=>{if(t.id===s.id){const a=Math.max((t.qty||0)-1,0);return{...t,qty:a,options:(t.options||[]).length>0&&a===0?t.options.map((l,b)=>({...l,is_selected:b===0?1:0})):t.options,preference:(t.preference||[]).length>0&&a===0?t.preference.map(l=>({...l,is_selected:0})):t.preference}}return(t.qty||0)===0?{...t,options:(t.options||[]).length>0?t.options.map((a,l)=>({...a,is_selected:l===0?1:0})):t.options,preference:(t.preference||[]).length>0?t.preference.map(a=>({...a,is_selected:0})):t.preference}:t})}:h)})),style:{marginRight:8},disabled:s.qty===0||!I&&(w||O),children:"-"}),n.jsx(_,{sx:x?{fontSize:24,fontWeight:700}:{},children:s.qty||0}),!x&&n.jsx("button",{onClick:()=>{u(o=>{var a,l,b,k;const h=(((l=(a=o.dinnerCategories[d])==null?void 0:a.entreeItems)==null?void 0:l.reduce((r,e)=>r+(e.qty||0),0))||0)+(((k=(b=o.dinnerCategories[d])==null?void 0:b.alternativeItems)==null?void 0:k.reduce((r,e)=>r+(e.qty||0),0))||0);let p=[...o.dinnerCategories[d].entreeItems],t=[...o.dinnerCategories[d].alternativeItems||[]];if((c==null?void 0:c.role)!=="kitchen"&&h>=R){let r=!1;t=t.map(e=>{if(!r&&e.qty>0){r=!0;const f=e.qty-1;return{...e,qty:f,options:(e.options||[]).length>0&&e.qty>0&&f===0?e.options.map((m,j)=>({...m,is_selected:j===0?1:0})):e.options,preference:(e.preference||[]).length>0&&e.qty>0&&f===0?e.preference.map(m=>({...m,is_selected:0})):e.preference}}return e}),r||(p=p.map(e=>{if(!r&&e.id!==s.id&&e.qty>0){r=!0;const f=e.qty-1;return{...e,qty:f,options:(e.options||[]).length>0&&e.qty>0&&f===0?e.options.map((m,j)=>({...m,is_selected:j===0?1:0})):e.options,preference:(e.preference||[]).length>0&&e.qty>0&&f===0?e.preference.map(m=>({...m,is_selected:0})):e.preference}}return e}))}return p=p.map(r=>r.id===s.id?{...r,qty:(r.qty||0)+1,options:(r.options||[]).length>0&&(r.qty||0)===0?r.options.map((e,f)=>({...e,is_selected:f===0?1:0})):r.options,preference:(r.preference||[]).length>0&&(r.qty||0)===0?r.preference.map(e=>({...e,is_selected:0})):r.preference}:r),{...o,dinnerCategories:o.dinnerCategories.map((r,e)=>e===d?{...r,entreeItems:p,alternativeItems:t}:r)}})},style:{marginLeft:8},disabled:s.qty>=R||!I&&(w||O),children:"+"})]})]}),n.jsx(g,{mt:2,ml:1,sx:{width:"100%",minHeight:s.qty>0?"auto":0},children:s.qty>0&&n.jsxs(g,{mt:2,ml:1,children:[s.options&&s.options.length>0&&n.jsx(g,{mb:1,children:s.options.map(o=>n.jsxs("label",{style:{marginRight:12},children:[n.jsx("input",{type:"radio",name:`dinner-entree-option-${i.cat_id}-${s.id}`,checked:!!o.is_selected,onChange:()=>{u(h=>({...h,dinnerCategories:h.dinnerCategories.map((p,t)=>t===d?{...p,entreeItems:p.entreeItems.map(a=>a.id===s.id?{...a,options:a.options.map(l=>l.id===o.id?{...l,is_selected:1}:{...l,is_selected:0})}:a)}:p)}))}}),n.jsx("span",{style:{marginLeft:5},children:o.name})]},o.id))}),s.preference&&s.preference.length>0&&n.jsxs(g,{children:[n.jsx(_,{sx:{fontWeight:700,fontSize:18},children:"* Preference"}),s.preference.map(o=>n.jsxs("label",{style:{marginRight:12},children:[n.jsx("input",{type:"checkbox",checked:!!o.is_selected,onChange:()=>{u(h=>({...h,dinnerCategories:h.dinnerCategories.map((p,t)=>t===d?{...p,entreeItems:p.entreeItems.map(a=>a.id===s.id?{...a,preference:a.preference.map(l=>l.id===o.id?{...l,is_selected:l.is_selected?0:1}:l)}:a)}:p)}))}}),n.jsx("span",{style:{marginLeft:5},children:o.name})]},o.id))]})]})})]},s.id)),i.alternativeCatName&&n.jsx(_,{variant:"subtitle1",sx:{mt:3,mb:2,fontWeight:700},children:(c==null?void 0:c.langCode)==="cn"&&i.alternativeCatName_cn&&i.alternativeCatName_cn.trim()!==""?i.alternativeCatName_cn:i.alternativeCatName}),i.alternativeItems.map(s=>n.jsxs(g,{mb:1,ml:2,children:[n.jsxs(g,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[n.jsxs(g,{display:"flex",alignItems:"center",children:[s.image&&n.jsx("img",{src:s.image,alt:(c==null?void 0:c.langCode)==="cn"&&s.chinese_name?s.chinese_name:s.name,style:{width:64,height:64,objectFit:"cover",borderRadius:8,marginRight:12}}),n.jsx(_,{children:(c==null?void 0:c.langCode)==="cn"&&s.chinese_name?s.chinese_name:s.name})]}),n.jsxs(g,{display:"flex",alignItems:"center",children:[!x&&n.jsx("button",{onClick:()=>u(o=>({...o,dinnerCategories:o.dinnerCategories.map((h,p)=>p===d?{...h,alternativeItems:h.alternativeItems.map(t=>t.id===s.id?{...t,qty:Math.max((t.qty||0)-1,0),options:(t.options||[]).length>0&&Math.max((t.qty||0)-1,0)===0?t.options.map((a,l)=>({...a,is_selected:l===0?1:0})):t.options,preference:(t.preference||[]).length>0&&Math.max((t.qty||0)-1,0)===0?t.preference.map(a=>({...a,is_selected:0})):t.preference}:t)}:h)})),style:{marginRight:8},disabled:s.qty===0||!I&&(w||O),children:"-"}),n.jsx(_,{sx:x?{fontSize:24,fontWeight:700}:{},children:s.qty||0}),!x&&n.jsx("button",{onClick:()=>{u(o=>{var a,l,b,k;const h=(((l=(a=o.dinnerCategories[d])==null?void 0:a.entreeItems)==null?void 0:l.reduce((r,e)=>r+(e.qty||0),0))||0)+(((k=(b=o.dinnerCategories[d])==null?void 0:b.alternativeItems)==null?void 0:k.reduce((r,e)=>r+(e.qty||0),0))||0);let p=[...o.dinnerCategories[d].alternativeItems],t=[...o.dinnerCategories[d].entreeItems||[]];if(h>=R){let r=!1;t=t.map(e=>{if(!r&&e.qty>0){r=!0;const f=e.qty-1;return{...e,qty:f,options:(e.options||[]).length>0&&e.qty>0&&f===0?e.options.map((m,j)=>({...m,is_selected:j===0?1:0})):e.options,preference:(e.preference||[]).length>0&&e.qty>0&&f===0?e.preference.map(m=>({...m,is_selected:0})):e.preference}}return e}),r||(p=p.map(e=>{if(!r&&e.id!==s.id&&e.qty>0){r=!0;const f=e.qty-1;return{...e,qty:f,options:(e.options||[]).length>0&&e.qty>0&&f===0?e.options.map((m,j)=>({...m,is_selected:j===0?1:0})):e.options,preference:(e.preference||[]).length>0&&e.qty>0&&f===0?e.preference.map(m=>({...m,is_selected:0})):e.preference}}return e}))}return p=p.map(r=>r.id===s.id?{...r,qty:(r.qty||0)+1,options:(r.options||[]).length>0&&(r.qty||0)===0?r.options.map((e,f)=>({...e,is_selected:f===0?1:0})):r.options,preference:(r.preference||[]).length>0&&(r.qty||0)===0?r.preference.map(e=>({...e,is_selected:0})):r.preference}:r),{...o,dinnerCategories:o.dinnerCategories.map((r,e)=>e===d?{...r,entreeItems:t,alternativeItems:p}:r)}})},style:{marginLeft:8},disabled:s.qty>=R||!I&&(w||O),children:"+"})]})]}),n.jsx(g,{mt:2,ml:1,sx:{width:"100%",minHeight:s.qty>0?"auto":0},children:s.qty>0&&n.jsxs(g,{mt:2,ml:3,children:[s.options&&s.options.length>0&&n.jsx(g,{mb:1,children:s.options.map(o=>n.jsxs("label",{style:{marginRight:12},children:[n.jsx("input",{type:"radio",name:`dinner-alt-option-${i.cat_id}-${s.id}`,checked:!!o.is_selected,onChange:()=>{u(h=>({...h,dinnerCategories:h.dinnerCategories.map((p,t)=>t===d?{...p,alternativeItems:p.alternativeItems.map(a=>a.id===s.id?{...a,options:a.options.map(l=>l.id===o.id?{...l,is_selected:1}:{...l,is_selected:0})}:a)}:p)}))}}),n.jsx("span",{style:{marginLeft:5},children:o.name})]},o.id))}),s.preference&&s.preference.length>0&&n.jsxs(g,{children:[n.jsx(_,{sx:{fontWeight:700,fontSize:18},children:"* Preference"}),s.preference.map(o=>n.jsxs("label",{style:{marginRight:12},children:[n.jsx("input",{type:"checkbox",checked:!!o.is_selected,onChange:()=>{u(h=>({...h,dinnerCategories:h.dinnerCategories.map((p,t)=>t===d?{...p,alternativeItems:p.alternativeItems.map(a=>a.id===s.id?{...a,preference:a.preference.map(l=>l.id===o.id?{...l,is_selected:l.is_selected?0:1}:l)}:a)}:p)}))}}),n.jsx("span",{style:{marginLeft:5},children:o.name})]},o.id))]})]})})]},s.id))]},i.cat_id)),Array.isArray(y.dinnerCategories)&&y.dinnerCategories.some(i=>i.entreeItems&&i.entreeItems.some(d=>d.qty>0)||i.alternativeItems&&i.alternativeItems.some(d=>d.qty>0))&&!x&&n.jsx(g,{mt:3,display:"flex",gap:3,children:[{key:"is_dinner_tray_service",label:q.trayService},{key:"is_dinner_escort_service",label:q.escortService},{key:"is_dinner_takeout_service",label:q.Takeout}].map(i=>n.jsxs("label",{style:{display:"flex",alignItems:"center"},children:[n.jsx("input",{type:"checkbox",checked:y[i.key]===1,onChange:()=>{u(d=>({...d,is_dinner_tray_service:0,is_dinner_escort_service:0,is_dinner_takeout_service:0,[i.key]:d[i.key]===1?0:1}))}}),n.jsx("span",{style:{marginLeft:5},children:i.label})]},i.key))}),ke&&n.jsxs(n.Fragment,{children:[n.jsx("hr",{}),n.jsx(_,{variant:"subtitle1",sx:{fontWeight:600,mb:1},children:(c==null?void 0:c.langCode)==="cn"&&(c!=null&&c.dinner_guideline_cn)&&(c==null?void 0:c.dinner_guideline_cn.trim())!==""?c==null?void 0:c.dinner_guideline_cn:c==null?void 0:c.dinner_guideline})]}),Array.isArray(y.dinnerCategories)&&y.dinnerCategories.length===0&&n.jsx(_,{variant:"subtitle1",sx:{fontWeight:600,mb:1},children:q.dinnerMenuWarn}),x&&n.jsx(g,{mt:3,display:"flex",justifyContent:"center",children:n.jsx(N,{onClick:()=>L("/report"),endIcon:n.jsx(ne,{}),sx:{bgcolor:C.blueAccent[50],color:C.blueAccent[700],"&:hover":{bgcolor:C.blueAccent[100],color:C.blueAccent[800]},padding:"10px 32px",boxShadow:"none",borderRadius:"30px",border:"none",borderRadius:4,fontWeight:600,fontSize:16,cursor:"pointer",width:"auto"},children:q.viewReport})}),W===2&&Array.isArray(y.dinnerCategories)&&y.dinnerCategories.some(i=>i.entreeItems&&i.entreeItems.some(d=>d.qty>0)||i.alternativeItems&&i.alternativeItems.some(d=>d.qty>0))&&!x&&n.jsx(g,{mt:3,display:"flex",justifyContent:"center",children:n.jsx(N,{sx:{padding:"10px 32px",bgcolor:C.blueAccent[700],color:"#fcfcfc",border:"none",borderRadius:4,fontWeight:600,fontSize:16,cursor:"pointer",width:"auto"},disabled:!I&&(w||O),onClick:()=>{X(y,A)},children:q.submit})})]})]})]})]})};export{pn as default};
