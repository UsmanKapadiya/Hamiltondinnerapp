import{s as ee,k as ve,r as k,_ as N,j as i,l as Ae,T as Ke,d as tt,b as xo,a as yo,B as b,C as go}from"./index-Ic96-0uI.js";import{M as dt,H as wo}from"./Header-Czk5TdvV.js";import{P as ko}from"./PdfModal-uigtrwUf.js";import{c as Co,a as lt,b as W,d as To,F as Mo}from"./index.esm-Bh8irmIk.js";import{u as jo,y as ke,C as So}from"./js.cookie-BDhdAvxg.js";import{g as Re,b as Ue,u as Ee,c as Ye,e as De,f as Je,h as Ct,i as Le,s as We,S as Po,j as Io,P as Tt,k as vo,l as Mt,m as jt,n as Oo,o as St,p as Pt,q as mt,r as pt,t as Qt,v as Jt,w as Ao,x as _t,y as ft,M as Yo,z as Do,B as No,C as Ro,E as Uo,F as Bo,G as Lo,H as Wo,I as Ho,J as $o,K as Xe,N as Eo,O as it,Q as Xt,R as Zt,T as Ft,U as eo,V as Vo,W as to,X as qo,Y as zo,d as U,L as Ve,A as qe,D as ze}from"./AdapterDayjs-4xP3l0wz.js";import{_ as Ce}from"./lodash-DAfOK3me.js";import{S as Ze}from"./staticFormServices-lHyMdS4Q.js";import{F as Se,R as at}from"./Radio-n04liBtj.js";import{F as Oe,C as $e}from"./FormControlLabel-B-nMFMIY.js";import{k as oo,u as Go,T as Q}from"./TextField-DUcxEuMZ.js";import{u as Te,c as ut,P as r,D as Ko,a as Qo,b as Jo}from"./InputAdornment-QPfNViMu.js";import{I as io}from"./IconButton-6QtCe6bx.js";import{D as Xo}from"./DialogTitle-GN6cIxog.js";import"./api-DtAOtWGO.js";import"./Tooltip-07zIwyAt.js";function Zo(t){return Re("MuiTimeClock",t)}Ue("MuiTimeClock",["root","arrowSwitcher"]);const Qe=220,Ne=36,nt={x:Qe/2,y:Qe/2},no={x:nt.x,y:0},Fo=no.x-nt.x,ei=no.y-nt.y,ti=t=>t*(180/Math.PI),so=(t,s,c)=>{const e=s-nt.x,d=c-nt.y,u=Math.atan2(Fo,ei)-Math.atan2(e,d);let _=ti(u);_=Math.round(_/t)*t,_%=360;const p=Math.floor(_/t)||0,M=e**2+d**2,l=Math.sqrt(M);return{value:p,distance:l}},oi=(t,s,c=1)=>{const e=c*6;let{value:d}=so(e,t,s);return d=d*c%60,d},ii=(t,s,c)=>{const{value:e,distance:d}=so(30,t,s);let u=e||12;return c?u%=12:d<Qe/2-Ne&&(u+=12,u%=24),u};function ni(t){return Re("MuiClockPointer",t)}Ue("MuiClockPointer",["root","thumb"]);const si=["className","classes","isBetweenTwoClockValues","isInner","type","viewValue"],ri=t=>Ye({root:["root"],thumb:["thumb"]},ni,t),li=ee("div",{name:"MuiClockPointer",slot:"Root"})(({theme:t})=>({width:2,backgroundColor:(t.vars||t).palette.primary.main,position:"absolute",left:"calc(50% - 1px)",bottom:"50%",transformOrigin:"center bottom 0px",variants:[{props:{isClockPointerAnimated:!0},style:{transition:t.transitions.create(["transform","height"])}}]})),ai=ee("div",{name:"MuiClockPointer",slot:"Thumb"})(({theme:t})=>({width:4,height:4,backgroundColor:(t.vars||t).palette.primary.contrastText,borderRadius:"50%",position:"absolute",top:-21,left:`calc(50% - ${Ne/2}px)`,border:`${(Ne-4)/2}px solid ${(t.vars||t).palette.primary.main}`,boxSizing:"content-box",variants:[{props:{isClockPointerBetweenTwoValues:!1},style:{backgroundColor:(t.vars||t).palette.primary.main}}]}));function ci(t){const s=Te({props:t,name:"MuiClockPointer"}),{className:c,classes:e,isBetweenTwoClockValues:d,isInner:u,type:_,viewValue:p}=s,M=ve(s,si),l=k.useRef(_);k.useEffect(()=>{l.current=_},[_]);const{ownerState:v}=Ee(),w=N({},v,{isClockPointerAnimated:l.current!==_,isClockPointerBetweenTwoValues:d}),D=ri(e),T=()=>{let Y=360/(_==="hours"?12:60)*p;return _==="hours"&&p>12&&(Y-=360),{height:Math.round((u?.26:.4)*Qe),transform:`rotateZ(${Y}deg)`}};return i.jsx(li,N({style:T(),className:Ae(D.root,c),ownerState:w},M,{children:i.jsx(ai,{ownerState:w,className:D.thumb})}))}function di(t){return Re("MuiClock",t)}Ue("MuiClock",["root","clock","wrapper","squareMask","pin","amButton","pmButton","meridiemText","selected"]);const mi=(t,s)=>{const c={root:["root"],clock:["clock"],wrapper:["wrapper"],squareMask:["squareMask"],pin:["pin"],amButton:["amButton",s.clockMeridiemMode==="am"&&"selected"],pmButton:["pmButton",s.clockMeridiemMode==="pm"&&"selected"],meridiemText:["meridiemText"]};return Ye(c,di,t)},_i=ee("div",{name:"MuiClock",slot:"Root"})(({theme:t})=>({display:"flex",justifyContent:"center",alignItems:"center",margin:t.spacing(2)})),fi=ee("div",{name:"MuiClock",slot:"Clock"})({backgroundColor:"rgba(0,0,0,.07)",borderRadius:"50%",height:220,width:220,flexShrink:0,position:"relative",pointerEvents:"none"}),ui=ee("div",{name:"MuiClock",slot:"Wrapper"})({"&:focus":{outline:"none"}}),pi=ee("div",{name:"MuiClock",slot:"SquareMask"})({width:"100%",height:"100%",position:"absolute",pointerEvents:"auto",outline:0,touchAction:"none",userSelect:"none",variants:[{props:{isClockDisabled:!1},style:{"@media (pointer: fine)":{cursor:"pointer",borderRadius:"50%"},"&:active":{cursor:"move"}}}]}),hi=ee("div",{name:"MuiClock",slot:"Pin"})(({theme:t})=>({width:6,height:6,borderRadius:"50%",backgroundColor:(t.vars||t).palette.primary.main,position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"})),ro=(t,s)=>({zIndex:1,bottom:8,paddingLeft:4,paddingRight:4,width:Ne,variants:[{props:{clockMeridiemMode:s},style:{backgroundColor:(t.vars||t).palette.primary.main,color:(t.vars||t).palette.primary.contrastText,"&:hover":{backgroundColor:(t.vars||t).palette.primary.light}}}]}),bi=ee(io,{name:"MuiClock",slot:"AmButton"})(({theme:t})=>N({},ro(t,"am"),{position:"absolute",left:8})),xi=ee(io,{name:"MuiClock",slot:"PmButton"})(({theme:t})=>N({},ro(t,"pm"),{position:"absolute",right:8})),Et=ee(Ke,{name:"MuiClock",slot:"MeridiemText"})({overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"});function yi(t){const s=Te({props:t,name:"MuiClock"}),{ampm:c,ampmInClock:e,autoFocus:d,children:u,value:_,handleMeridiemChange:p,isTimeDisabled:M,meridiemMode:l,minutesStep:v=1,onChange:w,selectedId:D,type:T,viewValue:I,viewRange:[Y,B],disabled:L=!1,readOnly:q,className:V,classes:J}=s,G=De(),ie=Je(),{ownerState:$}=Ee(),ne=N({},$,{isClockDisabled:L,clockMeridiemMode:l}),O=k.useRef(!1),R=mi(J,ne),K=M(I,T),ce=!c&&T==="hours"&&(I<1||I>12),F=(C,xe)=>{L||q||M(C,T)||w(C,xe)},le=(C,xe)=>{let{offsetX:oe,offsetY:fe}=C;if(oe===void 0){const ue=C.target.getBoundingClientRect();oe=C.changedTouches[0].clientX-ue.left,fe=C.changedTouches[0].clientY-ue.top}const me=T==="seconds"||T==="minutes"?oi(oe,fe,v):ii(oe,fe,!!c);F(me,xe)},ge=C=>{O.current=!0,le(C,"shallow")},Pe=C=>{O.current&&(le(C,"finish"),O.current=!1),C.preventDefault()},Ie=C=>{C.buttons>0&&le(C.nativeEvent,"shallow")},we=C=>{O.current&&(O.current=!1),le(C.nativeEvent,"finish")},_e=T==="hours"?!1:I%5!==0,Me=T==="minutes"?v:1,X=k.useRef(null);Ct(()=>{d&&X.current.focus()},[d]);const te=C=>Math.max(Y,Math.min(B,C)),re=C=>(C+(B+1))%(B+1),ae=C=>{if(!O.current)switch(C.key){case"Home":F(Y,"partial"),C.preventDefault();break;case"End":F(B,"partial"),C.preventDefault();break;case"ArrowUp":F(re(I+Me),"partial"),C.preventDefault();break;case"ArrowDown":F(re(I-Me),"partial"),C.preventDefault();break;case"PageUp":F(te(I+5),"partial"),C.preventDefault();break;case"PageDown":F(te(I-5),"partial"),C.preventDefault();break;case"Enter":case" ":F(I,"finish"),C.preventDefault();break}};return i.jsxs(_i,{className:Ae(R.root,V),children:[i.jsxs(fi,{className:R.clock,children:[i.jsx(pi,{onTouchMove:ge,onTouchStart:ge,onTouchEnd:Pe,onMouseUp:we,onMouseMove:Ie,ownerState:ne,className:R.squareMask}),!K&&i.jsxs(k.Fragment,{children:[i.jsx(hi,{className:R.pin}),_!=null&&i.jsx(ci,{type:T,viewValue:I,isInner:ce,isBetweenTwoClockValues:_e})]}),i.jsx(ui,{"aria-activedescendant":D,"aria-label":ie.clockLabelText(T,_==null?null:G.format(_,c?"fullTime12h":"fullTime24h")),ref:X,role:"listbox",onKeyDown:ae,tabIndex:0,className:R.wrapper,children:u})]}),c&&e&&i.jsxs(k.Fragment,{children:[i.jsx(bi,{onClick:q?void 0:()=>p("am"),disabled:L||l===null,ownerState:ne,className:R.amButton,title:Le(G,"am"),children:i.jsx(Et,{variant:"caption",className:R.meridiemText,children:Le(G,"am")})}),i.jsx(xi,{disabled:L||l===null,onClick:q?void 0:()=>p("pm"),ownerState:ne,className:R.pmButton,title:Le(G,"pm"),children:i.jsx(Et,{variant:"caption",className:R.meridiemText,children:Le(G,"pm")})})]})]})}function gi(t){return Re("MuiClockNumber",t)}const ct=Ue("MuiClockNumber",["root","selected","disabled"]),wi=["className","classes","disabled","index","inner","label","selected"],ki=(t,s)=>{const c={root:["root",s.isClockNumberSelected&&"selected",s.isClockNumberDisabled&&"disabled"]};return Ye(c,gi,t)},Ci=ee("span",{name:"MuiClockNumber",slot:"Root",overridesResolver:(t,s)=>[s.root,{[`&.${ct.disabled}`]:s.disabled},{[`&.${ct.selected}`]:s.selected}]})(({theme:t})=>({height:Ne,width:Ne,position:"absolute",left:`calc((100% - ${Ne}px) / 2)`,display:"inline-flex",justifyContent:"center",alignItems:"center",borderRadius:"50%",color:(t.vars||t).palette.text.primary,fontFamily:t.typography.fontFamily,"&:focused":{backgroundColor:(t.vars||t).palette.background.paper},[`&.${ct.selected}`]:{color:(t.vars||t).palette.primary.contrastText},[`&.${ct.disabled}`]:{pointerEvents:"none",color:(t.vars||t).palette.text.disabled},variants:[{props:{isClockNumberInInnerRing:!0},style:N({},t.typography.body2,{color:(t.vars||t).palette.text.secondary})}]}));function lo(t){const s=Te({props:t,name:"MuiClockNumber"}),{className:c,classes:e,disabled:d,index:u,inner:_,label:p,selected:M}=s,l=ve(s,wi),{ownerState:v}=Ee(),w=N({},v,{isClockNumberInInnerRing:_,isClockNumberSelected:M,isClockNumberDisabled:d}),D=ki(e,w),T=u%12/12*Math.PI*2-Math.PI/2,I=(Qe-Ne-2)/2*(_?.65:1),Y=Math.round(Math.cos(T)*I),B=Math.round(Math.sin(T)*I);return i.jsx(Ci,N({className:Ae(D.root,c),"aria-disabled":d?!0:void 0,"aria-selected":M?!0:void 0,role:"option",style:{transform:`translate(${Y}px, ${B+(Qe-Ne)/2}px`},ownerState:w},l,{children:p}))}const Ti=({ampm:t,value:s,getClockNumberText:c,isDisabled:e,selectedId:d,utils:u})=>{const _=s?u.getHours(s):null,p=[],M=t?1:0,l=t?12:23,v=w=>_===null?!1:t?w===12?_===12||_===0:_===w||_-12===w:_===w;for(let w=M;w<=l;w+=1){let D=w.toString();w===0&&(D="00");const T=!t&&(w===0||w>12);D=u.formatNumber(D);const I=v(w);p.push(i.jsx(lo,{id:I?d:void 0,index:w,inner:T,selected:I,disabled:e(w),label:D,"aria-label":c(D)},w))}return p},Vt=({utils:t,value:s,isDisabled:c,getClockNumberText:e,selectedId:d})=>{const u=t.formatNumber;return[[5,u("05")],[10,u("10")],[15,u("15")],[20,u("20")],[25,u("25")],[30,u("30")],[35,u("35")],[40,u("40")],[45,u("45")],[50,u("50")],[55,u("55")],[0,u("00")]].map(([_,p],M)=>{const l=_===s;return i.jsx(lo,{label:p,id:l?d:void 0,index:M+1,inner:!1,disabled:c(_),selected:l,"aria-label":e(p)},_)})},It=({value:t,referenceDate:s,utils:c,props:e,timezone:d})=>{const u=k.useMemo(()=>We.getInitialReferenceValue({value:t,utils:c,props:e,referenceDate:s,granularity:Po.day,timezone:d,getTodayDate:()=>Io(c,d,"date")}),[]);return t??u},Mi=["ampm","ampmInClock","autoFocus","slots","slotProps","value","defaultValue","referenceDate","disableIgnoringDatePartForTimeValidation","maxTime","minTime","disableFuture","disablePast","minutesStep","shouldDisableTime","showViewSwitcher","onChange","view","views","openTo","onViewChange","focusedView","onFocusedViewChange","className","classes","disabled","readOnly","timezone"],ji=t=>Ye({root:["root"],arrowSwitcher:["arrowSwitcher"]},Zo,t),Si=ee(Tt,{name:"MuiTimeClock",slot:"Root"})({display:"flex",flexDirection:"column",position:"relative"}),Pi=ee(vo,{name:"MuiTimeClock",slot:"ArrowSwitcher"})({position:"absolute",right:12,top:15}),Ii=["hours","minutes"],vi=k.forwardRef(function(s,c){const e=De(),d=Te({props:s,name:"MuiTimeClock"}),{ampm:u=e.is12HourCycleInCurrentLocale(),ampmInClock:_=!1,autoFocus:p,slots:M,slotProps:l,value:v,defaultValue:w,referenceDate:D,disableIgnoringDatePartForTimeValidation:T=!1,maxTime:I,minTime:Y,disableFuture:B,disablePast:L,minutesStep:q=1,shouldDisableTime:V,showViewSwitcher:J,onChange:G,view:ie,views:$=Ii,openTo:ne,onViewChange:O,focusedView:R,onFocusedViewChange:K,className:ce,classes:F,disabled:le,readOnly:ge,timezone:Pe}=d,Ie=ve(d,Mi),{value:we,handleValueChange:_e,timezone:Me}=Mt({name:"TimeClock",timezone:Pe,value:v,defaultValue:w,referenceDate:D,onChange:G,valueManager:We}),X=It({value:we,referenceDate:D,utils:e,props:d,timezone:Me}),te=Je(),re=jt(Me),ae=Oo(),{ownerState:C}=Ee(),{view:xe,setView:oe,previousView:fe,nextView:me,setValueAndGoToNextView:ue}=St({view:ie,views:$,openTo:ne,onViewChange:O,onChange:_e,focusedView:R,onFocusedViewChange:K}),{meridiemMode:pe,handleMeridiemChange:he}=Pt(X,u,ue),o=k.useCallback((h,P)=>{const z=pt(T,e),f=P==="hours"||P==="minutes"&&$.includes("seconds"),x=({start:A,end:E})=>!(Y&&z(Y,E)||I&&z(A,I)||B&&z(A,re)||L&&z(re,f?E:A)),j=(A,E=1)=>{if(A%E!==0)return!1;if(V)switch(P){case"hours":return!V(e.setHours(X,A),"hours");case"minutes":return!V(e.setMinutes(X,A),"minutes");case"seconds":return!V(e.setSeconds(X,A),"seconds");default:return!1}return!0};switch(P){case"hours":{const A=mt(h,pe,u),E=e.setHours(X,A);if(e.getHours(E)!==A)return!0;const de=e.setSeconds(e.setMinutes(E,0),0),n=e.setSeconds(e.setMinutes(E,59),59);return!x({start:de,end:n})||!j(A)}case"minutes":{const A=e.setMinutes(X,h),E=e.setSeconds(A,0),de=e.setSeconds(A,59);return!x({start:E,end:de})||!j(h,q)}case"seconds":{const A=e.setSeconds(X,h);return!x({start:A,end:A})||!j(h)}default:throw new Error("not supported")}},[u,X,T,I,pe,Y,q,V,e,B,L,re,$]),a=k.useMemo(()=>{switch(xe){case"hours":{const h=(f,x)=>{const j=mt(f,pe,u);ue(e.setHours(X,j),x,"hours")},P=e.getHours(X);let z;return u?P>12?z=[12,23]:z=[0,11]:z=[0,23],{onChange:h,viewValue:P,children:Ti({value:we,utils:e,ampm:u,onChange:h,getClockNumberText:te.hoursClockNumberText,isDisabled:f=>le||o(f,"hours"),selectedId:ae}),viewRange:z}}case"minutes":{const h=e.getMinutes(X),P=(z,f)=>{ue(e.setMinutes(X,z),f,"minutes")};return{viewValue:h,onChange:P,children:Vt({utils:e,value:h,onChange:P,getClockNumberText:te.minutesClockNumberText,isDisabled:z=>le||o(z,"minutes"),selectedId:ae}),viewRange:[0,59]}}case"seconds":{const h=e.getSeconds(X),P=(z,f)=>{ue(e.setSeconds(X,z),f,"seconds")};return{viewValue:h,onChange:P,children:Vt({utils:e,value:h,onChange:P,getClockNumberText:te.secondsClockNumberText,isDisabled:z=>le||o(z,"seconds"),selectedId:ae}),viewRange:[0,59]}}default:throw new Error("You must provide the type for ClockView")}},[xe,e,we,u,te.hoursClockNumberText,te.minutesClockNumberText,te.secondsClockNumberText,pe,ue,X,o,ae,le]),m=ji(F);return i.jsxs(Si,N({ref:c,className:Ae(m.root,ce),ownerState:C},Ie,{children:[i.jsx(yi,N({autoFocus:p??!!R,ampmInClock:_&&$.includes("hours"),value:we,type:xe,ampm:u,minutesStep:q,isTimeDisabled:o,meridiemMode:pe,handleMeridiemChange:he,selectedId:ae,disabled:le,readOnly:ge},a)),J&&i.jsx(Pi,{className:m.arrowSwitcher,slots:M,slotProps:l,onGoToPrevious:()=>oe(fe),isPreviousDisabled:!fe,previousLabel:te.openPreviousView,onGoToNext:()=>oe(me),isNextDisabled:!me,nextLabel:te.openNextView,ownerState:C})]}))});function Oi(t){return Re("MuiDigitalClock",t)}Ue("MuiDigitalClock",["root","list","item"]);const Ai=["ampm","timeStep","autoFocus","slots","slotProps","value","defaultValue","referenceDate","disableIgnoringDatePartForTimeValidation","maxTime","minTime","disableFuture","disablePast","minutesStep","shouldDisableTime","onChange","view","openTo","onViewChange","focusedView","onFocusedViewChange","className","classes","disabled","readOnly","views","skipDisabled","timezone"],Yi=t=>Ye({root:["root"],list:["list"],item:["item"]},Oi,t),Di=ee(Tt,{name:"MuiDigitalClock",slot:"Root"})({overflowY:"auto",width:"100%",scrollbarWidth:"thin","@media (prefers-reduced-motion: no-preference)":{scrollBehavior:"auto"},maxHeight:Qt,variants:[{props:{hasDigitalClockAlreadyBeenRendered:!0},style:{"@media (prefers-reduced-motion: no-preference)":{scrollBehavior:"smooth"}}}]}),Ni=ee(oo,{name:"MuiDigitalClock",slot:"List"})({padding:0}),Ri=ee(dt,{name:"MuiDigitalClock",slot:"Item",shouldForwardProp:t=>t!=="itemValue"&&t!=="formattedValue"})(({theme:t})=>({padding:"8px 16px",margin:"2px 4px","&:first-of-type":{marginTop:4},"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.hoverOpacity})`:ut(t.palette.primary.main,t.palette.action.hoverOpacity)},"&.Mui-selected":{backgroundColor:(t.vars||t).palette.primary.main,color:(t.vars||t).palette.primary.contrastText,"&:focus-visible, &:hover":{backgroundColor:(t.vars||t).palette.primary.dark}},"&.Mui-focusVisible":{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.focusOpacity})`:ut(t.palette.primary.main,t.palette.action.focusOpacity)}})),Ui=k.forwardRef(function(s,c){const e=De(),d=k.useRef(null),u=Jt(c,d),_=k.useRef(null),p=Te({props:s,name:"MuiDigitalClock"}),{ampm:M=e.is12HourCycleInCurrentLocale(),timeStep:l=30,autoFocus:v,slots:w,slotProps:D,value:T,defaultValue:I,referenceDate:Y,disableIgnoringDatePartForTimeValidation:B=!1,maxTime:L,minTime:q,disableFuture:V,disablePast:J,minutesStep:G=1,shouldDisableTime:ie,onChange:$,view:ne,openTo:O,onViewChange:R,focusedView:K,onFocusedViewChange:ce,className:F,classes:le,disabled:ge,readOnly:Pe,views:Ie=["hours"],skipDisabled:we=!1,timezone:_e}=p,Me=ve(p,Ai),{value:X,handleValueChange:te,timezone:re}=Mt({name:"DigitalClock",timezone:_e,value:T,defaultValue:I,referenceDate:Y,onChange:$,valueManager:We}),ae=Je(),C=jt(re),{ownerState:xe}=Ee(),oe=N({},xe,{hasDigitalClockAlreadyBeenRendered:!!d.current}),fe=Yi(le),me=(w==null?void 0:w.digitalClockItem)??Ri,ue=Ao({elementType:me,externalSlotProps:D==null?void 0:D.digitalClockItem,ownerState:oe,className:fe.item}),pe=It({value:X,referenceDate:Y,utils:e,props:p,timezone:re}),he=_t(f=>te(f,"finish","hours")),{setValueAndGoToNextView:o}=St({view:ne,views:Ie,openTo:O,onViewChange:R,onChange:he,focusedView:K,onFocusedViewChange:ce}),a=_t(f=>{o(f,"finish")});Ct(()=>{if(d.current===null)return;const f=d.current.querySelector('[role="listbox"] [role="option"][tabindex="0"], [role="listbox"] [role="option"][aria-selected="true"]');if(!f)return;const x=f.offsetTop;(v||K)&&f.focus(),d.current.scrollTop=x-4});const m=k.useCallback(f=>{const x=pt(B,e),j=()=>!(q&&x(q,f)||L&&x(f,L)||V&&x(f,C)||J&&x(C,f)),A=()=>e.getMinutes(f)%G!==0?!1:ie?!ie(f,"hours"):!0;return!j()||!A()},[B,e,q,L,V,C,J,G,ie]),h=k.useMemo(()=>{const f=[];let j=e.startOfDay(pe);for(;e.isSameDay(pe,j);)f.push(j),j=e.addMinutes(j,l);return f},[pe,l,e]),P=h.findIndex(f=>e.isEqual(f,pe)),z=f=>{switch(f.key){case"PageUp":{const x=ft(_.current)-5,j=_.current.children,A=Math.max(0,x),E=j[A];E&&E.focus(),f.preventDefault();break}case"PageDown":{const x=ft(_.current)+5,j=_.current.children,A=Math.min(j.length-1,x),E=j[A];E&&E.focus(),f.preventDefault();break}}};return i.jsx(Di,N({ref:u,className:Ae(fe.root,F),ownerState:oe},Me,{children:i.jsx(Ni,{ref:_,role:"listbox","aria-label":ae.timePickerToolbarTitle,className:fe.list,onKeyDown:z,children:h.map((f,x)=>{const j=m(f);if(we&&j)return null;const A=e.isEqual(f,X),E=e.format(f,M?"fullTime12h":"fullTime24h"),n=P===x||P===-1&&x===0?0:-1;return i.jsx(me,N({onClick:()=>!Pe&&a(f),selected:A,disabled:ge||j,disableRipple:Pe,role:"option","aria-disabled":Pe,"aria-selected":A,tabIndex:n,itemValue:f,formattedValue:E},ue,{children:E}),`${f.valueOf()}-${E}`)})})}))});function Bi(t){return Re("MuiMultiSectionDigitalClock",t)}Ue("MuiMultiSectionDigitalClock",["root"]);function Li(t){return Re("MuiMultiSectionDigitalClockSection",t)}Ue("MuiMultiSectionDigitalClockSection",["root","item"]);const Wi=["autoFocus","onChange","className","classes","disabled","readOnly","items","active","slots","slotProps","skipDisabled"],Hi=t=>Ye({root:["root"],item:["item"]},Li,t),$i=ee(oo,{name:"MuiMultiSectionDigitalClockSection",slot:"Root"})(({theme:t})=>({maxHeight:Qt,width:56,padding:0,overflow:"hidden",scrollbarWidth:"thin","@media (prefers-reduced-motion: no-preference)":{scrollBehavior:"auto"},"@media (pointer: fine)":{"&:hover":{overflowY:"auto"}},"@media (pointer: none), (pointer: coarse)":{overflowY:"auto"},"&:not(:first-of-type)":{borderLeft:`1px solid ${(t.vars||t).palette.divider}`},"&::after":{display:"block",content:'""',height:"calc(100% - 40px - 6px)"},variants:[{props:{hasDigitalClockAlreadyBeenRendered:!0},style:{"@media (prefers-reduced-motion: no-preference)":{scrollBehavior:"smooth"}}}]})),Ei=ee(dt,{name:"MuiMultiSectionDigitalClockSection",slot:"Item"})(({theme:t})=>({padding:8,margin:"2px 4px",width:Yo,justifyContent:"center","&:first-of-type":{marginTop:4},"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.hoverOpacity})`:ut(t.palette.primary.main,t.palette.action.hoverOpacity)},"&.Mui-selected":{backgroundColor:(t.vars||t).palette.primary.main,color:(t.vars||t).palette.primary.contrastText,"&:focus-visible, &:hover":{backgroundColor:(t.vars||t).palette.primary.dark}},"&.Mui-focusVisible":{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.focusOpacity})`:ut(t.palette.primary.main,t.palette.action.focusOpacity)}})),Vi=k.forwardRef(function(s,c){const e=k.useRef(null),d=Jt(c,e),u=k.useRef(null),_=Te({props:s,name:"MuiMultiSectionDigitalClockSection"}),{autoFocus:p,onChange:M,className:l,classes:v,disabled:w,readOnly:D,items:T,active:I,slots:Y,slotProps:B,skipDisabled:L}=_,q=ve(_,Wi),{ownerState:V}=Ee(),J=N({},V,{hasDigitalClockAlreadyBeenRendered:!!e.current}),G=Hi(v),ie=(Y==null?void 0:Y.digitalClockSectionItem)??Ei;Ct(()=>{if(e.current===null)return;const O=e.current.querySelector('[role="option"][tabindex="0"], [role="option"][aria-selected="true"]');if(I&&p&&O&&O.focus(),!O||u.current===O)return;u.current=O;const R=O.offsetTop;e.current.scrollTop=R-4});const $=T.findIndex(O=>O.isFocused(O.value)),ne=O=>{switch(O.key){case"PageUp":{const R=ft(e.current)-5,K=e.current.children,ce=Math.max(0,R),F=K[ce];F&&F.focus(),O.preventDefault();break}case"PageDown":{const R=ft(e.current)+5,K=e.current.children,ce=Math.min(K.length-1,R),F=K[ce];F&&F.focus(),O.preventDefault();break}}};return i.jsx($i,N({ref:d,className:Ae(G.root,l),ownerState:J,autoFocusItem:p&&I,role:"listbox",onKeyDown:ne},q,{children:T.map((O,R)=>{var ge;const K=(ge=O.isDisabled)==null?void 0:ge.call(O,O.value),ce=w||K;if(L&&ce)return null;const F=O.isSelected(O.value),le=$===R||$===-1&&R===0?0:-1;return i.jsx(ie,N({onClick:()=>!D&&M(O.value),selected:F,disabled:ce,disableRipple:D,role:"option","aria-disabled":D||ce||void 0,"aria-label":O.ariaLabel,"aria-selected":F,tabIndex:le,className:G.item},B==null?void 0:B.digitalClockSectionItem,{children:O.label}),O.label)})}))}),qi=({now:t,value:s,utils:c,ampm:e,isDisabled:d,resolveAriaLabel:u,timeStep:_,valueOrReferenceDate:p})=>{const M=s?c.getHours(s):null,l=[],v=(T,I)=>{const Y=I??M;return Y===null?!1:e?T===12?Y===12||Y===0:Y===T||Y-12===T:Y===T},w=T=>v(T,c.getHours(p)),D=e?11:23;for(let T=0;T<=D;T+=_){let I=c.format(c.setHours(t,T),e?"hours12h":"hours24h");const Y=u(parseInt(I,10).toString());I=c.formatNumber(I),l.push({value:T,label:I,isSelected:v,isDisabled:d,isFocused:w,ariaLabel:Y})}return l},qt=({value:t,utils:s,isDisabled:c,timeStep:e,resolveLabel:d,resolveAriaLabel:u,hasValue:_=!0})=>{const p=l=>t===null?!1:_&&t===l,M=l=>t===l;return[...Array.from({length:Math.ceil(60/e)},(l,v)=>{const w=e*v;return{value:w,label:s.formatNumber(d(w)),isDisabled:c,isSelected:p,isFocused:M,ariaLabel:u(w.toString())}})]},zi=["ampm","timeSteps","autoFocus","slots","slotProps","value","defaultValue","referenceDate","disableIgnoringDatePartForTimeValidation","maxTime","minTime","disableFuture","disablePast","minutesStep","shouldDisableTime","onChange","view","views","openTo","onViewChange","focusedView","onFocusedViewChange","className","classes","disabled","readOnly","skipDisabled","timezone"],Gi=t=>Ye({root:["root"]},Bi,t),Ki=ee(Tt,{name:"MuiMultiSectionDigitalClock",slot:"Root"})(({theme:t})=>({flexDirection:"row",width:"100%",borderBottom:`1px solid ${(t.vars||t).palette.divider}`})),Qi=k.forwardRef(function(s,c){const e=De(),d=Go(),u=Te({props:s,name:"MuiMultiSectionDigitalClock"}),{ampm:_=e.is12HourCycleInCurrentLocale(),timeSteps:p,autoFocus:M,slots:l,slotProps:v,value:w,defaultValue:D,referenceDate:T,disableIgnoringDatePartForTimeValidation:I=!1,maxTime:Y,minTime:B,disableFuture:L,disablePast:q,minutesStep:V=1,shouldDisableTime:J,onChange:G,view:ie,views:$=["hours","minutes"],openTo:ne,onViewChange:O,focusedView:R,onFocusedViewChange:K,className:ce,classes:F,disabled:le,readOnly:ge,skipDisabled:Pe=!1,timezone:Ie}=u,we=ve(u,zi),{value:_e,handleValueChange:Me,timezone:X}=Mt({name:"MultiSectionDigitalClock",timezone:Ie,value:w,defaultValue:D,referenceDate:T,onChange:G,valueManager:We}),te=Je(),re=jt(X),ae=k.useMemo(()=>N({hours:1,minutes:5,seconds:5},p),[p]),C=It({value:_e,referenceDate:T,utils:e,props:u,timezone:X}),xe=_t((x,j,A)=>Me(x,j,A)),oe=k.useMemo(()=>!_||!$.includes("hours")||$.includes("meridiem")?$:[...$,"meridiem"],[_,$]),{view:fe,setValueAndGoToNextView:me,focusedView:ue}=St({view:ie,views:oe,openTo:ne,onViewChange:O,onChange:xe,focusedView:R,onFocusedViewChange:K}),pe=_t(x=>{me(x,"finish","meridiem")}),{meridiemMode:he,handleMeridiemChange:o}=Pt(C,_,pe,"finish"),a=k.useCallback((x,j)=>{const A=pt(I,e),E=j==="hours"||j==="minutes"&&oe.includes("seconds"),de=({start:y,end:S})=>!(B&&A(B,S)||Y&&A(y,Y)||L&&A(y,re)||q&&A(re,E?S:y)),n=(y,S=1)=>{if(y%S!==0)return!1;if(J)switch(j){case"hours":return!J(e.setHours(C,y),"hours");case"minutes":return!J(e.setMinutes(C,y),"minutes");case"seconds":return!J(e.setSeconds(C,y),"seconds");default:return!1}return!0};switch(j){case"hours":{const y=mt(x,he,_),S=e.setHours(C,y);if(e.getHours(S)!==y)return!0;const Z=e.setSeconds(e.setMinutes(S,0),0),je=e.setSeconds(e.setMinutes(S,59),59);return!de({start:Z,end:je})||!n(y)}case"minutes":{const y=e.setMinutes(C,x),S=e.setSeconds(y,0),Z=e.setSeconds(y,59);return!de({start:S,end:Z})||!n(x,V)}case"seconds":{const y=e.setSeconds(C,x);return!de({start:y,end:y})||!n(x)}default:throw new Error("not supported")}},[_,C,I,Y,he,B,V,J,e,L,q,re,oe]),m=k.useCallback(x=>{switch(x){case"hours":return{onChange:j=>{const A=mt(j,he,_);me(e.setHours(C,A),"finish","hours")},items:qi({now:re,value:_e,ampm:_,utils:e,isDisabled:j=>a(j,"hours"),timeStep:ae.hours,resolveAriaLabel:te.hoursClockNumberText,valueOrReferenceDate:C})};case"minutes":return{onChange:j=>{me(e.setMinutes(C,j),"finish","minutes")},items:qt({value:e.getMinutes(C),utils:e,isDisabled:j=>a(j,"minutes"),resolveLabel:j=>e.format(e.setMinutes(re,j),"minutes"),timeStep:ae.minutes,hasValue:!!_e,resolveAriaLabel:te.minutesClockNumberText})};case"seconds":return{onChange:j=>{me(e.setSeconds(C,j),"finish","seconds")},items:qt({value:e.getSeconds(C),utils:e,isDisabled:j=>a(j,"seconds"),resolveLabel:j=>e.format(e.setSeconds(re,j),"seconds"),timeStep:ae.seconds,hasValue:!!_e,resolveAriaLabel:te.secondsClockNumberText})};case"meridiem":{const j=Le(e,"am"),A=Le(e,"pm");return{onChange:o,items:[{value:"am",label:j,isSelected:()=>!!_e&&he==="am",isFocused:()=>!!C&&he==="am",ariaLabel:j},{value:"pm",label:A,isSelected:()=>!!_e&&he==="pm",isFocused:()=>!!C&&he==="pm",ariaLabel:A}]}}default:throw new Error(`Unknown view: ${x} found.`)}},[re,_e,_,e,ae.hours,ae.minutes,ae.seconds,te.hoursClockNumberText,te.minutesClockNumberText,te.secondsClockNumberText,he,me,C,a,o]),h=k.useMemo(()=>{if(!d)return oe;const x=oe.filter(j=>j!=="meridiem");return x.reverse(),oe.includes("meridiem")&&x.push("meridiem"),x},[d,oe]),P=k.useMemo(()=>oe.reduce((x,j)=>N({},x,{[j]:m(j)}),{}),[oe,m]),{ownerState:z}=Ee(),f=Gi(F);return i.jsx(Ki,N({ref:c,className:Ae(f.root,ce),ownerState:z,role:"group"},we,{children:h.map(x=>i.jsx(Vi,{items:P[x].items,onChange:P[x].onChange,active:fe===x,autoFocus:M||ue===x,disabled:le,readOnly:ge,slots:l,slotProps:v,skipDisabled:Pe,"aria-label":te.selectViewText(x)},x))}))}),ht=({adapter:t,value:s,timezone:c,props:e})=>{if(s===null)return null;const{minTime:d,maxTime:u,minutesStep:_,shouldDisableTime:p,disableIgnoringDatePartForTimeValidation:M=!1,disablePast:l,disableFuture:v}=e,w=t.utils.date(void 0,c),D=pt(M,t.utils);switch(!0){case!t.utils.isValid(s):return"invalidDate";case!!(d&&D(d,s)):return"minTime";case!!(u&&D(s,u)):return"maxTime";case!!(v&&t.utils.isAfter(s,w)):return"disableFuture";case!!(l&&t.utils.isBefore(s,w)):return"disablePast";case!!(p&&p(s,"hours")):return"shouldDisableTime-hours";case!!(p&&p(s,"minutes")):return"shouldDisableTime-minutes";case!!(p&&p(s,"seconds")):return"shouldDisableTime-seconds";case!!(_&&t.utils.getMinutes(s)%_!==0):return"minutesStep";default:return null}};ht.valueManager=We;function Ji(t={}){const{enableAccessibleFieldDOMStructure:s=!0,ampm:c}=t;return k.useMemo(()=>({valueType:"time",validator:ht,internal_valueManager:We,internal_fieldValueManager:Do,internal_enableAccessibleFieldDOMStructure:s,internal_useApplyDefaultValuesToFieldInternalProps:Zi,internal_useOpenPickerButtonAriaLabel:Xi(c)}),[c,s])}function Xi(t){return function(c){const e=De(),d=Je();return k.useMemo(()=>{const u=t??e.is12HourCycleInCurrentLocale()?"fullTime12h":"fullTime24h",_=e.isValid(c)?e.format(c,u):null;return d.openTimePickerDialogue(_)},[c,d,e])}}function Zi(t){const s=De(),c=ao(t),e=k.useMemo(()=>t.ampm??s.is12HourCycleInCurrentLocale(),[t.ampm,s]);return k.useMemo(()=>N({},t,c,{format:t.format??(e?s.formats.fullTime12h:s.formats.fullTime24h)}),[t,c,e,s])}function ao(t){return k.useMemo(()=>({disablePast:t.disablePast??!1,disableFuture:t.disableFuture??!1}),[t.disablePast,t.disableFuture])}const Fi=t=>{const s=Ji(t);return No({manager:s,props:t})},en=["slots","slotProps","InputProps","inputProps"],co=k.forwardRef(function(s,c){const e=Te({props:s,name:"MuiTimeField"}),{slots:d,slotProps:u}=e,_=ve(e,en),p=Ro({slotProps:u,ref:c,externalForwardedProps:_}),M=Fi(p);return i.jsx(Uo,{slots:d,slotProps:u,fieldResponse:M,defaultOpenPickerIcon:Bo})});function tn(t){return Re("MuiPickersToolbarText",t)}Ue("MuiPickersToolbarText",["root"]);const on=["className","classes","selected","value"],nn=t=>Ye({root:["root"]},tn,t),sn=ee(Ke,{name:"MuiPickersToolbarText",slot:"Root"})(({theme:t})=>({transition:t.transitions.create("color"),color:(t.vars||t).palette.text.secondary,"&[data-selected]":{color:(t.vars||t).palette.text.primary}})),mo=k.forwardRef(function(s,c){const e=Te({props:s,name:"MuiPickersToolbarText"}),{className:d,classes:u,selected:_,value:p}=e,M=ve(e,on),l=nn(u);return i.jsx(sn,N({ref:c,className:Ae(l.root,d),component:"span",ownerState:e},_&&{"data-selected":!0},M,{children:p}))}),rn=["align","className","classes","selected","typographyClassName","value","variant","width"],ln=t=>Ye({root:["root"]},Lo,t),an=ee(tt,{name:"MuiPickersToolbarButton",slot:"Root"})({padding:0,minWidth:16,textTransform:"none"}),Fe=k.forwardRef(function(s,c){const e=Te({props:s,name:"MuiPickersToolbarButton"}),{align:d,className:u,classes:_,selected:p,typographyClassName:M,value:l,variant:v,width:w}=e,D=ve(e,rn),T=ln(_);return i.jsx(an,N({variant:"text",ref:c,className:Ae(T.root,u),ownerState:e},w?{sx:{width:w}}:{},D,{children:i.jsx(mo,{align:d,className:M,variant:v,value:l,selected:p})}))});function cn(t){return Re("MuiTimePickerToolbar",t)}const ot=Ue("MuiTimePickerToolbar",["root","separator","hourMinuteLabel","hourMinuteLabelLandscape","hourMinuteLabelReverse","ampmSelection","ampmLandscape","ampmLabel"]),dn=["ampm","ampmInClock","className","classes"],mn=(t,s)=>{const{pickerOrientation:c,toolbarDirection:e}=s;return Ye({root:["root"],separator:["separator"],hourMinuteLabel:["hourMinuteLabel",c==="landscape"&&"hourMinuteLabelLandscape",e==="rtl"&&"hourMinuteLabelReverse"],ampmSelection:["ampmSelection",c==="landscape"&&"ampmLandscape"],ampmLabel:["ampmLabel"]},cn,t)},_n=ee(Wo,{name:"MuiTimePickerToolbar",slot:"Root"})({}),fn=ee(mo,{name:"MuiTimePickerToolbar",slot:"Separator"})({outline:0,margin:"0 4px 0 2px",cursor:"default"}),un=ee("div",{name:"MuiTimePickerToolbar",slot:"HourMinuteLabel",overridesResolver:(t,s)=>[{[`&.${ot.hourMinuteLabelLandscape}`]:s.hourMinuteLabelLandscape,[`&.${ot.hourMinuteLabelReverse}`]:s.hourMinuteLabelReverse},s.hourMinuteLabel]})({display:"flex",justifyContent:"flex-end",alignItems:"flex-end",variants:[{props:{toolbarDirection:"rtl"},style:{flexDirection:"row-reverse"}},{props:{pickerOrientation:"landscape"},style:{marginTop:"auto"}}]}),pn=ee("div",{name:"MuiTimePickerToolbar",slot:"AmPmSelection",overridesResolver:(t,s)=>[{[`.${ot.ampmLabel}`]:s.ampmLabel},{[`&.${ot.ampmLandscape}`]:s.ampmLandscape},s.ampmSelection]})({display:"flex",flexDirection:"column",marginRight:"auto",marginLeft:12,[`& .${ot.ampmLabel}`]:{fontSize:17},variants:[{props:{pickerOrientation:"landscape"},style:{margin:"4px 0 auto",flexDirection:"row",justifyContent:"space-around",flexBasis:"100%"}}]});function hn(t){const s=Te({props:t,name:"MuiTimePickerToolbar"}),{ampm:c,ampmInClock:e,className:d,classes:u}=s,_=ve(s,dn),p=De(),M=Je(),l=Ho(),v=mn(u,l),{value:w,setValue:D,disabled:T,readOnly:I,view:Y,setView:B,views:L}=$o(),q=!!(c&&!e&&L.includes("hours")),{meridiemMode:V,handleMeridiemChange:J}=Pt(w,c,$=>D($,{changeImportance:"set"})),G=$=>p.isValid(w)?p.format(w,$):"--",ie=i.jsx(fn,{tabIndex:-1,value:":",variant:"h3",selected:!1,className:v.separator});return i.jsxs(_n,N({landscapeDirection:"row",toolbarTitle:M.timePickerToolbarTitle,ownerState:l,className:Ae(v.root,d)},_,{children:[i.jsxs(un,{className:v.hourMinuteLabel,ownerState:l,children:[Xe(L,"hours")&&i.jsx(Fe,{tabIndex:-1,variant:"h3",onClick:()=>B("hours"),selected:Y==="hours",value:G(c?"hours12h":"hours24h")}),Xe(L,["hours","minutes"])&&ie,Xe(L,"minutes")&&i.jsx(Fe,{tabIndex:-1,variant:"h3",onClick:()=>B("minutes"),selected:Y==="minutes",value:G("minutes")}),Xe(L,["minutes","seconds"])&&ie,Xe(L,"seconds")&&i.jsx(Fe,{variant:"h3",onClick:()=>B("seconds"),selected:Y==="seconds",value:G("seconds")})]}),q&&i.jsxs(pn,{className:v.ampmSelection,ownerState:l,children:[i.jsx(Fe,{disableRipple:!0,variant:"subtitle2",selected:V==="am",typographyClassName:v.ampmLabel,value:Le(p,"am"),onClick:I?void 0:()=>J("am"),disabled:T}),i.jsx(Fe,{disableRipple:!0,variant:"subtitle2",selected:V==="pm",typographyClassName:v.ampmLabel,value:Le(p,"pm"),onClick:I?void 0:()=>J("pm"),disabled:T})]})]}))}function _o(t,s){var p;const c=De(),e=Te({props:t,name:s}),d=ao(e),u=e.ampm??c.is12HourCycleInCurrentLocale(),_=k.useMemo(()=>{var M;return((M=e.localeText)==null?void 0:M.toolbarTitle)==null?e.localeText:N({},e.localeText,{timePickerToolbarTitle:e.localeText.toolbarTitle})},[e.localeText]);return N({},e,d,{ampm:u,localeText:_},Eo({views:e.views,openTo:e.openTo,defaultViews:["hours","minutes"],defaultOpenTo:"hours"}),{slots:N({toolbar:hn},e.slots),slotProps:N({},e.slotProps,{toolbar:N({ampm:u,ampmInClock:e.ampmInClock},(p=e.slotProps)==null?void 0:p.toolbar)})})}const xt=({view:t,onViewChange:s,focusedView:c,onFocusedViewChange:e,views:d,value:u,defaultValue:_,referenceDate:p,onChange:M,className:l,classes:v,disableFuture:w,disablePast:D,minTime:T,maxTime:I,shouldDisableTime:Y,minutesStep:B,ampm:L,ampmInClock:q,slots:V,slotProps:J,readOnly:G,disabled:ie,sx:$,autoFocus:ne,showViewSwitcher:O,disableIgnoringDatePartForTimeValidation:R,timezone:K})=>i.jsx(vi,{view:t,onViewChange:s,focusedView:c&&it(c)?c:null,onFocusedViewChange:e,views:d.filter(it),value:u,defaultValue:_,referenceDate:p,onChange:M,className:l,classes:v,disableFuture:w,disablePast:D,minTime:T,maxTime:I,shouldDisableTime:Y,minutesStep:B,ampm:L,ampmInClock:q,slots:V,slotProps:J,readOnly:G,disabled:ie,sx:$,autoFocus:ne,showViewSwitcher:O,disableIgnoringDatePartForTimeValidation:R,timezone:K}),bn=({view:t,onViewChange:s,focusedView:c,onFocusedViewChange:e,views:d,value:u,defaultValue:_,referenceDate:p,onChange:M,className:l,classes:v,disableFuture:w,disablePast:D,minTime:T,maxTime:I,shouldDisableTime:Y,minutesStep:B,ampm:L,slots:q,slotProps:V,readOnly:J,disabled:G,sx:ie,autoFocus:$,disableIgnoringDatePartForTimeValidation:ne,timeSteps:O,skipDisabled:R,timezone:K})=>i.jsx(Ui,{view:t,onViewChange:s,focusedView:c&&it(c)?c:null,onFocusedViewChange:e,views:d.filter(it),value:u,defaultValue:_,referenceDate:p,onChange:M,className:l,classes:v,disableFuture:w,disablePast:D,minTime:T,maxTime:I,shouldDisableTime:Y,minutesStep:B,ampm:L,slots:q,slotProps:V,readOnly:J,disabled:G,sx:ie,autoFocus:$,disableIgnoringDatePartForTimeValidation:ne,timeStep:O==null?void 0:O.minutes,skipDisabled:R,timezone:K}),zt=({view:t,onViewChange:s,focusedView:c,onFocusedViewChange:e,views:d,value:u,defaultValue:_,referenceDate:p,onChange:M,className:l,classes:v,disableFuture:w,disablePast:D,minTime:T,maxTime:I,shouldDisableTime:Y,minutesStep:B,ampm:L,slots:q,slotProps:V,readOnly:J,disabled:G,sx:ie,autoFocus:$,disableIgnoringDatePartForTimeValidation:ne,timeSteps:O,skipDisabled:R,timezone:K})=>i.jsx(Qi,{view:t,onViewChange:s,focusedView:c&&Xt(c)?c:null,onFocusedViewChange:e,views:d.filter(it),value:u,defaultValue:_,referenceDate:p,onChange:M,className:l,classes:v,disableFuture:w,disablePast:D,minTime:T,maxTime:I,shouldDisableTime:Y,minutesStep:B,ampm:L,slots:q,slotProps:V,readOnly:J,disabled:G,sx:ie,autoFocus:$,disableIgnoringDatePartForTimeValidation:ne,timeSteps:O,skipDisabled:R,timezone:K}),xn=(t,s,c)=>c?s.filter(e=>!Xt(e)||e==="hours"):t?[...s,"meridiem"]:s,yn=(t,s)=>24*60/((t.hours??1)*(t.minutes??5))<=s;function gn({thresholdToRenderTimeInASingleColumn:t,ampm:s,timeSteps:c,views:e}){const d=t??24,u=N({hours:1,minutes:5,seconds:5},c),_=yn(u,d);return{thresholdToRenderTimeInASingleColumn:d,timeSteps:u,shouldRenderTimeInASingleColumn:_,views:xn(s,e,_)}}const fo=k.forwardRef(function(s,c){var Y,B;const e=De(),d=_o(s,"MuiDesktopTimePicker"),{shouldRenderTimeInASingleColumn:u,views:_,timeSteps:p}=gn(d),M=u?bn:zt,l=N({hours:M,minutes:M,seconds:M,meridiem:M},d.viewRenderers),v=d.ampmInClock??!0,D=((Y=l.hours)==null?void 0:Y.name)===zt.name?_:_.filter(L=>L!=="meridiem"),T=N({},d,{ampmInClock:v,timeSteps:p,viewRenderers:l,format:Zt(e,d),views:u?["hours"]:D,slots:N({field:co},d.slots),slotProps:N({},d.slotProps,{field:L=>{var q;return N({},Ft((q=d.slotProps)==null?void 0:q.field,L),eo(d))},toolbar:N({hidden:!0,ampmInClock:v},(B=d.slotProps)==null?void 0:B.toolbar)})}),{renderPicker:I}=Vo({ref:c,props:T,valueManager:We,valueType:"time",validator:ht,steps:null});return I()});fo.propTypes={ampm:r.bool,ampmInClock:r.bool,autoFocus:r.bool,className:r.string,closeOnSelect:r.bool,defaultValue:r.object,disabled:r.bool,disableFuture:r.bool,disableIgnoringDatePartForTimeValidation:r.bool,disableOpenPicker:r.bool,disablePast:r.bool,enableAccessibleFieldDOMStructure:r.any,format:r.string,formatDensity:r.oneOf(["dense","spacious"]),inputRef:to,label:r.node,localeText:r.object,maxTime:r.object,minTime:r.object,minutesStep:r.number,name:r.string,onAccept:r.func,onChange:r.func,onClose:r.func,onError:r.func,onOpen:r.func,onSelectedSectionsChange:r.func,onViewChange:r.func,open:r.bool,openTo:r.oneOf(["hours","meridiem","minutes","seconds"]),orientation:r.oneOf(["landscape","portrait"]),readOnly:r.bool,reduceAnimations:r.bool,referenceDate:r.object,selectedSections:r.oneOfType([r.oneOf(["all","day","empty","hours","meridiem","minutes","month","seconds","weekDay","year"]),r.number]),shouldDisableTime:r.func,skipDisabled:r.bool,slotProps:r.object,slots:r.object,sx:r.oneOfType([r.arrayOf(r.oneOfType([r.func,r.object,r.bool])),r.func,r.object]),thresholdToRenderTimeInASingleColumn:r.number,timeSteps:r.shape({hours:r.number,minutes:r.number,seconds:r.number}),timezone:r.string,value:r.object,view:r.oneOf(["hours","meridiem","minutes","seconds"]),viewRenderers:r.shape({hours:r.func,meridiem:r.func,minutes:r.func,seconds:r.func}),views:r.arrayOf(r.oneOf(["hours","minutes","seconds"]).isRequired)};const uo=k.forwardRef(function(s,c){var l;const e=De(),d=_o(s,"MuiMobileTimePicker"),u=N({hours:xt,minutes:xt,seconds:xt},d.viewRenderers),_=d.ampmInClock??!1,p=N({},d,{ampmInClock:_,viewRenderers:u,format:Zt(e,d),slots:N({field:co},d.slots),slotProps:N({},d.slotProps,{field:v=>{var w;return N({},Ft((w=d.slotProps)==null?void 0:w.field,v),eo(d))},toolbar:N({hidden:!1,ampmInClock:_},(l=d.slotProps)==null?void 0:l.toolbar)})}),{renderPicker:M}=qo({ref:c,props:p,valueManager:We,valueType:"time",validator:ht,steps:null});return M()});uo.propTypes={ampm:r.bool,ampmInClock:r.bool,autoFocus:r.bool,className:r.string,closeOnSelect:r.bool,defaultValue:r.object,disabled:r.bool,disableFuture:r.bool,disableIgnoringDatePartForTimeValidation:r.bool,disableOpenPicker:r.bool,disablePast:r.bool,enableAccessibleFieldDOMStructure:r.any,format:r.string,formatDensity:r.oneOf(["dense","spacious"]),inputRef:to,label:r.node,localeText:r.object,maxTime:r.object,minTime:r.object,minutesStep:r.number,name:r.string,onAccept:r.func,onChange:r.func,onClose:r.func,onError:r.func,onOpen:r.func,onSelectedSectionsChange:r.func,onViewChange:r.func,open:r.bool,openTo:r.oneOf(["hours","minutes","seconds"]),orientation:r.oneOf(["landscape","portrait"]),readOnly:r.bool,reduceAnimations:r.bool,referenceDate:r.object,selectedSections:r.oneOfType([r.oneOf(["all","day","empty","hours","meridiem","minutes","month","seconds","weekDay","year"]),r.number]),shouldDisableTime:r.func,slotProps:r.object,slots:r.object,sx:r.oneOfType([r.arrayOf(r.oneOfType([r.func,r.object,r.bool])),r.func,r.object]),timezone:r.string,value:r.object,view:r.oneOf(["hours","minutes","seconds"]),viewRenderers:r.shape({hours:r.func,minutes:r.func,seconds:r.func}),views:r.arrayOf(r.oneOf(["hours","minutes","seconds"]).isRequired)};const wn=["desktopModeMediaQuery"],Ge=k.forwardRef(function(s,c){const e=Te({props:s,name:"MuiTimePicker"}),{desktopModeMediaQuery:d=zo}=e,u=ve(e,wn);return jo(d,{defaultMatches:!0})?i.jsx(fo,N({ref:c},u)):i.jsx(uo,N({ref:c},u))}),Gt=[{key:"inc_invl_resident",label:"Resident"},{key:"inc_invl_staff",label:"Staff"},{key:"inc_invl_visitor",label:"Visitor"},{key:"inc_invl_other",label:"Other"}],yt=[{key:"type_of_inc_fall",label:"Fall"},{key:"type_of_inc_fire",label:"Fire"},{key:"type_of_inc_security",label:"Security"},{key:"type_of_inc_elopement",label:"Elopement"},{key:"type_of_inc_death",label:"Death"},{key:"type_of_inc_resAbase",label:"Resident Abase"},{key:"type_of_inc_treatment",label:"Treatment"},{key:"type_of_inc_lossOfProp",label:"Loss of Property"},{key:"type_of_inc_choking",label:"Choking"},{key:"type_of_inc_aggresiveBeh",label:"Aggressive Behavior"},{key:"type_of_inc_other",label:"Other"}],gt=[{key:"condition_at_inc_oriented",label:"Oriented"},{key:"condition_at_inc_disOriented",label:"Disoriented"},{key:"condition_at_inc_sedated",label:"Sedated"},{key:"condition_at_inc_other",label:"Other (Specify)"}],Kt=[{key:"fall_assess_mediChange",label:"Medication Change"},{key:"fall_assess_cardMedi",label:"Cardiac Medications"},{key:"fall_assess_visDef",label:"Visual Deficit"},{key:"fall_assess_moodAltMedi",label:"Mood Altering Medication"},{key:"fall_assess_relocation",label:"Relocation"},{key:"fall_assess_tempIllness",label:"Temporary Illness"}],wt=[{key:"ambulation_unlimited",label:"Unlimited"},{key:"ambulation_limited",label:"Limited"},{key:"ambulation_reqAssist",label:"Required assistance"},{key:"ambulation_wheelChair",label:"Wheelchair"},{key:"ambulation_walker",label:"Walker"},{key:"ambulation_other",label:"Other (Specify)"}],kn=[{key:"fire_alarm_pulled",label:"Alarm pulled"},{key:"fire_false_alarm",label:"False alarm"},{key:"fire_extinguisher_used",label:"Extinguisher used"},{key:"fire_personal_injury",label:"Personal injury"},{key:"fire_property_damage",label:"Resident or facility property damage"}],kt=[{key:"informed_of_inc_AGM",label:"Assistant General Manager"},{key:"informed_of_inc_GM",label:"General Manager"},{key:"informed_of_inc_RMC",label:"Risk Management Committee"},{key:"informed_of_inc_other",label:"Other"}],Cn=[{key:"Yes",label:"Yes"},{key:"No",label:"No"}],Tn=[{key:"safety_fob",label:"Fob was within reach"},{key:"safety_callbell",label:"Call bell within reach"},{key:"safety_caution",label:"Caution signs in place"}],Mn=Co({incident_involved:lt().of(W()).min(1,"Please select Incident Involved"),inc_invl_other_text:W().when("incident_involved",{is:t=>Array.isArray(t)&&t.includes("Other"),then:t=>t.required("Please enter other Incident Involved"),otherwise:t=>t}),incident_date:W().required("Date is required"),incident_tm:W().required("Time Of Incident is required"),incident_location:W().required("Location Of Incident is required"),witnessed_by:W().required("Witnessed By is required"),discovery_date:W().required("Date Of Discovery is required"),discovery_tm:W().required("Time Of Discovery is required"),discovery_location:W().required("Location Of Discovery is required"),discovered_by:W().required("Discovered By is required"),type_of_incident:lt().of(W()),type_of_inc_other_text:W().when("type_of_incident",{is:t=>Array.isArray(t)&&t.includes("Other"),then:t=>t.required("Please enter Other Type Of Incident"),otherwise:t=>t}),other_witnesses:W(),witness_name1:W().when("other_witnesses",{is:"Yes",then:t=>t.required("Witness Name 1 is required"),otherwise:t=>t}),witness_position1:W().when("other_witnesses",{is:"Yes",then:t=>t.required("Witness Position 1 is required"),otherwise:t=>t}),condition_at_incident:lt().of(W()),condition_at_inc_other_text:W().when("condition_at_incident",{is:t=>Array.isArray(t)&&t.includes("Other (Specify)"),then:t=>t.required("Please specify Other Condition"),otherwise:t=>t}),ambulation:lt().of(W()),ambulation_other_text:W().when("ambulation",{is:t=>Array.isArray(t)&&t.includes("Other (Specify)"),then:t=>t.required("Please specify Other Condition"),otherwise:t=>t}),informed_of_inc_other:To(),informed_of_inc_other_text:W().when("informed_of_inc_other",{is:!0,then:t=>t.required("Please specify Other Condition"),otherwise:t=>t}),notified_family_doctor:W(),notified_family_doctor_date:W().when("notified_family_doctor",{is:t=>!!t,then:t=>t.required("Date is required when Family Doctor is notified"),otherwise:t=>t}),notified_family_doctor_tm:W().when("notified_family_doctor",{is:t=>!!t,then:t=>t.required("Time is required when Family Doctor is notified"),otherwise:t=>t}),notified_resident_responsible_party:W(),notified_resident_name:W().when("notified_resident_responsible_party",{is:"Yes",then:t=>t.required("Notified Resident Name is required"),otherwise:t=>t}),notified_resident_date:W().when("notified_resident_responsible_party",{is:"Yes",then:t=>t.required("Notified Resident Date is required"),otherwise:t=>t}),notified_resident_tm:W().when("notified_resident_responsible_party",{is:"Yes",then:t=>t.required("Notified Resident Time is required"),otherwise:t=>t}),notified_other:W(),notified_other_date:W().when("notified_other",{is:t=>!!t&&t.trim()!=="",then:t=>t.required("Date is required when Other is notified"),otherwise:t=>t}),notified_other_tm:W().when("notified_other",{is:t=>!!t&&t.trim()!=="",then:t=>t.required("Time is required when Other is notified"),otherwise:t=>t}),completed_by:W().required("Completed By is required"),completed_position:W().required("Completed Position is required"),completed_date:W().required("Completed Date is required"),completed_tm:W().required("Completed Time is required"),follow_up_assigned_to:W().required("Assign Follow Up to is required")}),et=(t,s,c="Other",e="other_text",d="arr")=>{if(!t)return{[d]:[],[e]:""};const u=t.split(",").map(l=>l.trim()),_=s.map(l=>l.label),p=[];let M="";return u.forEach(l=>{_.includes(l)?p.push(l):l&&(p.push(c),M=l)}),{[d]:Ce.uniq(p),[e]:M}},jn=()=>{try{const t=localStorage.getItem("userData");return t?JSON.parse(t):null}catch(t){return console.error("Error parsing user data:",t),null}},En=()=>{var C,xe,oe,fe,me,ue,pe,he;const t=xo(),s=yo(),c=k.useRef(null),[e,d]=k.useState({}),[u,_]=k.useState(!0),[p,M]=k.useState(),[l]=k.useState(jn),[v,w]=k.useState(!1),[D,T]=k.useState(!1),[I,Y]=k.useState(null),[B,L]=k.useState(null),[q,V]=k.useState(!1),[J,G]=k.useState(""),[ie,$]=k.useState(null),[ne,O]=k.useState(!1),R=k.useMemo(()=>Ce.includes(["admin","superadmin"],l==null?void 0:l.role),[l==null?void 0:l.role]),K=k.useMemo(()=>{var o,a,m;return R||(l==null?void 0:l.user_id)===((m=(a=(o=t==null?void 0:t.state)==null?void 0:o.formData)==null?void 0:a.follow_up_user)==null?void 0:m.id)},[R,l==null?void 0:l.user_id,(oe=(xe=(C=t==null?void 0:t.state)==null?void 0:C.formData)==null?void 0:xe.follow_up_user)==null?void 0:oe.id]),ce=k.useCallback(o=>et(o,Gt,"Other","inc_invl_other_text","incident_involved"),[]),F=k.useCallback(o=>et(o,yt,"Other","type_of_inc_other_text","type_of_incident"),[]),le=k.useCallback(o=>et(o,gt,"Other (Specify)","condition_at_inc_other_text","condition_at_incident"),[]),ge=k.useCallback(o=>et(o,wt,"Other (Specify)","ambulation_other_text","ambulation"),[]),Pe=k.useCallback(o=>et(o,kt,"Other","informed_of_inc_other_text","informed_of_incident"),[]);k.useEffect(()=>{var o;(o=t.state)!=null&&o.scrollToFollowUp&&c.current&&setTimeout(()=>{c.current&&c.current.scrollIntoView({behavior:"smooth",block:"start"})},500)},[(fe=t.state)==null?void 0:fe.scrollToFollowUp,u]),k.useEffect(()=>{var o,a,m;if(_(!0),((a=(o=t.state)==null?void 0:o.formData)==null?void 0:a.ResponseCode)==="1"){const h=t.state.formData.form_data||{};M((m=t.state)==null?void 0:m.id);const P=["followUp_issue","followUp_findings","followUp_possible_solutions","followUp_action_plan","followUp_examine_result"].some(f=>!!h[f]),z={...h,incident_date:h.incident_dt?U(h.incident_dt,"DD MMM YYYY").format("YYYY-MM-DD"):h.incident_date||"",discovery_date:h.discovery_dt?U(h.discovery_dt,"DD MMM YYYY").format("YYYY-MM-DD"):h.discovery_date||"",notified_family_doctor_date:h.notified_family_doctor_dt?U(h.notified_family_doctor_dt,"DD MMM YYYY").format("YYYY-MM-DD"):h.notified_family_doctor_date||"",notified_other_date:h.notified_other_dt?U(h.notified_other_dt,"DD MMM YYYY").format("YYYY-MM-DD"):h.notified_other_date||"",notified_resident_date:h.notified_resident_dt?U(h.notified_resident_dt,"DD MMM YYYY").format("YYYY-MM-DD"):h.notified_resident_date||"",completed_date:h.completed_dt?U(h.completed_dt,"DD MMM YYYY").format("YYYY-MM-DD"):h.completed_date||""};d({...z,...ce(h.incident_involved),...F(h.type_of_incident),...le(h.condition_at_incident),...ge(h.ambulation),...Pe(h.informed_of_incident),fall_assessment:h.fall_assessment?h.fall_assessment.split(","):[],follow_up_assigned_to:h.follow_up_assigned_to||Ie(),show_follow_up_details:p?!0:P||(e==null?void 0:e.show_follow_up_details)||!1,attachments:t.state.formData.attachments||[]}),_(!1)}else{const h=setTimeout(()=>{d({...t.state,follow_up_assigned_to:Ie()}),_(!1)},400);return()=>clearTimeout(h)}},[t.state]);const Ie=()=>{if(!(l!=null&&l.user_list)||!Array.isArray(l.user_list))return"";const o=l.user_list.find(a=>{var m;return a.role==="admin"||a.role==="superadmin"||((m=a.name)==null?void 0:m.toLowerCase())==="admin"});return o?o.id:l.user_list.length>0?l.user_list[0].id:""},we=k.useMemo(()=>({id:p||"",formTypes:(e==null?void 0:e.formTypes)||"",incident_involved:(e==null?void 0:e.incident_involved)||[],inc_invl_other_text:(e==null?void 0:e.inc_invl_other_text)||"",incident_date:(e==null?void 0:e.incident_date)||"",incident_dt:(e==null?void 0:e.incident_dt)||"",incident_tm:(e==null?void 0:e.incident_tm)||"",incident_location:(e==null?void 0:e.incident_location)||"",witnessed_by:(e==null?void 0:e.witnessed_by)||"",discovery_date:(e==null?void 0:e.discovery_date)||"",discovery_dt:(e==null?void 0:e.discovery_dt)||"",discovery_tm:(e==null?void 0:e.discovery_tm)||"",discovery_location:(e==null?void 0:e.discovery_location)||"",discovered_by:(e==null?void 0:e.discovered_by)||"",type_of_incident:(e==null?void 0:e.type_of_incident)||[],type_of_inc_other_text:(e==null?void 0:e.type_of_inc_other_text)||"",safety_fob:(e==null?void 0:e.safety_fob)??"No",safety_callbell:(e==null?void 0:e.safety_callbell)??"No",safety_caution:(e==null?void 0:e.safety_caution)??"No",safety_other:(e==null?void 0:e.safety_other)??"",other_witnesses:(e==null?void 0:e.other_witnesses)??"No",witness_name1:(e==null?void 0:e.witness_name1)||"",witness_position1:(e==null?void 0:e.witness_position1)||"",witness_name2:(e==null?void 0:e.witness_name2)||"",witness_position2:(e==null?void 0:e.witness_position2)||"",condition_at_incident:(e==null?void 0:e.condition_at_incident)||[],condition_at_inc_other_text:(e==null?void 0:e.condition_at_inc_other_text)||"",fall_assessment:(e==null?void 0:e.fall_assessment)||[],ambulation:(e==null?void 0:e.ambulation)||[],ambulation_other_text:(e==null?void 0:e.ambulation_other_text)||"",fire_alarm_pulled:(e==null?void 0:e.fire_alarm_pulled)??"No",fire_false_alarm:(e==null?void 0:e.fire_false_alarm)??"No",fire_extinguisher_used:(e==null?void 0:e.fire_extinguisher_used)??"No",fire_personal_injury:(e==null?void 0:e.fire_personal_injury)??"No",fire_property_damage:(e==null?void 0:e.fire_property_damage)??"No",factual_description:(e==null?void 0:e.factual_description)||"",informed_of_incident:(e==null?void 0:e.informed_of_incident)||[],initial_assistant_gm:(e==null?void 0:e.initial_assistant_gm)||"",initial_gm:(e==null?void 0:e.initial_gm)||"",initial_risk_mng_committee:(e==null?void 0:e.initial_risk_mng_committee)||"",initial_other:(e==null?void 0:e.initial_other)||"",informed_of_inc_other_text:e==null?void 0:e.informed_of_inc_other_text,notified_family_doctor:(e==null?void 0:e.notified_family_doctor)||"",notified_family_doctor_date:(e==null?void 0:e.notified_family_doctor_date)||"",notified_family_doctor_dt:(e==null?void 0:e.notified_family_doctor_dt)||"",notified_family_doctor_tm:(e==null?void 0:e.notified_family_doctor_tm)||"",notified_other:(e==null?void 0:e.notified_other)||"",notified_other_date:(e==null?void 0:e.notified_other_date)||"",notified_other_dt:(e==null?void 0:e.notified_other_dt)||"",notified_other_tm:(e==null?void 0:e.notified_other_tm)||"",notified_resident_responsible_party:(e==null?void 0:e.notified_resident_responsible_party)||"no",notified_resident_name:(e==null?void 0:e.notified_resident_name)||"",notified_resident_date:(e==null?void 0:e.notified_resident_date)||"",notified_resident_dt:(e==null?void 0:e.notified_resident_dt)||"",notified_resident_tm:(e==null?void 0:e.notified_resident_tm)||"",completed_by:(e==null?void 0:e.completed_by)||"",completed_position:(e==null?void 0:e.completed_position)||"",completed_date:(e==null?void 0:e.completed_date)||"",completed_dt:(e==null?void 0:e.completed_dt)||"",completed_tm:(e==null?void 0:e.completed_tm)||"",follow_up_assigned_to:(e==null?void 0:e.follow_up_assigned_to)||Ie(),followUp_issue:(e==null?void 0:e.followUp_issue)||"",followUp_findings:(e==null?void 0:e.followUp_findings)||"",followUp_possible_solutions:(e==null?void 0:e.followUp_possible_solutions)||"",followUp_action_plan:(e==null?void 0:e.followUp_action_plan)||"",followUp_examine_result:(e==null?void 0:e.followUp_examine_result)||"",attachments:(e==null?void 0:e.attachments)||[],show_follow_up_details:p?!0:(e==null?void 0:e.show_follow_up_details)||!1}),[e,p]),_e=k.useCallback(async(o,a)=>{const m=o.show_follow_up_details&&(!o.followUp_issue||!o.followUp_findings||!o.followUp_possible_solutions||!o.followUp_action_plan||!o.followUp_examine_result),h=l==null?void 0:l.role,P=h==="concierge"||h==="nurse",z=!o.show_follow_up_details;if(!P&&!z&&m){Y(o),L(a),T(!0),_(!1);return}await Me(o)},[we,s]),Me=async(o,a)=>{var st,vt,Ot,At,Yt,Dt,Nt,Rt,Ut,Bt,Lt,Wt;_(!0);const m=Ce.compact([...Ce.filter(o.incident_involved,g=>g!=="Other"),...(st=o.incident_involved)!=null&&st.includes("Other")&&o.inc_invl_other_text?[o.inc_invl_other_text]:[]]),h=Ce.compact([...Ce.filter(o.type_of_incident,g=>g!=="Other"),...(vt=o.type_of_incident)!=null&&vt.includes("Other")&&o.type_of_inc_other_text?[o.type_of_inc_other_text]:[]]),z=Ce.compact([...Ce.filter(o.condition_at_incident,g=>g!=="Other (Specify)"),...(Ot=o.condition_at_incident)!=null&&Ot.includes("Other (Specify)")&&o.condition_at_inc_other_text?[o.condition_at_inc_other_text]:[]]).join(","),f=Ce.compact([...Ce.filter(o.ambulation,g=>g!=="Other (Specify)"),...(At=o.ambulation)!=null&&At.includes("Other (Specify)")&&o.ambulation_other_text?[o.ambulation_other_text]:[]]),x=Ce.isEmpty(f)?"":f.join(","),j=Ce.compact([...Ce.filter(o.informed_of_incident,g=>g!=="Other"),...(Yt=o.informed_of_incident)!=null&&Yt.includes("Other")&&o.informed_of_inc_other_text?[o.informed_of_inc_other_text]:[]]),A=o.incident_date&&o.incident_tm?U(`${o.incident_date} ${o.incident_tm}`,"YYYY-MM-DD HH:mm"):null,E=o.discovery_date&&o.discovery_tm?U(`${o.discovery_date} ${o.discovery_tm}`,"YYYY-MM-DD hh:mm A"):null,de=o.notified_family_doctor_date&&o.notified_family_doctor_tm?U(`${o.notified_family_doctor_date} ${o.notified_family_doctor_tm}`,"YYYY-MM-DD hh:mm A"):null,n=o.notified_resident_date&&o.notified_resident_tm?U(`${o.notified_resident_date} ${o.notified_resident_tm}`,"YYYY-MM-DD hh:mm A"):null,y=o.completed_date&&o.completed_tm?U(`${o.completed_date} ${o.completed_tm}`,"YYYY-MM-DD hh:mm A"):null,S=o.notified_other_date&&o.notified_other_tm?U(`${o.notified_other_date} ${o.notified_other_tm}`,"YYYY-MM-DD hh:mm A"):null,Z={incident_involved:m.join(","),inc_invl_staff:(Dt=o.incident_involved)!=null&&Dt.includes("Staff")?1:0,inc_invl_resident:(Nt=o.incident_involved)!=null&&Nt.includes("Resident")?1:0,inc_invl_visitor:(Rt=o.incident_involved)!=null&&Rt.includes("Visitor")?1:0,inc_invl_other:(Ut=o.incident_involved)!=null&&Ut.includes("Other")?1:0,incident_date:A?U(A).format("DD MMM YYYY hh:mm A"):"",incident_dt:A?U(A).format("DD MMM YYYY"):"",incident_tm:o.incident_tm||"",incident_location:o.incident_location||"",witnessed_by:o.witnessed_by||"",discovery_date:E?U(E).format("DD MMM YYYY hh:mm A"):"",discovery_dt:E?U(E).format("DD MMM YYYY"):"",discovery_tm:o.discovery_tm||"",discovery_location:o.discovery_location||"",discovered_by:o.discovered_by||"",type_of_incident:h.join(","),...yt.reduce((g,H)=>{var se;return g[H.key]=(se=o.type_of_incident)!=null&&se.includes(H.label)?1:0,g},{}),...o.type_of_inc_other_text?{type_of_inc_other_text:o.type_of_inc_other_text}:{},...o.safety_fob?{safety_fob:o.safety_fob}:{},...o.safety_callbell?{safety_callbell:o.safety_callbell}:{},...o.safety_caution?{safety_caution:o.safety_caution}:{},...o.safety_other?{safety_other:o.safety_other}:{},other_witnesses:o.other_witnesses||"",...o.other_witnesses==="Yes"&&{...o.witness_name1?{witness_name1:o.witness_name1}:{},...o.witness_position1?{witness_position1:o.witness_position1}:{},...o.witness_name2?{witness_name2:o.witness_name2}:{},...o.witness_position2?{witness_position2:o.witness_position2}:{}},condition_at_incident:z,...gt.reduce((g,H)=>{var se;return g[H.key]=(se=o.condition_at_incident)!=null&&se.includes(H.label)?1:0,g},{}),...(Bt=o.condition_at_incident)!=null&&Bt.includes("Other (Specify)")&&o.condition_at_inc_other_text?{condition_at_inc_other_text:o.condition_at_inc_other_text}:{},fall_assessment:(o.fall_assessment||[]).join(","),...Kt.reduce((g,H)=>{var se;return g[H.key]=(se=o.fall_assessment)!=null&&se.includes(H.label)?1:0,g},{}),...x?{ambulation:x}:{},...(Lt=o.ambulation)!=null&&Lt.includes("Other (Specify)")&&o.ambulation_other_text?{ambulation_other_text:o.ambulation_other_text}:{},...wt.reduce((g,H)=>{var se;return g[H.key]=(se=o.ambulation)!=null&&se.includes(H.label)?1:0,g},{}),...o.fire_alarm_pulled?{fire_alarm_pulled:o.fire_alarm_pulled}:{},...o.fire_false_alarm?{fire_false_alarm:o.fire_false_alarm}:{},...o.fire_extinguisher_used?{fire_extinguisher_used:o.fire_extinguisher_used}:{},...o.fire_personal_injury?{fire_personal_injury:o.fire_personal_injury}:{},...o.fire_property_damage?{fire_property_damage:o.fire_property_damage}:{},factual_description:(o==null?void 0:o.factual_description)||"",informed_of_incident:j.join(","),...kt.reduce((g,H)=>{var se;return g[H.key]=(se=o.informed_of_incident)!=null&&se.includes(H.label)?1:0,g},{}),...(Wt=o.informed_of_incident)!=null&&Wt.includes("Other")&&o.informed_of_inc_other_text?{informed_of_inc_other_text:o.informed_of_inc_other_text}:{},initial_assistant_gm:(o==null?void 0:o.initial_assistant_gm)||"",initial_gm:(o==null?void 0:o.initial_gm)||"",initial_risk_mng_committee:(o==null?void 0:o.initial_risk_mng_committee)||"",initial_other:(o==null?void 0:o.initial_other)||"",notified_family_doctor:o.notified_family_doctor||"",notified_family_doctor_date:de?U(de).format("DD MMM YYYY hh:mm A"):"",notified_family_doctor_dt:de?U(de).format("DD MMM YYYY"):"",notified_family_doctor_tm:o.notified_family_doctor_tm||"",notified_other:o.notified_other||"",notified_other_date:S?U(S).format("DD MMM YYYY hh:mm A"):"",notified_other_dt:S?U(S).format("DD MMM YYYY"):"",notified_other_tm:o.notified_other_tm||"",notified_resident_responsible_party:o.notified_resident_responsible_party||"",notified_resident_name:o.notified_resident_name||"",notified_resident_date:n?U(n).format("DD MMM YYYY hh:mm A"):"",notified_resident_dt:n?U(n).format("DD MMM YYYY"):"",notified_resident_tm:o.notified_resident_tm||"",completed_by:o.completed_by||"",completed_position:o.completed_position||"",completed_date:y?U(y).format("DD MMM YYYY hh:mm A"):"",completed_dt:y?U(y).format("DD MMM YYYY"):"",completed_tm:o.completed_tm||"",follow_up_assigned_to:o.follow_up_assigned_to||"",followUp_issue:o.followUp_issue||"",followUp_findings:(o==null?void 0:o.followUp_findings)||"",followUp_possible_solutions:(o==null?void 0:o.followUp_possible_solutions)||"",followUp_action_plan:(o==null?void 0:o.followUp_action_plan)||"",followUp_examine_result:(o==null?void 0:o.followUp_examine_result)||""},je=new Date,Be=g=>g.toString().padStart(2,"0"),bt=`${je.getFullYear()}-${Be(je.getMonth()+1)}-${Be(je.getDate())} ${Be(je.getHours())}:${Be(je.getMinutes())}:${Be(je.getSeconds())}`,ye={...Z};ye.is_completed=e!=null&&e.is_completed?e==null?void 0:e.is_completed:0,ye.logged_at=e!=null&&e.logged_at?e==null?void 0:e.logged_at:bt;const He=l.rooms.find(g=>String(g.name).toLowerCase()===String(o==null?void 0:o.room_number).toLowerCase()),be=new FormData;if(be.append("form_type",1),p?be.append("form_id",p):be.append("room_id",He==null?void 0:He.id),be.append("follow_up_assigned_to",o==null?void 0:o.follow_up_assigned_to),be.append("data",JSON.stringify(ye)),Array.isArray(o.attachments)&&o.attachments.length>0){let g=0;o.attachments.forEach(H=>{if(H instanceof File)be.append(`file${g}`,H,H.name),g++;else if(H.id)be.append("existing_attachments[]",H.id);else if(typeof H=="string"&&H.startsWith("data:")){const se=atob(H.split(",")[1]),Ht=H.split(",")[0].split(":")[1].split(";")[0],$t=new ArrayBuffer(se.length),po=new Uint8Array($t);for(let rt=0;rt<se.length;rt++)po[rt]=se.charCodeAt(rt);const ho=new Blob([$t],{type:Ht}),bo=Ht.split("/")[1];be.append(`file${g}`,ho,`attachment_${Date.now()}_${g}.${bo}`),g++}})}try{if(p){const g=await Ze.logFormUpdate(be);if((g==null?void 0:g.ResponseCode)==="1")if(ke.success("Form Updated successfully."),g!=null&&g.new_form_link){$(p);const H=g.new_form_link;O((g==null?void 0:g.isFollowUpIncomplete)===1),H&&H.toLowerCase().endsWith(".pdf")?(G(H),V(!0)):window.open(H,"_blank")}else setTimeout(()=>{s("/staticForms")},1200)}else{const g=await Ze.logFormSubmit(be);if((g==null?void 0:g.ResponseCode)==="1")if(ke.success((g==null?void 0:g.ResponseText)||"Form submitted successfully."),g!=null&&g.formLink){$((g==null?void 0:g.form_id)||null);const H=g.formLink;O((g==null?void 0:g.isFollowUpIncomplete)===1),H&&H.toLowerCase().endsWith(".pdf")?(G(H),V(!0)):window.open(H,"_blank")}else setTimeout(()=>{s("/staticForms")},1200)}}catch{ke.error("Form is not submitted. Please try again.")}finally{_(!1)}},X=async()=>{T(!1),_(!0),I&&B&&await Me(I)},te=()=>{V(!1),ie&&c.current&&setTimeout(()=>{var o;(o=c.current)==null||o.scrollIntoView({behavior:"smooth",block:"start"})},300)},re=async o=>{if(!p||!o||o.length===0)return;const a=new FormData;a.append("form_id",p),o.forEach((m,h)=>{a.append(`file${h}`,m,m.name)});try{const m=await Ze.addFormAttachment(a);if((m==null?void 0:m.ResponseCode)==="1"){ke.success("Attachments uploaded successfully.");const h=m.attachments||[];d(P=>({...P,attachments:[...h]}))}else ke.error("Failed to upload attachments.")}catch(m){console.error("Error uploading attachments:",m),ke.error("Error uploading attachments. Please try again.")}finally{_(!1)}},ae=async o=>{if(!o){ke.error("Email is required.");return}try{let a={to_id:o,form_id:p};const m=await Ze.sendMail(a);(m==null?void 0:m.ResponseCode)==="1"?ke.success(`Email sent to ${o}`):m!=null&&m.Message&&ke.error(m.Message)}catch{ke.error("Failed to send email. Please try again.")}};return i.jsxs(b,{m:"20px",children:[i.jsx(wo,{title:"INCIDENT FORM",Buttons:!1}),u?i.jsx(b,{display:"flex",justifyContent:"center",alignItems:"center",height:"calc(100vh - 100px)",children:i.jsx(go,{})}):i.jsx(Mo,{onSubmit:_e,initialValues:we,enableReinitialize:!0,validationSchema:Mn,children:({values:o,errors:a,touched:m,handleBlur:h,handleChange:P,handleSubmit:z,setFieldValue:f,submitCount:x})=>{var j,A,E,de;return i.jsxs("form",{onSubmit:z,children:[i.jsx(b,{sx:{gridColumn:"span 4",mt:2},children:i.jsxs(Se,{row:!0,children:[i.jsx(b,{component:"label",sx:{mb:1,fontWeight:600,width:"100%",fontSize:"18px"},children:"INCIDENT INVOLVED"}),Gt.map(n=>{var y;return i.jsx(b,{sx:{width:"50%"},children:i.jsx(Oe,{control:i.jsx($e,{checked:((y=o.incident_involved)==null?void 0:y.includes(n.label))||!1,onChange:()=>{const S=o.incident_involved||[];S.includes(n.label)?f("incident_involved",S.filter(Z=>Z!==n.label)):f("incident_involved",[...S,n.label])},name:"incident_involved"}),label:n.label})},n.key)}),((j=o.incident_involved)==null?void 0:j.includes("Other"))&&i.jsx(b,{sx:{width:"100%",mt:1},children:i.jsx(Q,{fullWidth:!0,variant:"filled",label:"Please enter Other Incident Involved",name:"inc_invl_other_text",value:o.inc_invl_other_text||"",onChange:P,onBlur:h,error:m.inc_invl_other_text&&!!a.inc_invl_other_text,helperText:m.inc_invl_other_text&&a.inc_invl_other_text})}),m.incident_involved&&a.incident_involved&&i.jsx(b,{sx:{width:"100%",mt:1},children:i.jsx(Ke,{color:"error",variant:"body2",children:a.incident_involved})})]})}),i.jsxs(b,{sx:{gridColumn:"span 4",mt:2},children:[i.jsx(b,{component:"label",sx:{mb:1,fontWeight:600,width:"100%"},children:"Date/Time of Incident"}),i.jsx(b,{sx:{width:"100%",display:"flex",gap:2},children:i.jsxs(Ve,{dateAdapter:qe,children:[i.jsx(ze,{label:"Date",value:o.incident_date?U(o.incident_date):null,onChange:n=>{f("incident_date",n?n.format("YYYY-MM-DD"):""),n&&!o.incident_tm&&f("incident_tm","12:00")},slotProps:{textField:{fullWidth:!0,variant:"filled",error:m.incident_date&&!!a.incident_date,helperText:m.incident_date&&a.incident_date,sx:{mt:1}}}}),i.jsx(Ge,{label:"Time",ampm:!0,value:o.incident_tm?U(o.incident_tm,o.incident_tm.includes("AM")||o.incident_tm.includes("PM")?"HH:mm A":"HH:mm"):null,onChange:n=>f("incident_tm",n?n.format("HH:mm"):""),slotProps:{textField:{fullWidth:!0,variant:"filled",error:m.incident_tm&&!!a.incident_tm,helperText:m.incident_tm&&a.incident_tm,sx:{mt:1}}}})]})})]}),i.jsxs(b,{sx:{gridColumn:"span 4",mt:2,display:"flex",gap:2},children:[i.jsx(Q,{fullWidth:!0,variant:"filled",label:"Location Of Incident",name:"incident_location",value:o.incident_location||"",onChange:P,onBlur:h,error:m.incident_location&&!!a.incident_location,helperText:m.incident_location&&a.incident_location,sx:{flex:1}}),i.jsx(Q,{fullWidth:!0,variant:"filled",label:"Witnessed By",name:"witnessed_by",value:o.witnessed_by||"",onChange:P,onBlur:h,error:m.witnessed_by&&!!a.witnessed_by,helperText:m.witnessed_by&&a.witnessed_by,sx:{flex:1}})]}),i.jsxs(b,{sx:{gridColumn:"span 4",mt:2},children:[i.jsx(b,{component:"label",sx:{mb:1,fontWeight:600,width:"100%"},children:"Date/Time Of Discovery"}),i.jsx(b,{sx:{width:"100%",display:"flex",gap:2},children:i.jsxs(Ve,{dateAdapter:qe,children:[i.jsx(ze,{label:"Date",value:o.discovery_date?U(o.discovery_date):null,onChange:n=>{f("discovery_date",n?n.format("YYYY-MM-DD"):""),n&&!o.discovery_tm&&f("discovery_tm","12:00 PM")},slotProps:{textField:{fullWidth:!0,variant:"filled",error:m.discovery_date&&!!a.discovery_date,helperText:m.discovery_date&&a.discovery_date,sx:{mt:1}}}}),i.jsx(Ge,{label:"Time",ampm:!0,value:o.discovery_tm?U(o.discovery_tm,o.discovery_tm.includes("AM")||o.discovery_tm.includes("PM")?"HH:mm A":"HH:mm"):null,onChange:n=>f("discovery_tm",n?n.format("HH:mm A"):""),slotProps:{textField:{fullWidth:!0,variant:"filled",error:m.discovery_tm&&!!a.discovery_tm,helperText:m.discovery_tm&&a.discovery_tm,sx:{mt:1}}}})]})})]}),i.jsxs(b,{sx:{gridColumn:"span 4",mt:2,display:"flex",gap:2},children:[i.jsx(Q,{fullWidth:!0,variant:"filled",label:"Location Of Discovery",name:"discovery_location",value:o.discovery_location||"",onChange:P,onBlur:h,error:m.discovery_location&&!!a.discovery_location,helperText:m.discovery_location&&a.discovery_location,sx:{flex:1}}),i.jsx(Q,{fullWidth:!0,variant:"filled",label:"Discovered By",name:"discovered_by",value:o.discovered_by||"",onChange:P,onBlur:h,error:m.discovered_by&&!!a.discovered_by,helperText:m.discovered_by&&a.discovered_by,sx:{flex:1}})]}),i.jsx(b,{sx:{gridColumn:"span 4",mt:2},children:i.jsxs(Se,{row:!0,children:[i.jsx(b,{component:"label",sx:{mb:1,fontWeight:600,width:"100%"},children:"Type Of Incident"}),yt.map(n=>{var y,S;return i.jsxs(b,{sx:{width:"50%",display:"flex",alignItems:"center",justifyContent:"flex-start"},children:[i.jsx(Oe,{control:i.jsx($e,{checked:((y=o.type_of_incident)==null?void 0:y.includes(n.label))||!1,onChange:()=>{const Z=o.type_of_incident||[];Z.includes(n.label)?f("type_of_incident",Z.filter(je=>je!==n.label)):f("type_of_incident",[...Z,n.label])},name:"type_of_incident"}),label:n.label}),n.label==="Other"&&((S=o.type_of_incident)==null?void 0:S.includes("Other"))&&i.jsx(b,{sx:{ml:2},children:i.jsx(Q,{size:"small",variant:"filled",label:"Please enter Other Type Of Incident",name:"type_of_inc_other_text",value:o.type_of_inc_other_text||"",onChange:P,onBlur:h,error:m.type_of_inc_other_text&&!!a.type_of_inc_other_text,helperText:m.type_of_inc_other_text&&a.type_of_inc_other_text})}),m.type_of_incident&&a.type_of_incident&&i.jsx(b,{sx:{width:"100%",mt:1},children:i.jsx(Ke,{color:"error",variant:"body2",children:a.type_of_incident})})]},n.key)})]})}),i.jsxs(b,{sx:{gridColumn:"span 4",mt:2},children:[i.jsxs(Se,{row:!0,children:[i.jsx(b,{component:"label",sx:{mb:1,fontWeight:600,width:"100%"},children:"Safety Devices In Use Before Occurrence"}),Tn.map(n=>i.jsxs(b,{sx:{display:"flex",alignItems:"center",width:"100%",mb:1},children:[i.jsx(b,{sx:{flex:1},children:n.label}),i.jsx(b,{sx:{display:"flex",gap:2},children:["Yes","No","N/A"].map(y=>i.jsx(Oe,{control:i.jsx(at,{checked:o[n.key]===y,onChange:()=>f(n.key,y),value:y,name:n.key}),label:y},y))})]},n.key))]}),i.jsx(Q,{fullWidth:!0,variant:"filled",label:"Other",name:"safety_other",value:o.safety_other||"",onChange:P,onBlur:h,error:m.safety_other&&!!a.safety_other,helperText:m.safety_other&&a.safety_other,sx:{flex:1,gridColumn:"span 4"}})]}),i.jsx(b,{sx:{gridColumn:"span 4",mt:2},children:i.jsx(Se,{row:!0,children:[{key:"other_witnesses",label:"Other Witnesses?"}].map(n=>i.jsxs(b,{sx:{display:"flex",alignItems:"center",width:"100%",mb:1,flexDirection:"column"},children:[i.jsxs(b,{sx:{display:"flex",alignItems:"center",width:"100%"},children:[i.jsx(b,{sx:{flex:1},children:n.label}),i.jsx(b,{sx:{display:"flex",gap:2},children:["Yes","No"].map(y=>i.jsx(Oe,{control:i.jsx(at,{checked:o[n.key]===y,onChange:()=>f(n.key,y),value:y,name:n.key}),label:y},y))})]}),o[n.key]==="Yes"&&i.jsxs(i.Fragment,{children:[i.jsxs(b,{sx:{width:"100%",mt:2,display:"flex",gap:2},children:[i.jsx(Q,{fullWidth:!0,variant:"filled",label:"Witness Name 1",name:"witness_name1",value:o.witness_name1||"",onChange:P,onBlur:h,error:!!a.witness_name1&&(m.witness_name1||x>0),helperText:a.witness_name1&&(m.witness_name1||x>0)?a.witness_name1:"",sx:{flex:1}}),i.jsx(Q,{fullWidth:!0,variant:"filled",label:"Witness Position 1",name:"witness_position1",value:o.witness_position1||"",onChange:P,onBlur:h,error:!!a.witness_position1&&(m.witness_position1||x>0),helperText:a.witness_position1&&(m.witness_position1||x>0)?a.witness_position1:"",sx:{flex:1}})]}),i.jsxs(b,{sx:{width:"100%",mt:2,display:"flex",gap:2},children:[i.jsx(Q,{fullWidth:!0,variant:"filled",label:"Witness Name 2",name:"witness_name2",value:o.witness_name2||"",onChange:P,onBlur:h,sx:{flex:1}}),i.jsx(Q,{fullWidth:!0,variant:"filled",label:"Witness Position 2",name:"witness_position2",value:o.witness_position2||"",onChange:P,onBlur:h,sx:{flex:1}})]})]})]},n.key))})}),i.jsx(b,{sx:{gridColumn:"span 4",mt:2},children:i.jsxs(Se,{row:!0,children:[i.jsx(b,{component:"label",sx:{mb:1,fontWeight:600,width:"100%"},children:"Condition At Time of Incident"}),gt.map(n=>{var y;return i.jsx(b,{sx:{width:"50%",display:"flex",alignItems:"center"},children:i.jsx(Oe,{control:i.jsx($e,{checked:((y=o.condition_at_incident)==null?void 0:y.includes(n.label))||!1,onChange:()=>{const S=o.condition_at_incident||[];S.includes(n.label)?f("condition_at_incident",S.filter(Z=>Z!==n.label)):f("condition_at_incident",[...S,n.label])},name:"condition_at_incident"}),label:n.label})},n.key)}),((A=o.condition_at_incident)==null?void 0:A.includes("Other (Specify)"))&&i.jsx(b,{sx:{width:"100%",mt:2},children:i.jsx(Q,{fullWidth:!0,variant:"filled",label:"Please specify Other Condition",name:"condition_at_inc_other_text",value:o.condition_at_inc_other_text||"",onChange:P,onBlur:h,error:!!a.condition_at_inc_other_text&&(m.condition_at_inc_other_text||x>0),helperText:a.condition_at_inc_other_text&&(m.condition_at_inc_other_text||x>0)?a.condition_at_inc_other_text:""})})]})}),i.jsx(b,{sx:{gridColumn:"span 4",mt:2},children:i.jsxs(Se,{row:!0,children:[i.jsx(b,{component:"label",sx:{mb:1,fontWeight:600,width:"100%"},children:"Fall Assessment"}),Kt.map(n=>{var y;return i.jsx(b,{sx:{width:"50%"},children:i.jsx(Oe,{control:i.jsx($e,{checked:((y=o.fall_assessment)==null?void 0:y.includes(n.label))||!1,onChange:()=>{const S=o.fall_assessment||[];S.includes(n.label)?f("fall_assessment",S.filter(Z=>Z!==n.label)):f("fall_assessment",[...S,n.label])},name:"fall_assessment"}),label:n.label})},n.key)})]})}),i.jsx(b,{sx:{gridColumn:"span 4",mt:2},children:i.jsxs(Se,{row:!0,children:[i.jsx(b,{component:"label",sx:{mb:1,fontWeight:600,width:"100%"},children:"Ambulation"}),wt.map(n=>{var y;return i.jsx(b,{sx:{width:"50%",display:"flex",alignItems:"center"},children:i.jsx(Oe,{control:i.jsx($e,{checked:((y=o.ambulation)==null?void 0:y.includes(n.label))||!1,onChange:()=>{const S=o.ambulation||[];S.includes(n.label)?f("ambulation",S.filter(Z=>Z!==n.label)):f("ambulation",[...S,n.label])},name:"ambulation"}),label:n.label})},n.key)}),((E=o.ambulation)==null?void 0:E.includes("Other (Specify)"))&&i.jsx(b,{sx:{width:"100%",mt:2},children:i.jsx(Q,{fullWidth:!0,variant:"filled",label:"Please specify Other Ambulation",name:"ambulation_other_text",value:o.ambulation_other_text||"",onChange:P,onBlur:h,error:!!a.ambulation_other_text&&(m.ambulation_other_text||x>0),helperText:a.ambulation_other_text&&(m.ambulation_other_text||x>0)?a.ambulation_other_text:""})})]})}),i.jsx(b,{sx:{gridColumn:"span 4",mt:2},children:i.jsxs(Se,{row:!0,children:[i.jsx(b,{component:"label",sx:{mb:1,fontWeight:600,width:"100%"},children:"Fire"}),kn.map(n=>i.jsxs(b,{sx:{display:"flex",alignItems:"center",width:"100%",mb:1},children:[i.jsx(b,{sx:{flex:1},children:n.label}),i.jsx(b,{sx:{display:"flex",gap:2},children:["Yes","No"].map(y=>i.jsx(Oe,{control:i.jsx(at,{checked:o[n.key]===y,onChange:()=>f(n.key,y),value:y,name:n.key}),label:y},y))})]},n.key))]})}),i.jsx(b,{sx:{gridColumn:"span 4",mt:2},children:i.jsxs(Se,{row:!0,children:[i.jsx(b,{component:"label",sx:{mb:1,fontWeight:600,width:"100%"},children:"FACTUAL CONCISE DESCRIPTION OF INCIDENT, INJURY AND ACTION TAKEN"}),i.jsx(Q,{fullWidth:!0,multiline:!0,minRows:4,variant:"filled",label:"Description",name:"factual_description",value:o.factual_description||"",onChange:P,onBlur:h,error:m.factual_description&&!!a.factual_description,helperText:m.factual_description&&a.factual_description,sx:{mt:1}})]})}),i.jsx(b,{sx:{gridColumn:"span 4",mt:2},children:i.jsxs(Se,{row:!0,children:[i.jsx(b,{component:"label",sx:{mb:1,fontWeight:600,width:"100%"},children:"ATTACHMENT"}),i.jsxs(tt,{variant:"contained",component:"label",sx:{mt:1},children:["Upload Photo/Video",i.jsx("input",{type:"file",accept:"image/*,video/*",multiple:!0,hidden:!0,onChange:async n=>{const y=Array.from(n.currentTarget.files);if(p)await re(y);else{const S=o.attachments||[];f("attachments",[...y,...S])}n.target.value=""}})]}),Array.isArray(o.attachments)&&o.attachments.length>0&&i.jsx(b,{sx:{width:"100%",mt:2,display:"flex",flexWrap:"wrap",gap:2},children:o.attachments.map((n,y)=>{const S=n instanceof File,Z=S?n.type.startsWith("image/"):n.type==="image",je=S?n.type.startsWith("video/"):n.type==="video",Be=S?URL.createObjectURL(n):n.path,bt=n.name;return i.jsxs(b,{sx:{position:"relative",display:"inline-block"},children:[Z?i.jsx("img",{src:Be,alt:bt,style:{width:80,height:80,objectFit:"cover",borderRadius:4,border:"1px solid #ccc"}}):je?i.jsx("video",{src:Be,style:{width:80,height:80,objectFit:"cover",borderRadius:4,border:"1px solid #ccc"},controls:!0}):i.jsx(b,{sx:{width:80,height:80,display:"flex",alignItems:"center",justifyContent:"center",border:"1px solid #ccc",borderRadius:1,bgcolor:"#f5f5f5"},children:i.jsx(Ke,{variant:"caption",sx:{textAlign:"center",p:1},children:n.file_extension||"File"})}),i.jsx(tt,{size:"small",sx:{position:"absolute",top:0,right:0,minWidth:0,p:0,bgcolor:"rgba(255,255,255,0.7)"},onClick:async()=>{if(p&&n.id)try{const ye=await Ze.deleteFormAttachment({form_id:p,attachment_id:n.id});if((ye==null?void 0:ye.ResponseCode)==="1"){ke.success("Attachment deleted successfully.");const He=o.attachments.filter((be,st)=>st!==y);f("attachments",He),d(be=>({...be,attachments:He}))}else ke.error((ye==null?void 0:ye.ResponseText)||"Failed to delete attachment.")}catch(ye){console.error("Error deleting attachment:",ye),ke.error("Failed to delete attachment.")}finally{_(!1)}else{const ye=o.attachments.filter((He,be)=>be!==y);f("attachments",ye)}},children:i.jsx("span",{style:{color:"red",fontWeight:"bold",fontSize:18,lineHeight:1},children:""})})]},y)})})]})}),i.jsx(b,{sx:{gridColumn:"span 4",mt:2},children:i.jsx(b,{component:"label",sx:{mb:1,fontWeight:600,width:"100%",backgroundColor:"darkgray"},children:"NOTIFICATION"})}),i.jsx(b,{sx:{gridColumn:"span 4",mt:2},children:i.jsxs(Se,{row:!0,children:[i.jsxs(b,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",mb:1},children:[i.jsx(b,{component:"label",sx:{fontWeight:600},children:"Informed Of Incident"}),i.jsx(b,{component:"label",sx:{fontWeight:600,mr:2},children:"INITIAL"})]}),kt.map(n=>{var y;return i.jsx(b,{sx:{display:"flex",alignItems:"center",width:"100%",mb:1,justifyContent:"space-between",flexDirection:"row"},children:i.jsxs(b,{sx:{display:"flex",alignItems:"center",width:"100%"},children:[i.jsx($e,{checked:((y=o.informed_of_incident)==null?void 0:y.includes(n.label))||!1,onChange:()=>{const S=o.informed_of_incident||[];S.includes(n.label)?(f("informed_of_incident",S.filter(Z=>Z!==n.label)),n.label==="Other"&&f("informed_of_inc_other_text","")):f("informed_of_incident",[...S,n.label])},name:"informed_of_incident"}),i.jsx(b,{sx:{minWidth:170,mr:2},children:n.label}),i.jsx(b,{sx:{flex:1,display:"flex",justifyContent:"flex-end"},children:i.jsx(Q,{size:"small",variant:"filled",placeholder:`Enter ${n.label} Name/Details`,name:n.key==="informed_of_inc_AGM"?"initial_assistant_gm":n.key==="informed_of_inc_GM"?"initial_gm":n.key==="informed_of_inc_RMC"?"initial_risk_mng_committee":n.key==="informed_of_inc_other"?"initial_other":"",value:n.key==="informed_of_inc_AGM"?o.initial_assistant_gm||"":n.key==="informed_of_inc_GM"?o.initial_gm||"":n.key==="informed_of_inc_RMC"?o.initial_risk_mng_committee||"":n.key==="informed_of_inc_other"&&o.initial_other||"",onChange:S=>f(n.key==="informed_of_inc_AGM"?"initial_assistant_gm":n.key==="informed_of_inc_GM"?"initial_gm":n.key==="informed_of_inc_RMC"?"initial_risk_mng_committee":n.key==="informed_of_inc_other"?"initial_other":"",S.target.value),sx:{width:180}})})]})},n.key)}),((de=o.informed_of_incident)==null?void 0:de.includes("Other"))&&i.jsx(b,{sx:{width:"100%",mb:2},children:i.jsx(Q,{fullWidth:!0,size:"small",variant:"filled",placeholder:"Enter Additional Details for Other",name:"informed_of_inc_other_text",value:o.informed_of_inc_other_text||"",onChange:P,onBlur:h,error:!!a.informed_of_inc_other_text&&(m.informed_of_inc_other_text||x>0),helperText:a.informed_of_inc_other_text&&(m.informed_of_inc_other_text||x>0)?a.informed_of_inc_other_text:""})})]})}),i.jsx(b,{sx:{gridColumn:"span 4",mt:2},children:i.jsx(b,{component:"label",sx:{mb:1,fontWeight:700,width:"100%"},children:"Person Notified"})}),i.jsxs(b,{sx:{gridColumn:"span 4",mt:2},children:[i.jsx(b,{component:"label",sx:{mb:1,fontWeight:600,width:"100%"},children:"Family Doctor"}),i.jsx(Q,{fullWidth:!0,variant:"filled",label:"Family Doctor",name:"notified_family_doctor",value:o.notified_family_doctor||"",onChange:P,onBlur:h,sx:{mb:2}}),i.jsx(b,{component:"label",sx:{mb:1,fontWeight:600,width:"100%"},children:"Date/Time"}),i.jsx(b,{sx:{display:"flex",gap:2,mb:2},children:i.jsxs(Ve,{dateAdapter:qe,children:[i.jsx(ze,{label:"Date",value:o.notified_family_doctor_date?U(o.notified_family_doctor_date):null,onChange:n=>{f("notified_family_doctor_date",n?n.format("YYYY-MM-DD"):""),n&&!o.notified_family_doctor_tm&&f("notified_family_doctor_tm","12:00 PM")},slotProps:{textField:{fullWidth:!0,variant:"filled",error:m.notified_family_doctor_date&&!!a.notified_family_doctor_date,helperText:m.notified_family_doctor_date&&a.notified_family_doctor_date}}}),i.jsx(Ge,{label:"Time",ampm:!0,value:o.notified_family_doctor_tm?U(o.notified_family_doctor_tm,o.notified_family_doctor_tm.includes("AM")||o.notified_family_doctor_tm.includes("PM")?"HH:mm A":"HH:mm"):null,onChange:n=>f("notified_family_doctor_tm",n?n.format("HH:mm A"):""),slotProps:{textField:{fullWidth:!0,variant:"filled",error:m.notified_family_doctor_tm&&!!a.notified_family_doctor_tm,helperText:m.notified_family_doctor_tm&&a.notified_family_doctor_tm}}})]})}),i.jsx(b,{component:"label",sx:{mb:1,fontWeight:600,width:"100%"},children:"Other"}),i.jsx(Q,{fullWidth:!0,variant:"filled",label:"Other",name:"notified_other",value:o.notified_other||"",onChange:P,onBlur:h,sx:{mb:2}}),i.jsx(b,{sx:{display:"flex",gap:2,mb:2},children:i.jsxs(Ve,{dateAdapter:qe,children:[i.jsx(ze,{label:"Date",value:o.notified_other_date?U(o.notified_other_date):null,onChange:n=>{f("notified_other_date",n?n.format("YYYY-MM-DD"):""),n&&!o.notified_other_tm&&f("notified_other_tm","12:00 PM")},slotProps:{textField:{fullWidth:!0,variant:"filled",error:!!a.notified_other_date&&(m.notified_other_date||x>0),helperText:a.notified_other_date&&(m.notified_other_date||x>0)?a.notified_other_date:""}}}),i.jsx(Ge,{label:"Time",ampm:!0,value:o.notified_other_tm?U(o.notified_other_tm,o.notified_other_tm.includes("AM")||o.notified_other_tm.includes("PM")?"HH:mm A":"HH:mm"):null,onChange:n=>f("notified_other_tm",n?n.format("HH:mm A"):""),slotProps:{textField:{fullWidth:!0,variant:"filled",error:!!a.notified_other_tm&&(m.notified_other_tm||x>0),helperText:a.notified_other_tm&&(m.notified_other_tm||x>0)?a.notified_other_tm:""}}})]})}),i.jsx(b,{component:"label",sx:{mb:1,fontWeight:600,width:"100%"},children:"Notified Resident's Responsible Party"}),i.jsx(Se,{row:!0,children:Cn.map(n=>i.jsx(Oe,{control:i.jsx(at,{checked:String(o.notified_resident_responsible_party).toLowerCase()===n.key.toLowerCase(),onChange:()=>{f("notified_resident_responsible_party",n.key),f("notified_resident_name",""),f("notified_resident_date",""),f("notified_resident_tm","")},value:n.key,name:"notified_resident_responsible_party"}),label:n.label},n.key))}),o.notified_resident_responsible_party==="Yes"&&i.jsxs(b,{sx:{width:"100%",mt:2,display:"flex",gap:2},children:[i.jsx(Q,{fullWidth:!0,variant:"filled",label:"Notified Resident Name",name:"notified_resident_name",value:o.notified_resident_name||"",onChange:P,onBlur:h,error:!!a.notified_resident_name&&(m.notified_resident_name||x>0),helperText:a.notified_resident_name&&(m.notified_resident_name||x>0)?a.notified_resident_name:"",sx:{mb:2}}),i.jsxs(Ve,{dateAdapter:qe,children:[i.jsx(ze,{label:"Date",value:o.notified_resident_date?U(o.notified_resident_date):null,onChange:n=>{f("notified_resident_date",n?n.format("YYYY-MM-DD"):""),n&&!o.notified_resident_tm&&f("notified_resident_tm","12:00 PM")},slotProps:{textField:{fullWidth:!0,variant:"filled",error:!!a.notified_resident_date&&(m.notified_resident_date||x>0),helperText:a.notified_resident_date&&(m.notified_resident_date||x>0)?a.notified_resident_date:""}}}),i.jsx(Ge,{label:"Time",ampm:!0,value:o.notified_resident_tm?U(o.notified_resident_tm,o.notified_resident_tm.includes("AM")||o.notified_resident_tm.includes("PM")?"HH:mm A":"HH:mm"):null,onChange:n=>f("notified_resident_tm",n?n.format("HH:mm A"):""),slotProps:{textField:{fullWidth:!0,variant:"filled",error:!!a.notified_resident_tm&&(m.notified_resident_tm||x>0),helperText:a.notified_resident_tm&&(m.notified_resident_tm||x>0)?a.notified_resident_tm:""}}})]})]}),i.jsx(b,{component:"label",sx:{mb:1,fontWeight:600,width:"100%"},children:"Completed By"}),i.jsx(Q,{fullWidth:!0,variant:"filled",label:"Completed By",name:"completed_by",value:o.completed_by||"",onChange:P,onBlur:h,sx:{mb:2},error:!!a.completed_by&&(m.completed_by||x>0),helperText:a.completed_by&&(m.completed_by||x>0)?a.completed_by:""}),i.jsx(b,{component:"label",sx:{mb:1,fontWeight:600,width:"100%"},children:"Position"}),i.jsx(Q,{fullWidth:!0,variant:"filled",label:"Position",name:"completed_position",value:o.completed_position||"",onChange:P,onBlur:h,error:!!a.completed_position&&(m.completed_position||x>0),helperText:a.completed_position&&(m.completed_position||x>0)?a.completed_position:"",sx:{mb:2}}),i.jsx(b,{component:"label",sx:{mb:1,fontWeight:600,width:"100%"},children:"Date/Time Completed"}),i.jsx(b,{sx:{display:"flex",gap:2,mb:2},children:i.jsxs(Ve,{dateAdapter:qe,children:[i.jsx(ze,{label:"Date",value:o.completed_date?U(o.completed_date):null,onChange:n=>{f("completed_date",n?n.format("YYYY-MM-DD"):""),n&&!o.completed_tm&&f("completed_tm","12:00 PM")},slotProps:{textField:{fullWidth:!0,variant:"filled",error:m.completed_date&&!!a.completed_date,helperText:m.completed_date&&a.completed_date}}}),i.jsx(Ge,{label:"Time",ampm:!0,value:o.completed_tm?U(o.completed_tm,o.completed_tm.includes("AM")||o.completed_tm.includes("PM")?"HH:mm A":"HH:mm"):null,onChange:n=>f("completed_tm",n?n.format("HH:mm A"):""),slotProps:{textField:{fullWidth:!0,variant:"filled",error:m.completed_tm&&!!a.completed_tm,helperText:m.completed_tm&&a.completed_tm}}})]})}),i.jsx(b,{component:"label",sx:{mb:1,fontWeight:600,width:"100%"},children:"Assign Follow Up to"}),i.jsxs(Q,{select:!0,fullWidth:!0,variant:"filled",label:"Assign Follow Up to",name:"follow_up_assigned_to",value:o.follow_up_assigned_to||"",onChange:n=>{P(n);const y=n.target.value,S=l==null?void 0:l.role,Z=l==null?void 0:l.user_id;S==="admin"||S==="superadmin"||String(Z)===String(y)?w(!0):(w(!1),f("followUp_issue",""),f("followUp_findings",""),f("followUp_possible_solutions",""),f("followUp_action_plan",""),f("followUp_examine_result",""))},onBlur:h,sx:{mb:2},error:m.follow_up_assigned_to&&!!a.follow_up_assigned_to,helperText:m.follow_up_assigned_to&&a.follow_up_assigned_to,SelectProps:{MenuProps:{PaperProps:{style:{maxHeight:200}}},renderValue:n=>{var S;if(!n)return"Select";const y=(S=l==null?void 0:l.user_list)==null?void 0:S.find(Z=>Z.id===n);return y?y.name:n}},children:[i.jsx(dt,{value:"",children:"Select"}),Array.isArray(l==null?void 0:l.user_list)&&l.user_list.map(n=>i.jsx(dt,{value:n.id,children:n.name},n.id))]})]}),i.jsxs(b,{sx:{gridColumn:"span 4",mt:2},ref:c,children:[i.jsx(Oe,{control:i.jsx($e,{checked:o.show_follow_up_details||!1,onChange:n=>f("show_follow_up_details",n.target.checked),name:"show_follow_up_details"}),label:"Show Follow Up Details"}),o.show_follow_up_details&&i.jsxs(i.Fragment,{children:[i.jsx(b,{sx:{mb:2,backgroundColor:"#e0e0e0",borderRadius:1,py:1},children:i.jsx(Ke,{variant:"h6",align:"center",sx:{fontWeight:700,color:"#333"},children:"FOLLOW UP"})}),i.jsx(Q,{fullWidth:!0,multiline:!0,minRows:3,variant:"filled",label:"ISSUE (Problem)",name:"followUp_issue",value:o.followUp_issue||"",onChange:P,onBlur:h,sx:{mb:2},disabled:!v&&(p?!K:!R)}),i.jsx(Q,{fullWidth:!0,multiline:!0,minRows:3,variant:"filled",label:"FINDINGS (Gather Information)",name:"followUp_findings",value:o.followUp_findings||"",onChange:P,onBlur:h,sx:{mb:2},disabled:!v&&(p?!K:!R)}),i.jsx(Q,{fullWidth:!0,multiline:!0,minRows:3,variant:"filled",label:"POSSIBLE SOLUTIONS (Identify Solution)",name:"followUp_possible_solutions",value:o.followUp_possible_solutions||"",onChange:P,onBlur:h,sx:{mb:2},disabled:!v&&(p?!K:!R)}),i.jsx(Q,{fullWidth:!0,multiline:!0,minRows:3,variant:"filled",label:"ACTION PLAN",name:"followUp_action_plan",value:o.followUp_action_plan||"",onChange:P,onBlur:h,sx:{mb:2},disabled:!v&&(p?!K:!R)}),i.jsx(Q,{fullWidth:!0,multiline:!0,minRows:3,variant:"filled",label:"FOLLOW UP (Examine Result - Did the Plan work?)",name:"followUp_examine_result",value:o.followUp_examine_result||"",onChange:P,onBlur:h,sx:{mb:2},disabled:!v&&(p?!K:!R)})]})]}),i.jsx(b,{display:"flex",alignItems:"center",justifyContent:"center",mt:"20px",children:i.jsx(So,{type:"submit",disabled:u,sx:{width:"200px",bgcolor:"#1976d2",color:"#fcfcfc",fontSize:"16px",fontWeight:"bold",p:"10px 20px",mt:"18px",transition:".3s ease",":hover":{bgcolor:"#115293"}},children:u?"Loading...":"Submit"})}),i.jsxs(Ko,{open:D,onClose:()=>T(!1),children:[i.jsx(Xo,{children:"Incomplete Follow Up"}),i.jsx(Qo,{children:"Follow Up form is not completely filled. Do you still want to submit it?"}),i.jsxs(Jo,{children:[i.jsx(tt,{onClick:()=>T(!1),color:"primary",children:"Cancel"}),i.jsx(tt,{onClick:X,color:"primary",autoFocus:!0,children:"Yes, Submit"})]})]})]})}}),i.jsx(ko,{open:q,onClose:()=>V(!1),onCloseComplete:()=>{V(!1),s("/staticForms")},pdfUrl:J,onMail:ae,showPrintButton:((ue=(me=l==null?void 0:l.form_types)==null?void 0:me.find(o=>o.id===1))==null?void 0:ue.allow_print)===1,showMailButton:((he=(pe=l==null?void 0:l.form_types)==null?void 0:pe.find(o=>o.id===1))==null?void 0:he.allow_mail)===1,showFollowUpButton:ne,onFollowUp:te,onPrint:()=>window.open(J,"_blank")})]})};export{En as default};
