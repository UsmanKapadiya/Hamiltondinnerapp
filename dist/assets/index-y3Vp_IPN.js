import{c as D,j as o,u as F,r as c,a as M,B as d,T as O}from"./index-D1onh7K2.js";import{t as P,u as V,y as x,L as q,C as X}from"./js.cookie-gOnXwpkR.js";import{l as $}from"./logo-06Lthgp1.js";import{r as H}from"./api-BXAxpoKY.js";import{u as J}from"./useApi-CYutvhn-.js";import"./lodash-CegKfhPD.js";import{s as Q,v as U}from"./validation-iZGRBJZE.js";import{T as v}from"./TextField-BRu8PxbS.js";const Y=D(o.jsx("path",{d:"M11 7 9.6 8.4l2.6 2.6H2v2h10.2l-2.6 2.6L11 17l5-5zm9 12h-8v2h8c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-8v2h8z"}),"LoginOutlined"),G={login:async({roomNo:u,password:s})=>{if(!u||!s)throw new Error("Room number and password are required");return H.post(`/login?room_no=${u}&password=${s}`)}},ie=()=>{const u=F(),s=P(u.palette.mode);V("(min-width: 724px)");const[r,y]=c.useState({roomNo:"",password:""}),[i,h]=c.useState({}),p=M(),{execute:f,loading:m}=J(({roomNo:e,password:t})=>G.login({roomNo:e,password:t}),{onSuccess:e=>{e.ResponseCode==="1"?j(e):x.error(e.ResponseText||"Login failed. Please try again.")},onError:e=>{var a,l,n,g;const t=((l=(a=e.response)==null?void 0:a.data)==null?void 0:l.error)||((g=(n=e.response)==null?void 0:n.data)==null?void 0:g.ResponseText)||"An unexpected error occurred. Please try again.";x.error(t)}}),j=c.useCallback(e=>{const{authentication_token:t,role:a,user_id:l,show_dining:n,show_incident:g,language:w,guideline:C,guideline_cn:L,room_id:S,rooms:T,form_types:k,user_list:N,breakfast_guideline:A,breakfast_guideline_cn:R,lunch_guideline:I,lunch_guideline_cn:z,dinner_guideline:E,dinner_guideline_cn:W}=e,B={role:a,user_id:l,show_dining:n,show_incident:g,language:w,langCode:w===1?"cn":"en",guideline:C,guideline_cn:L,room_id:S,rooms:T,form_types:k,user_list:N,breakfast_guideline:A,breakfast_guideline_cn:R,lunch_guideline:I,lunch_guideline_cn:z,dinner_guideline:E,dinner_guideline_cn:W};localStorage.setItem("authToken",t),localStorage.setItem("userData",JSON.stringify(B)),x.success(e.ResponseText||"Successfully Login"),setTimeout(()=>{a==="user"?p("/order",{state:{roomNo:r==null?void 0:r.roomNo}}):p("/home")},1e3)},[p,r.roomNo]),b=c.useCallback(e=>{const{name:t,value:a}=e.target,l=Q(a);y(n=>({...n,[t]:l})),i[t]&&h(n=>({...n,[t]:""}))},[i]),_=c.useCallback(async e=>{e.preventDefault();const t=U(r);if(!t.isValid){h(t.errors);return}h({}),await f(r)},[r,f]);return o.jsxs(d,{display:"flex",height:"100vh",width:"100%",sx:{overflowX:"hidden",overflowY:"auto"},children:[o.jsx(q,{}),o.jsx(d,{flex:7,sx:{backgroundColor:s.blueAccent[700],height:"100vh",width:"100%",overflowX:"hidden"}}),o.jsx(d,{flex:5,display:"flex",alignItems:"center",justifyContent:"center",sx:{backgroundColor:"white",height:"100vh",width:"100%"},children:o.jsxs(d,{component:"form",onSubmit:_,sx:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",width:"100%",maxWidth:"400px",padding:"20px",margin:"0 auto"},children:[o.jsx("img",{src:$,alt:"Logo",style:{width:80,marginBottom:16}}),o.jsxs(O,{variant:"h6",gutterBottom:!0,sx:{textAlign:"center",textTransform:"uppercase",fontWeight:700},children:["Welcome to our ",o.jsx("br",{})," Exceptional ",o.jsx("br",{}),"Senior Living"]}),o.jsx(v,{label:"Room No",name:"roomNo",type:"text",value:r.roomNo,onChange:b,error:!!i.roomNo,helperText:i.roomNo,fullWidth:!0,margin:"normal",autoComplete:"username",disabled:m}),o.jsx(v,{label:"Password",name:"password",type:"password",value:r.password,onChange:b,error:!!i.password,helperText:i.password,fullWidth:!0,margin:"normal",autoComplete:"current-password",disabled:m}),o.jsx(d,{children:o.jsx(X,{type:"submit",disabled:m,startIcon:o.jsx(Y,{}),sx:{bgcolor:s.blueAccent[50],color:s.blueAccent[700],"&:hover":{bgcolor:s.blueAccent[100],color:s.blueAccent[800]},padding:"10px 32px",boxShadow:"none",borderRadius:"30px",border:"none",borderRadius:4,fontWeight:600,fontSize:16,cursor:"pointer",width:"auto"},children:m?"Loading...":"Login"})})]})})]})};export{ie as default};
