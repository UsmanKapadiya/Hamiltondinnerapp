import{a as F,u as N,r as i,j as e,B as u,T as k,C as V}from"./index-Ic96-0uI.js";import{H as _,M as E,O}from"./Header-Czk5TdvV.js";import{t as K}from"./js.cookie-BDhdAvxg.js";import{d as s,L as U,A as X,D as S}from"./AdapterDayjs-4xP3l0wz.js";import{T as $,M as q,P as J}from"./TextField-DUcxEuMZ.js";import{M as Q}from"./Tooltip-07zIwyAt.js";import{I as Z}from"./IconButton-6QtCe6bx.js";import{S as ee,T as re,a as te,b as oe,c as x,d as ae}from"./SummarizeOutlined-CXAWghzY.js";import{T as p}from"./TableCell-DBnvbcrT.js";import"./api-DtAOtWGO.js";import"./InputAdornment-QPfNViMu.js";const be=()=>{var v,M,R;const Y=F(),B=N(),o=K(B.palette.mode),[b,I]=i.useState(s()),[l,W]=i.useState(s().startOf("month")),[c,L]=i.useState(s()),[G,m]=i.useState(!1),[t,g]=i.useState({}),[f,y]=i.useState([]),[d,D]=i.useState("Single Date Record"),[A,C]=i.useState(null);i.useEffect(()=>{d==="Single Date Record"&&(async()=>{var n;try{m(!0);const a=await O.getReportList(b.format("YYYY-MM-DD")),h=Object.values(((n=a==null?void 0:a.result)==null?void 0:n.rows)||{});y(h),g(a)}catch(a){console.error("Error fetching menu list:",a)}finally{m(!1)}})()},[b,d]),i.useEffect(()=>{if(d==="Multiple Date Record"&&l&&c&&s(l).isValid()&&s(c).isValid()){if(s(c).isBefore(s(l),"day")){console.error("End date cannot be before start date"),y([]),g({});return}(async()=>{var n;try{m(!0);const a=await O.getMultipleDateReportList(s(l).format("YYYY-MM-DD"),s(c).format("YYYY-MM-DD")),h=Object.values(((n=a==null?void 0:a.result)==null?void 0:n.rows)||{});y(h),g(a)}catch(a){console.error("Error fetching menu list:",a)}finally{m(!1)}})()}},[l,c,d]);const P=r=>{C(r.currentTarget)},j=()=>C(null),w=r=>Array.isArray(t==null?void 0:t.columns)&&Array.isArray(t.columns[r])?t.columns[r]:[],z=()=>!f||f.length===0;return e.jsxs(u,{m:"20px",children:[e.jsx(_,{title:"Report",profileScreen:!0}),e.jsxs(u,{mt:"40px",height:"75vh",flex:1,sx:{"& .MuiDataGrid-root":{border:"none"},"& .MuiDataGrid-cell":{border:"none"},"& .name-column--cell":{color:o.greenAccent[300]},"& .MuiDataGrid-columnHeaders":{backgroundColor:o.blueAccent[700],borderBottom:"none"},"& .MuiDataGrid-virtualScroller":{backgroundColor:o.primary[400]},"& .MuiDataGrid-footerContainer":{borderTop:"none",backgroundColor:o.blueAccent[700]},"& .MuiCheckbox-root":{color:`${o.greenAccent[200]} !important`},"& .MuiDataGrid-iconSeparator":{color:o.primary[100]}},children:[e.jsxs(u,{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2,children:[e.jsx(U,{dateAdapter:X,children:d==="Multiple Date Record"?e.jsxs(u,{display:"flex",gap:2,children:[e.jsx(S,{label:"Start Date",value:l,onChange:r=>W(r),maxDate:c,slotProps:{textField:{fullWidth:!0,variant:"filled",error:c&&l&&s(l).isAfter(s(c),"day"),helperText:c&&l&&s(l).isAfter(s(c),"day")?"Start date cannot be after end date":""}}}),e.jsx(S,{label:"End Date",value:c,onChange:r=>L(r),minDate:l,slotProps:{textField:{fullWidth:!0,variant:"filled",error:c&&l&&s(c).isBefore(s(l),"day"),helperText:c&&l&&s(c).isBefore(s(l),"day")?"End date cannot be before start date":""}}})]}):e.jsx(S,{label:"Date",value:b,onChange:r=>I(r),renderInput:r=>e.jsx($,{...r,variant:"filled",sx:{minWidth:200}})})}),e.jsxs(u,{display:"flex",alignItems:"center",gap:2,children:[e.jsx(Q,{title:"Reports",arrow:!0,children:e.jsx(Z,{onClick:P,sx:{color:o.blueAccent[700],"&:hover":{backgroundColor:o.blueAccent[800],color:o.gray[100]}},children:e.jsx(ee,{sx:{fontSize:"28px"}})})}),e.jsxs(q,{anchorEl:A,open:!!A,onClose:j,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},disableScrollLock:!0,children:[e.jsx(E,{selected:d==="Single Date Record",onClick:()=>{D("Single Date Record"),j()},children:"Single Date Record"}),e.jsx(E,{selected:d==="Multiple Date Record",onClick:()=>{D("Multiple Date Record"),j()},children:"Multiple Date Record"})]}),e.jsx(k,{variant:"subtitle1",sx:{fontWeight:600,cursor:"pointer",color:o.blueAccent[700],"&:hover":{color:o.blueAccent[500]}},onClick:()=>Y("/charges"),children:"Charges"})]})]}),G?e.jsx(V,{}):z()?e.jsx(u,{display:"flex",justifyContent:"center",alignItems:"center",height:"50vh",children:e.jsx(k,{variant:"h5",sx:{fontWeight:600,color:o.gray[100]},children:"No Data Available for the selected date."})}):e.jsx(u,{sx:{overflowX:"auto",width:"100%"},children:e.jsx(re,{component:J,children:e.jsxs(te,{sx:{border:"1px solid rgba(224, 224, 224, 1)",borderCollapse:"collapse",minWidth:650},children:[e.jsxs(oe,{children:[e.jsx(x,{sx:{backgroundColor:o.blueAccent[700]},children:w(0).map((r,n)=>e.jsx(p,{align:"center",sx:{border:"1px solid rgba(224, 224, 224, 1)",whiteSpace:"nowrap"},...n===0?{rowSpan:r==null?void 0:r.rowspan}:{colSpan:r==null?void 0:r.colspan},children:r==null?void 0:r.title},n))}),e.jsx(x,{sx:{backgroundColor:o.blueAccent[700]},children:w(((v=t==null?void 0:t.columns)==null?void 0:v.length)-2).map((r,n)=>e.jsx(p,{align:"center",sx:{border:"1px solid rgba(224, 224, 224, 1)",whiteSpace:"nowrap"},children:r.title},n))}),e.jsx(x,{sx:{backgroundColor:o.blueAccent[700]},children:(M=t==null?void 0:t.columns)!=null&&M[1]&&typeof t.columns[1]=="object"&&!Array.isArray(t.columns[1])?Object.keys(t.columns[1]).map((r,n)=>e.jsx(p,{align:"center",sx:{border:"1px solid rgba(224, 224, 224, 1)",whiteSpace:"nowrap"},children:r},n)):null}),e.jsxs(x,{children:[e.jsx(p,{align:"center",sx:{border:"1px solid rgba(224, 224, 224, 1)",fontWeight:"bold",backgroundColor:o.primary[400],whiteSpace:"nowrap"}}),(R=t==null?void 0:t.columns)!=null&&R[1]&&typeof t.columns[1]=="object"&&!Array.isArray(t.columns[1])?Object.keys(t.columns[1]).map((r,n)=>{var a;return e.jsx(p,{align:"center",sx:{border:"1px solid rgba(224, 224, 224, 1)",fontWeight:"bold",backgroundColor:o.primary[400],color:o.redAccent[800],whiteSpace:"nowrap"},children:((a=t==null?void 0:t.total)==null?void 0:a[r])!==void 0?t.total[r]:""},n)}):null]})]}),e.jsx(ae,{children:f.map((r,n)=>{var h;const a=(h=t==null?void 0:t.columns)!=null&&h[1]&&typeof t.columns[1]=="object"&&!Array.isArray(t.columns[1])?Object.keys(t.columns[1]):[];return e.jsxs(x,{children:[e.jsx(p,{align:"center",sx:{border:"1px solid rgba(224, 224, 224, 1)",whiteSpace:"nowrap"},children:r.room_name||r.room_id}),a.map((T,H)=>e.jsx(p,{align:"center",sx:{border:"1px solid rgba(224, 224, 224, 1)",whiteSpace:"nowrap"},children:r[T]!==void 0?r[T]:""},H))]},n)})})]})})})]})]})};export{be as default};
