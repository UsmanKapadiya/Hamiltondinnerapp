import{c as Re,j as r,u as Me,r as l,B as D,C as ke,R as Ae,T as Te}from"./index-Bm_5TwK8.js";import{t as ve,C as $e}from"./js.cookie-BMVg8mSx.js";import{H as Ee,M as le,O as ie}from"./Header-kLxfx-wC.js";import{d as f,L as Le,A as we,D as E}from"./AdapterDayjs-C03wpHAo.js";import{T as L,M as Ne,P as ze,c as Oe}from"./TextField-BMq22fW-.js";import{M as A}from"./Tooltip-BA34uk2i.js";import{I as Ye}from"./IconButton-DaDVY_yq.js";import{T as Ie,a as Pe,b as Be,c as T,d as We}from"./TableRow-C-Az9qo6.js";import{T as d}from"./TableCell-fnPduUB1.js";import"./api-BMsB3PGI.js";import"./InputAdornment-DfCoPRo0.js";const Fe=Re(r.jsx("path",{d:"M15 3H5c-1.1 0-1.99.9-1.99 2L3 19c0 1.1.89 2 1.99 2H19c1.1 0 2-.9 2-2V9zM5 19V5h9v5h5v9zM9 8c0 .55-.45 1-1 1s-1-.45-1-1 .45-1 1-1 1 .45 1 1m0 4c0 .55-.45 1-1 1s-1-.45-1-1 .45-1 1-1 1 .45 1 1m0 4c0 .55-.45 1-1 1s-1-.45-1-1 .45-1 1-1 1 .45 1 1"}),"SummarizeOutlined"),or=()=>{var I,P,B,W,F,H,q,G,U;const ce=Me(),s=ve(ce.palette.mode),[w,N]=l.useState(null),[g,de]=l.useState(f().startOf("month")),[b,me]=l.useState(f()),[C,pe]=l.useState(f()),[ue,R]=l.useState(!1),[e,z]=l.useState({}),[He,he]=l.useState(!0),[qe,fe]=l.useState(null),[u,O]=l.useState("Single Date Record"),[j,v]=l.useState({open:!1,anchorEl:null,text:""});l.useEffect(()=>{u==="Single Date Record"&&(async()=>{try{R(!0);const o=await ie.getCharges(C.format("YYYY-MM-DD"));z(o)}catch(o){console.error("Error fetching menu list:",o)}finally{R(!1)}})()},[C,u]),l.useEffect(()=>{u==="Multiple Date Record"&&g&&b&&f(g).isValid()&&f(b).isValid()&&(async()=>{try{R(!0);const o=await ie.getMultipleDateChargesReportList(f(g).format("YYYY-MM-DD"),f(b).format("YYYY-MM-DD"));z(o)}catch(o){console.error("Error fetching menu list:",o)}finally{R(!1)}})()},[g,b,u]);const xe=t=>{t&&!t.isSame(C,"day")&&pe(t),he(!1)},_e=t=>{N(t.currentTarget)},ge=()=>{N(null)},Y=()=>fe(null);return r.jsxs(D,{m:"20px",children:[r.jsx(Ee,{title:"Charges Report",profileScreen:!0}),r.jsxs(D,{mt:"40px",height:"75vh",flex:1,sx:{"& .MuiDataGrid-root":{border:"none"},"& .MuiDataGrid-cell":{border:"none"},"& .name-column--cell":{color:s.greenAccent[300]},"& .MuiDataGrid-columnHeaders":{backgroundColor:s.blueAccent[700],borderBottom:"none"},"& .MuiDataGrid-virtualScroller":{backgroundColor:s.primary[400]},"& .MuiDataGrid-footerContainer":{borderTop:"none",backgroundColor:s.blueAccent[700]},"& .MuiCheckbox-root":{color:`${s.greenAccent[200]} !important`},"& .MuiDataGrid-iconSeparator":{color:s.primary[100]}},children:[r.jsxs(D,{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2,children:[r.jsx(Le,{dateAdapter:we,children:u==="Multiple Date Record"?r.jsxs(D,{display:"flex",gap:2,children:[r.jsx(E,{label:"Start Date",value:g,onChange:t=>de(t),renderInput:t=>r.jsx(L,{...t,fullWidth:!0,variant:"filled",sx:{gridColumn:"span 1"}})}),r.jsx(E,{label:"End Date",value:b,onChange:t=>me(t),renderInput:t=>r.jsx(L,{...t,fullWidth:!0,variant:"filled",sx:{gridColumn:"span 1"}})})]}):r.jsx(E,{label:"Date",value:C,onChange:xe,renderInput:t=>r.jsx(L,{...t,fullWidth:!0,variant:"filled",sx:{gridColumn:"span 1"}})})}),r.jsx(A,{title:"Reports",arrow:!0,children:r.jsx(Ye,{onClick:_e,sx:{color:s.blueAccent[700],"&:hover":{backgroundColor:s.blueAccent[800],color:s.gray[100]}},children:r.jsx(Fe,{sx:{fontSize:"28px"}})})}),r.jsxs(Ne,{anchorEl:w,open:!!w,onClose:ge,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},disableScrollLock:!0,children:[r.jsx(le,{selected:u==="Single Date Record",onClick:()=>{O("Single Date Record"),Y()},children:"Single Date Record"}),r.jsx(le,{selected:u==="Multiple Date Record",onClick:()=>{O("Multiple Date Record"),Y()},children:"Multiple Date Record"})]})]}),ue?r.jsx(ke,{}):r.jsx(Ie,{component:ze,children:r.jsxs(Pe,{sx:{border:"1px solid rgba(224, 224, 224, 1)",borderCollapse:"collapse"},children:[r.jsxs(Be,{children:[r.jsxs(T,{sx:{backgroundColor:s.blueAccent[700]},children:[r.jsx(d,{align:"center",sx:{border:"1px solid rgba(224, 224, 224, 1)"},rowSpan:2,children:"#"}),r.jsx(d,{align:"center",sx:{border:"1px solid rgba(224, 224, 224, 1)"},colSpan:((I=e==null?void 0:e.breakfast_item_list)==null?void 0:I.length)||0,children:"Breakfast"}),r.jsx(d,{align:"center",sx:{border:"1px solid rgba(224, 224, 224, 1)"},colSpan:((P=e==null?void 0:e.lunch_item_list)==null?void 0:P.length)||0,children:"Lunch"}),r.jsx(d,{align:"center",sx:{border:"1px solid rgba(224, 224, 224, 1)"},colSpan:((B=e==null?void 0:e.dinner_item_list)==null?void 0:B.length)||0,children:"Dinner"})]}),r.jsxs(T,{sx:{backgroundColor:s.blueAccent[700]},children:[(W=e==null?void 0:e.breakfast_item_list)==null?void 0:W.map((t,o)=>{const x=()=>{if(t.real_item_name)return t.real_item_name;if(t.data){if(Array.isArray(t.data))return t.data.map(i=>`${i.date}: ${i.real_item_name}`).join(`
`);if(t.data.real_item_name)return t.data.real_item_name}return t.item_name};return r.jsx(d,{align:"center",sx:{border:"1px solid rgba(224, 224, 224, 1)"},children:r.jsx(A,{title:x(),arrow:!0,children:r.jsx("span",{children:t.item_name})})},`breakfast-${o}`)}),(F=e==null?void 0:e.lunch_item_list)==null?void 0:F.map((t,o)=>{const x=()=>{if(t.real_item_name)return t.real_item_name;if(t.data){if(Array.isArray(t.data))return t.data.map(i=>`${i.date}: ${i.real_item_name}`).join(`
`);if(t.data.real_item_name)return t.data.real_item_name}return t.item_name};return r.jsx(d,{align:"center",sx:{border:"1px solid rgba(224, 224, 224, 1)"},children:r.jsx(A,{title:x(),arrow:!0,children:r.jsx("span",{children:t.item_name})})},`lunch-${o}`)}),(H=e==null?void 0:e.dinner_item_list)==null?void 0:H.map((t,o)=>{const x=()=>{if(t.real_item_name)return t.real_item_name;if(t.data){if(Array.isArray(t.data))return t.data.map(i=>`${i.date}: ${i.real_item_name}`).join(`
`);if(t.data.real_item_name)return t.data.real_item_name}return t.item_name};return r.jsx(d,{align:"center",sx:{border:"1px solid rgba(224, 224, 224, 1)"},children:r.jsx(A,{title:x(),arrow:!0,children:r.jsx("span",{children:t.item_name})})},`dinner-${o}`)})]})]}),r.jsx(We,{children:(!(e!=null&&e.report_breakfast_list)||e.report_breakfast_list.length===0)&&(!(e!=null&&e.report_lunch_list)||e.report_lunch_list.length===0)&&(!(e!=null&&e.report_dinner_list)||e.report_dinner_list.length===0)?r.jsx(T,{children:r.jsx(d,{colSpan:Math.max(1+(((q=e==null?void 0:e.breakfast_item_list)==null?void 0:q.length)||0)+(((G=e==null?void 0:e.lunch_item_list)==null?void 0:G.length)||0)+(((U=e==null?void 0:e.dinner_item_list)==null?void 0:U.length)||0),4),align:"center",sx:{border:"1px solid rgba(224, 224, 224, 1)",padding:"40px",fontSize:"16px",fontWeight:500,color:s.gray[500]},children:"No Report Found"})}):(()=>{var i,K,V;const t=[...((i=e==null?void 0:e.report_breakfast_list)==null?void 0:i.map(a=>a.room_no))||[],...((K=e==null?void 0:e.report_lunch_list)==null?void 0:K.map(a=>a.room_no))||[],...((V=e==null?void 0:e.report_dinner_list)==null?void 0:V.map(a=>a.room_no))||[]];return[...new Set(t)].map(a=>({room_no:a})).map((a,Ge)=>{var J,Q,X;const be=((J=e==null?void 0:e.report_breakfast_list)==null?void 0:J.find(p=>p.room_no===a.room_no))||{data:{},option:{}},je=((Q=e==null?void 0:e.report_lunch_list)==null?void 0:Q.find(p=>p.room_no===a.room_no))||{data:{},option:{}},ye=((X=e==null?void 0:e.report_dinner_list)==null?void 0:X.find(p=>p.room_no===a.room_no))||{data:{},option:{}};return r.jsxs(T,{children:[r.jsx(d,{align:"center",sx:{border:"1px solid rgba(224, 224, 224, 1)"},children:a.room_no}),[{row:be,itemList:e==null?void 0:e.breakfast_item_list,prefix:"b"},{row:je,itemList:e==null?void 0:e.lunch_item_list,prefix:"l"},{row:ye,itemList:e==null?void 0:e.dinner_item_list,prefix:"d"}].map(({row:p,itemList:Se,prefix:Z},De)=>r.jsx(Ae.Fragment,{children:(Se||[]).map((c,ee)=>{var te,ne,oe,ae,se;const re=(c==null?void 0:c.item_name)||"";let y=(te=p.data)==null?void 0:te[re];const m=(ne=p.option)==null?void 0:ne[re];let h="";c.real_item_name?h=c.real_item_name:c.data&&(Array.isArray(c.data)?h=((oe=c.data[0])==null?void 0:oe.real_item_name)||"":c.data.real_item_name&&(h=c.data.real_item_name));let S="",M="";if(Array.isArray(m))if(m.length>0&&((ae=m[0])==null?void 0:ae.date)&&((se=m[0])==null?void 0:se.items)){const _=[];m.forEach(n=>{n.date&&Array.isArray(n.items)&&n.items.forEach(k=>{k.itemName&&_.push(`${n.date}: ${h} - ${k.itemName}`)})}),S=_.join(", "),M=_.join(`
`)}else{const _=m.filter(n=>n&&(typeof n=="object"?n.itemName||n.optionName:n)).map(n=>{if(typeof n=="object"&&(n.itemName||n.optionName)){const k=n.itemName||n.optionName;return`${h} - ${k}`}return typeof n=="string"?`${h} - ${n}`:""}).filter(n=>n.trim().length>0);S=_.join(", "),M=_.join(`
`)}else typeof m=="string"&&(S=m,M=`${h} - ${m}`);const Ce=ee>=4&&y>=1&&S&&S.trim().length>0;return r.jsx(d,{align:"center",sx:{border:"1px solid rgba(224, 224, 224, 1)"},children:y==null?"-":Ce?r.jsx("span",{style:{textDecoration:"underline",cursor:"pointer",color:"#1976d2"},onClick:$=>{$.stopPropagation(),v({open:!0,anchorEl:$.currentTarget,text:M||"No option available"})},children:y}):y},`${Z}-${ee}`)})},`${Z}-meal-${De}`))]},a.room_no)})})()})]})}),r.jsxs(Oe,{open:j.open,anchorEl:j.anchorEl,onClose:()=>v({...j,open:!1}),anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},disableEnforceFocus:!0,disableRestoreFocus:!0,disableScrollLock:!0,PaperProps:{sx:{p:2,minWidth:200,maxWidth:400,pointerEvents:"auto",bgcolor:"#e3f2fd",borderRadius:2,boxShadow:3}},children:[r.jsx(Te,{variant:"body2",sx:{fontWeight:500,color:"#1976d2",mb:1,whiteSpace:"pre-line"},children:j.text||""}),r.jsx(D,{display:"flex",justifyContent:"flex-end",children:r.jsx($e,{onClick:()=>v({...j,open:!1}),sx:{background:"#1976d2",color:"#fff",borderRadius:2,padding:"4px 16px",fontWeight:600,fontSize:14,width:"auto",margin:0,"&:hover":{background:"#1565c0",color:"#fff"}},children:"OK"})})]})]})]})};export{or as default};
