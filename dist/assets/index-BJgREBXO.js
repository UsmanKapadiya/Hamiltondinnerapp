import{a as F,u as N,r as d,j as e,B as p,T as E,C as V}from"./index-PNbU5YHn.js";import{H as _,M as O,O as Y}from"./Header-C2mPu_Io.js";import{t as K}from"./js.cookie-BDMjQjOy.js";import{d as s,L as U,A as X,D}from"./AdapterDayjs-quBFncxs.js";import{T as $,M as q,P as J}from"./TextField-CV4eQBsw.js";import{M as Q}from"./Tooltip-C--yQL1z.js";import{I as Z}from"./IconButton-KS5eMaro.js";import{S as ee,T as re,a as te,b as oe,c as m,d as ae}from"./SummarizeOutlined-CXpgfGLK.js";import{T as h}from"./TableCell-r3SJcY9F.js";import"./api-ChbZ3Zh1.js";import"./InputAdornment-ByM_nYSb.js";const be=()=>{var M,R,T;const B=F(),I=N(),o=K(I.palette.mode),[g,L]=d.useState(s()),[l,W]=d.useState(s().startOf("month")),[c,G]=d.useState(s()),[i,b]=d.useState(!1),[t,f]=d.useState({}),[y,j]=d.useState([]),[u,A]=d.useState("Single Date Record"),[C,w]=d.useState(null);d.useEffect(()=>{u==="Single Date Record"&&(async()=>{var n;try{b(!0);const a=await Y.getReportList(g.format("YYYY-MM-DD")),x=Object.values(((n=a==null?void 0:a.result)==null?void 0:n.rows)||{});j(x),f(a)}catch(a){console.error("Error fetching menu list:",a)}finally{b(!1)}})()},[g,u]),d.useEffect(()=>{if(u==="Multiple Date Record"&&l&&c&&s(l).isValid()&&s(c).isValid()){if(s(c).isBefore(s(l),"day")){console.error("End date cannot be before start date"),j([]),f({});return}(async()=>{var n;try{b(!0);const a=await Y.getMultipleDateReportList(s(l).format("YYYY-MM-DD"),s(c).format("YYYY-MM-DD")),x=Object.values(((n=a==null?void 0:a.result)==null?void 0:n.rows)||{});j(x),f(a)}catch(a){console.error("Error fetching menu list:",a)}finally{b(!1)}})()}},[l,c,u]);const P=r=>{w(r.currentTarget)},S=()=>w(null),v=r=>Array.isArray(t==null?void 0:t.columns)&&Array.isArray(t.columns[r])?t.columns[r]:[],z=()=>!y||y.length===0;return e.jsxs(p,{m:"20px",children:[e.jsx(_,{title:"Report",profileScreen:!0}),e.jsxs(p,{mt:"40px",height:"75vh",flex:1,sx:{"& .MuiDataGrid-root":{border:"none"},"& .MuiDataGrid-cell":{border:"none"},"& .name-column--cell":{color:o.greenAccent[300]},"& .MuiDataGrid-columnHeaders":{backgroundColor:o.blueAccent[700],borderBottom:"none"},"& .MuiDataGrid-virtualScroller":{backgroundColor:o.primary[400]},"& .MuiDataGrid-footerContainer":{borderTop:"none",backgroundColor:o.blueAccent[700]},"& .MuiCheckbox-root":{color:`${o.greenAccent[200]} !important`},"& .MuiDataGrid-iconSeparator":{color:o.primary[100]}},children:[e.jsxs(p,{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2,children:[e.jsx(U,{dateAdapter:X,children:u==="Multiple Date Record"?e.jsxs(p,{display:"flex",gap:2,children:[e.jsx(D,{label:"Start Date",value:l,onChange:r=>W(r),maxDate:c,disabled:i,slotProps:{textField:{fullWidth:!0,variant:"filled",error:c&&l&&s(l).isAfter(s(c),"day"),helperText:c&&l&&s(l).isAfter(s(c),"day")?"Start date cannot be after end date":""}}}),e.jsx(D,{label:"End Date",value:c,onChange:r=>G(r),minDate:l,disabled:i,slotProps:{textField:{fullWidth:!0,variant:"filled",error:c&&l&&s(c).isBefore(s(l),"day"),helperText:c&&l&&s(c).isBefore(s(l),"day")?"End date cannot be before start date":""}}})]}):e.jsx(D,{label:"Date",value:g,onChange:r=>L(r),disabled:i,renderInput:r=>e.jsx($,{...r,variant:"filled",sx:{minWidth:200}})})}),e.jsxs(p,{display:"flex",alignItems:"center",gap:2,children:[e.jsx(Q,{title:i?"Loading...":"Reports",arrow:!0,children:e.jsx("span",{children:e.jsx(Z,{onClick:P,disabled:i,sx:{color:o.blueAccent[700],"&:hover":{backgroundColor:o.blueAccent[800],color:o.gray[100]},"&.Mui-disabled":{color:o.gray[500],opacity:.5}},children:e.jsx(ee,{sx:{fontSize:"28px"}})})})}),e.jsxs(q,{anchorEl:C,open:!!C,onClose:S,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},disableScrollLock:!0,children:[e.jsx(O,{selected:u==="Single Date Record",onClick:()=>{A("Single Date Record"),S()},children:"Single Date Record"}),e.jsx(O,{selected:u==="Multiple Date Record",onClick:()=>{A("Multiple Date Record"),S()},children:"Multiple Date Record"})]}),e.jsx(E,{variant:"subtitle1",sx:{fontWeight:600,cursor:i?"default":"pointer",color:i?o.gray[500]:o.blueAccent[700],opacity:i?.5:1,"&:hover":{color:i?o.gray[500]:o.blueAccent[500]},pointerEvents:i?"none":"auto"},onClick:()=>!i&&B("/charges"),children:"Charges"})]})]}),i?e.jsx(V,{}):z()?e.jsx(p,{display:"flex",justifyContent:"center",alignItems:"center",height:"50vh",children:e.jsx(E,{variant:"h5",sx:{fontWeight:600,color:o.gray[100]},children:"No Data Available for the selected date."})}):e.jsx(p,{sx:{overflowX:"auto",width:"100%"},children:e.jsx(re,{component:J,children:e.jsxs(te,{sx:{border:"1px solid rgba(224, 224, 224, 1)",borderCollapse:"collapse",minWidth:650},children:[e.jsxs(oe,{children:[e.jsx(m,{sx:{backgroundColor:o.blueAccent[700]},children:v(0).map((r,n)=>e.jsx(h,{align:"center",sx:{border:"1px solid rgba(224, 224, 224, 1)",whiteSpace:"nowrap"},...n===0?{rowSpan:r==null?void 0:r.rowspan}:{colSpan:r==null?void 0:r.colspan},children:r==null?void 0:r.title},n))}),e.jsx(m,{sx:{backgroundColor:o.blueAccent[700]},children:v(((M=t==null?void 0:t.columns)==null?void 0:M.length)-2).map((r,n)=>e.jsx(h,{align:"center",sx:{border:"1px solid rgba(224, 224, 224, 1)",whiteSpace:"nowrap"},children:r.title},n))}),e.jsx(m,{sx:{backgroundColor:o.blueAccent[700]},children:(R=t==null?void 0:t.columns)!=null&&R[1]&&typeof t.columns[1]=="object"&&!Array.isArray(t.columns[1])?Object.keys(t.columns[1]).map((r,n)=>e.jsx(h,{align:"center",sx:{border:"1px solid rgba(224, 224, 224, 1)",whiteSpace:"nowrap"},children:r},n)):null}),e.jsxs(m,{children:[e.jsx(h,{align:"center",sx:{border:"1px solid rgba(224, 224, 224, 1)",fontWeight:"bold",backgroundColor:o.primary[400],whiteSpace:"nowrap"}}),(T=t==null?void 0:t.columns)!=null&&T[1]&&typeof t.columns[1]=="object"&&!Array.isArray(t.columns[1])?Object.keys(t.columns[1]).map((r,n)=>{var a;return e.jsx(h,{align:"center",sx:{border:"1px solid rgba(224, 224, 224, 1)",fontWeight:"bold",backgroundColor:o.primary[400],color:o.redAccent[800],whiteSpace:"nowrap"},children:((a=t==null?void 0:t.total)==null?void 0:a[r])!==void 0?t.total[r]:""},n)}):null]})]}),e.jsx(ae,{children:y.map((r,n)=>{var x;const a=(x=t==null?void 0:t.columns)!=null&&x[1]&&typeof t.columns[1]=="object"&&!Array.isArray(t.columns[1])?Object.keys(t.columns[1]):[];return e.jsxs(m,{children:[e.jsx(h,{align:"center",sx:{border:"1px solid rgba(224, 224, 224, 1)",whiteSpace:"nowrap"},children:r.room_name||r.room_id}),a.map((k,H)=>e.jsx(h,{align:"center",sx:{border:"1px solid rgba(224, 224, 224, 1)",whiteSpace:"nowrap"},children:r[k]!==void 0?r[k]:""},H))]},n)})})]})})})]})]})};export{be as default};
