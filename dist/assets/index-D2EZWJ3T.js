import{c as De,j as r,u as Re,r as s,B as S,C as Me,R as ke,T as Ae}from"./index-BlhyXN4h.js";import{t as Te,C as ve}from"./js.cookie-D4_0Lw4j.js";import{H as $e,M as ae,O as le}from"./Header-J_MDh00G.js";import{d as m,L as Ee,A as we,D as v}from"./AdapterDayjs-46MJ7ncW.js";import{T as $,M as Le,P as Oe,c as Ye}from"./TextField-BP0bZSUc.js";import{M}from"./Tooltip-DiBI-KUx.js";import{I as ze}from"./IconButton-BWxRuJ-2.js";import{T as Ie,a as Ne,b as Pe,c as k,d as Be}from"./TableRow-DkKTxxHm.js";import{T as d}from"./TableCell-dnLuO_ab.js";import"./api-BysAAf_I.js";import"./InputAdornment-CdOpQQ0Y.js";const We=De(r.jsx("path",{d:"M15 3H5c-1.1 0-1.99.9-1.99 2L3 19c0 1.1.89 2 1.99 2H19c1.1 0 2-.9 2-2V9zM5 19V5h9v5h5v9zM9 8c0 .55-.45 1-1 1s-1-.45-1-1 .45-1 1-1 1 .45 1 1m0 4c0 .55-.45 1-1 1s-1-.45-1-1 .45-1 1-1 1 .45 1 1m0 4c0 .55-.45 1-1 1s-1-.45-1-1 .45-1 1-1 1 .45 1 1"}),"SummarizeOutlined"),nr=()=>{var z,I,N,P,B,W,F,G,H;const se=Re(),i=Te(se.palette.mode),[E,w]=s.useState(null),[x,ie]=s.useState(m().startOf("month")),[_,ce]=s.useState(m()),[C,de]=s.useState(m()),[pe,D]=s.useState(!1),[e,L]=s.useState({}),[Fe,ue]=s.useState(!0),[Ge,me]=s.useState(null),[u,O]=s.useState("Single Date Record"),[g,A]=s.useState({open:!1,anchorEl:null,text:""});s.useEffect(()=>{u==="Single Date Record"&&(async()=>{try{D(!0);const o=await le.getCharges(C.format("YYYY-MM-DD"));L(o)}catch(o){console.error("Error fetching menu list:",o)}finally{D(!1)}})()},[C,u]),s.useEffect(()=>{u==="Multiple Date Record"&&x&&_&&m(x).isValid()&&m(_).isValid()&&(async()=>{try{D(!0);const o=await le.getMultipleDateChargesReportList(m(x).format("YYYY-MM-DD"),m(_).format("YYYY-MM-DD"));L(o)}catch(o){console.error("Error fetching menu list:",o)}finally{D(!1)}})()},[x,_,u]);const he=t=>{t&&!t.isSame(C,"day")&&de(t),ue(!1)},fe=t=>{w(t.currentTarget)},xe=()=>{w(null)},Y=()=>me(null);return r.jsxs(S,{m:"20px",children:[r.jsx($e,{title:"Charges Report",profileScreen:!0}),r.jsxs(S,{mt:"40px",height:"75vh",flex:1,sx:{"& .MuiDataGrid-root":{border:"none"},"& .MuiDataGrid-cell":{border:"none"},"& .name-column--cell":{color:i.greenAccent[300]},"& .MuiDataGrid-columnHeaders":{backgroundColor:i.blueAccent[700],borderBottom:"none"},"& .MuiDataGrid-virtualScroller":{backgroundColor:i.primary[400]},"& .MuiDataGrid-footerContainer":{borderTop:"none",backgroundColor:i.blueAccent[700]},"& .MuiCheckbox-root":{color:`${i.greenAccent[200]} !important`},"& .MuiDataGrid-iconSeparator":{color:i.primary[100]}},children:[r.jsxs(S,{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2,children:[r.jsx(Ee,{dateAdapter:we,children:u==="Multiple Date Record"?r.jsxs(S,{display:"flex",gap:2,children:[r.jsx(v,{label:"Start Date",value:x,onChange:t=>ie(t),renderInput:t=>r.jsx($,{...t,fullWidth:!0,variant:"filled",sx:{gridColumn:"span 1"}})}),r.jsx(v,{label:"End Date",value:_,onChange:t=>ce(t),renderInput:t=>r.jsx($,{...t,fullWidth:!0,variant:"filled",sx:{gridColumn:"span 1"}})})]}):r.jsx(v,{label:"Date",value:C,onChange:he,renderInput:t=>r.jsx($,{...t,fullWidth:!0,variant:"filled",sx:{gridColumn:"span 1"}})})}),r.jsx(M,{title:"Reports",arrow:!0,children:r.jsx(ze,{onClick:fe,sx:{color:i.blueAccent[700],"&:hover":{backgroundColor:i.blueAccent[800],color:i.gray[100]}},children:r.jsx(We,{sx:{fontSize:"28px"}})})}),r.jsxs(Le,{anchorEl:E,open:!!E,onClose:xe,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},disableScrollLock:!0,children:[r.jsx(ae,{selected:u==="Single Date Record",onClick:()=>{O("Single Date Record"),Y()},children:"Single Date Record"}),r.jsx(ae,{selected:u==="Multiple Date Record",onClick:()=>{O("Multiple Date Record"),Y()},children:"Multiple Date Record"})]})]}),pe?r.jsx(Me,{}):r.jsx(Ie,{component:Oe,children:r.jsxs(Ne,{sx:{border:"1px solid rgba(224, 224, 224, 1)",borderCollapse:"collapse"},children:[r.jsxs(Pe,{children:[r.jsxs(k,{sx:{backgroundColor:i.blueAccent[700]},children:[r.jsx(d,{align:"center",sx:{border:"1px solid rgba(224, 224, 224, 1)"},rowSpan:2,children:"#"}),r.jsx(d,{align:"center",sx:{border:"1px solid rgba(224, 224, 224, 1)"},colSpan:((z=e==null?void 0:e.breakfast_item_list)==null?void 0:z.length)||0,children:"Breakfast"}),r.jsx(d,{align:"center",sx:{border:"1px solid rgba(224, 224, 224, 1)"},colSpan:((I=e==null?void 0:e.lunch_item_list)==null?void 0:I.length)||0,children:"Lunch"}),r.jsx(d,{align:"center",sx:{border:"1px solid rgba(224, 224, 224, 1)"},colSpan:((N=e==null?void 0:e.dinner_item_list)==null?void 0:N.length)||0,children:"Dinner"})]}),r.jsxs(k,{sx:{backgroundColor:i.blueAccent[700]},children:[(P=e==null?void 0:e.breakfast_item_list)==null?void 0:P.map((t,o)=>{const h=()=>{if(t.real_item_name)return t.real_item_name;if(t.data){if(Array.isArray(t.data))return t.data.map(c=>`${c.date}: ${c.real_item_name}`).join(`
`);if(t.data.real_item_name)return t.data.real_item_name}return t.item_name};return r.jsx(d,{align:"center",sx:{border:"1px solid rgba(224, 224, 224, 1)"},children:r.jsx(M,{title:h(),arrow:!0,children:r.jsx("span",{children:t.item_name})})},`breakfast-${o}`)}),(B=e==null?void 0:e.lunch_item_list)==null?void 0:B.map((t,o)=>{const h=()=>{if(t.real_item_name)return t.real_item_name;if(t.data){if(Array.isArray(t.data))return t.data.map(c=>`${c.date}: ${c.real_item_name}`).join(`
`);if(t.data.real_item_name)return t.data.real_item_name}return t.item_name};return r.jsx(d,{align:"center",sx:{border:"1px solid rgba(224, 224, 224, 1)"},children:r.jsx(M,{title:h(),arrow:!0,children:r.jsx("span",{children:t.item_name})})},`lunch-${o}`)}),(W=e==null?void 0:e.dinner_item_list)==null?void 0:W.map((t,o)=>{const h=()=>{if(t.real_item_name)return t.real_item_name;if(t.data){if(Array.isArray(t.data))return t.data.map(c=>`${c.date}: ${c.real_item_name}`).join(`
`);if(t.data.real_item_name)return t.data.real_item_name}return t.item_name};return r.jsx(d,{align:"center",sx:{border:"1px solid rgba(224, 224, 224, 1)"},children:r.jsx(M,{title:h(),arrow:!0,children:r.jsx("span",{children:t.item_name})})},`dinner-${o}`)})]})]}),r.jsx(Be,{children:(!(e!=null&&e.report_breakfast_list)||e.report_breakfast_list.length===0)&&(!(e!=null&&e.report_lunch_list)||e.report_lunch_list.length===0)&&(!(e!=null&&e.report_dinner_list)||e.report_dinner_list.length===0)?r.jsx(k,{children:r.jsx(d,{colSpan:1+(((F=e==null?void 0:e.breakfast_item_list)==null?void 0:F.length)||0)+(((G=e==null?void 0:e.lunch_item_list)==null?void 0:G.length)||0)+(((H=e==null?void 0:e.dinner_item_list)==null?void 0:H.length)||0),align:"center",children:"No Report Found"})}):(()=>{var c,q,U;const t=[...((c=e==null?void 0:e.report_breakfast_list)==null?void 0:c.map(a=>a.room_no))||[],...((q=e==null?void 0:e.report_lunch_list)==null?void 0:q.map(a=>a.room_no))||[],...((U=e==null?void 0:e.report_dinner_list)==null?void 0:U.map(a=>a.room_no))||[]];return[...new Set(t)].map(a=>({room_no:a})).map((a,He)=>{var K,V,J;const _e=((K=e==null?void 0:e.report_breakfast_list)==null?void 0:K.find(p=>p.room_no===a.room_no))||{data:{},option:{}},ge=((V=e==null?void 0:e.report_lunch_list)==null?void 0:V.find(p=>p.room_no===a.room_no))||{data:{},option:{}},be=((J=e==null?void 0:e.report_dinner_list)==null?void 0:J.find(p=>p.room_no===a.room_no))||{data:{},option:{}};return r.jsxs(k,{children:[r.jsx(d,{align:"center",sx:{border:"1px solid rgba(224, 224, 224, 1)"},children:a.room_no}),[{row:_e,itemList:e==null?void 0:e.breakfast_item_list,prefix:"b"},{row:ge,itemList:e==null?void 0:e.lunch_item_list,prefix:"l"},{row:be,itemList:e==null?void 0:e.dinner_item_list,prefix:"d"}].map(({row:p,itemList:je,prefix:Q},ye)=>r.jsx(ke.Fragment,{children:(je||[]).map((l,X)=>{var ee,re,te;const Z=(l==null?void 0:l.item_name)||"";let b=(ee=p.data)==null?void 0:ee[Z];const j=(re=p.option)==null?void 0:re[Z];let f="";l.real_item_name?f=l.real_item_name:l.data&&(Array.isArray(l.data)?f=((te=l.data[0])==null?void 0:te.real_item_name)||"":l.data.real_item_name&&(f=l.data.real_item_name));let R="",T="";if(Array.isArray(j)){const y=j.filter(n=>n&&(typeof n=="object"?n.optionName:n)).map(n=>{if(typeof n=="object"&&n.optionName){let ne=f;if(l.data&&Array.isArray(l.data)){const oe=l.data.find(Ce=>Ce.date===n.date);oe&&(ne=oe.real_item_name)}return`${n.date||""}: ${ne} - ${n.optionName}${n.timesSelected>1?` x${n.timesSelected}`:""}`}return typeof n=="string"?`${f} - ${n}`:""}).filter(n=>n.trim().length>0);R=y.join(", "),T=y.join(`
`)}else typeof j=="string"&&(R=j,T=`${f} - ${j}`);const Se=X>=3&&b>=1&&R&&R.trim().length>0;return r.jsx(d,{align:"center",sx:{border:"1px solid rgba(224, 224, 224, 1)"},children:b==null?"-":Se?r.jsx("span",{style:{textDecoration:"underline",cursor:"pointer",color:"#1976d2"},onClick:y=>{y.stopPropagation(),A({open:!0,anchorEl:y.currentTarget,text:T||"No option available"})},children:b}):b},`${Q}-${X}`)})},`${Q}-meal-${ye}`))]},a.room_no)})})()})]})}),r.jsxs(Ye,{open:g.open,anchorEl:g.anchorEl,onClose:()=>A({...g,open:!1}),anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},disableEnforceFocus:!0,disableRestoreFocus:!0,disableScrollLock:!0,PaperProps:{sx:{p:2,minWidth:200,maxWidth:400,pointerEvents:"auto",bgcolor:"#e3f2fd",borderRadius:2,boxShadow:3}},children:[r.jsx(Ae,{variant:"body2",sx:{fontWeight:500,color:"#1976d2",mb:1,whiteSpace:"pre-line"},children:g.text||""}),r.jsx(S,{display:"flex",justifyContent:"flex-end",children:r.jsx(ve,{onClick:()=>A({...g,open:!1}),sx:{background:"#1976d2",color:"#fff",borderRadius:2,padding:"4px 16px",fontWeight:600,fontSize:14,width:"auto",margin:0,"&:hover":{background:"#1565c0",color:"#fff"}},children:"OK"})})]})]})]})};export{nr as default};
