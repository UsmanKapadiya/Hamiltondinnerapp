import{a as z,u as H,r as i,j as r,B as p,T as k,C as F}from"./index-DrHUkdDh.js";import{H as N,M as w,O as E}from"./Header-CZlXKy6b.js";import{t as V}from"./js.cookie-mqi3WTk5.js";import{d as l,L as _,A as U,D as S}from"./AdapterDayjs-9GncV8Xb.js";import{T as $,M as q,P as J}from"./TextField-DAmcIe0t.js";import{M as K}from"./Tooltip-c1kDI2pV.js";import{I as Q}from"./IconButton-lhM-5VKA.js";import{S as X,T as Z,a as ee,b as re,c as x,d as te}from"./SummarizeOutlined-CjJSKHM_.js";import{T as u}from"./TableCell-DDMMk8dN.js";import"./api-YW602mA9.js";import"./InputAdornment-BO2_mt9y.js";const xe=()=>{var R,v,T;const Y=z(),O=H(),o=V(O.palette.mode),[f,B]=i.useState(l()),[n,I]=i.useState(l().startOf("month")),[c,L]=i.useState(l()),[W,g]=i.useState(!1),[t,m]=i.useState({}),[y,j]=i.useState([]),[d,C]=i.useState("Single Date Record"),[A,M]=i.useState(null);i.useEffect(()=>{d==="Single Date Record"&&(async()=>{var s;try{g(!0);const a=await E.getReportList(f.format("YYYY-MM-DD")),h=Object.values(((s=a==null?void 0:a.result)==null?void 0:s.rows)||{});j(h),m(a)}catch(a){console.error("Error fetching menu list:",a)}finally{g(!1)}})()},[f,d]),i.useEffect(()=>{if(d==="Multiple Date Record"&&n&&c&&l(n).isValid()&&l(c).isValid()){if(l(c).isBefore(l(n),"day")){console.error("End date cannot be before start date"),j([]),m({});return}(async()=>{var s;try{g(!0);const a=await E.getMultipleDateReportList(l(n).format("YYYY-MM-DD"),l(c).format("YYYY-MM-DD")),h=Object.values(((s=a==null?void 0:a.result)==null?void 0:s.rows)||{});j(h),m(a)}catch(a){console.error("Error fetching menu list:",a)}finally{g(!1)}})()}},[n,c,d]);const G=e=>{M(e.currentTarget)},D=()=>M(null),b=e=>Array.isArray(t==null?void 0:t.columns)&&Array.isArray(t.columns[e])?t.columns[e]:[],P=()=>!y||y.length===0;return r.jsxs(p,{m:"20px",children:[r.jsx(N,{title:"Report",profileScreen:!0}),r.jsxs(p,{mt:"40px",height:"75vh",flex:1,sx:{"& .MuiDataGrid-root":{border:"none"},"& .MuiDataGrid-cell":{border:"none"},"& .name-column--cell":{color:o.greenAccent[300]},"& .MuiDataGrid-columnHeaders":{backgroundColor:o.blueAccent[700],borderBottom:"none"},"& .MuiDataGrid-virtualScroller":{backgroundColor:o.primary[400]},"& .MuiDataGrid-footerContainer":{borderTop:"none",backgroundColor:o.blueAccent[700]},"& .MuiCheckbox-root":{color:`${o.greenAccent[200]} !important`},"& .MuiDataGrid-iconSeparator":{color:o.primary[100]}},children:[r.jsxs(p,{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2,children:[r.jsx(_,{dateAdapter:U,children:d==="Multiple Date Record"?r.jsxs(p,{display:"flex",gap:2,children:[r.jsx(S,{label:"Start Date",value:n,onChange:e=>I(e),maxDate:c,slotProps:{textField:{fullWidth:!0,variant:"filled",error:c&&n&&l(n).isAfter(l(c),"day"),helperText:c&&n&&l(n).isAfter(l(c),"day")?"Start date cannot be after end date":""}}}),r.jsx(S,{label:"End Date",value:c,onChange:e=>L(e),minDate:n,slotProps:{textField:{fullWidth:!0,variant:"filled",error:c&&n&&l(c).isBefore(l(n),"day"),helperText:c&&n&&l(c).isBefore(l(n),"day")?"End date cannot be before start date":""}}})]}):r.jsx(S,{label:"Date",value:f,onChange:e=>B(e),renderInput:e=>r.jsx($,{...e,variant:"filled",sx:{minWidth:200}})})}),r.jsxs(p,{display:"flex",alignItems:"center",gap:2,children:[r.jsx(K,{title:"Reports",arrow:!0,children:r.jsx(Q,{onClick:G,sx:{color:o.blueAccent[700],"&:hover":{backgroundColor:o.blueAccent[800],color:o.gray[100]}},children:r.jsx(X,{sx:{fontSize:"28px"}})})}),r.jsxs(q,{anchorEl:A,open:!!A,onClose:D,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},disableScrollLock:!0,children:[r.jsx(w,{selected:d==="Single Date Record",onClick:()=>{C("Single Date Record"),D()},children:"Single Date Record"}),r.jsx(w,{selected:d==="Multiple Date Record",onClick:()=>{C("Multiple Date Record"),D()},children:"Multiple Date Record"})]}),r.jsx(k,{variant:"subtitle1",sx:{fontWeight:600,cursor:"pointer",color:o.blueAccent[700],"&:hover":{color:o.blueAccent[500]}},onClick:()=>Y("/charges"),children:"Charges"})]})]}),W?r.jsx(F,{}):P()?r.jsx(p,{display:"flex",justifyContent:"center",alignItems:"center",height:"50vh",children:r.jsx(k,{variant:"h5",sx:{fontWeight:600,color:o.gray[100]},children:"No Data Available for the selected date."})}):r.jsx(Z,{component:J,children:r.jsxs(ee,{sx:{border:"1px solid rgba(224, 224, 224, 1)",borderCollapse:"collapse"},children:[r.jsxs(re,{children:[r.jsx(x,{sx:{backgroundColor:o.blueAccent[700]},children:b(0).map((e,s)=>r.jsx(u,{align:"center",sx:{border:"1px solid rgba(224, 224, 224, 1)"},...s===0?{rowSpan:e==null?void 0:e.rowspan}:{colSpan:e==null?void 0:e.colspan},children:e==null?void 0:e.title},s))}),r.jsx(x,{sx:{backgroundColor:o.blueAccent[700]},children:b(((R=t==null?void 0:t.columns)==null?void 0:R.length)-2).map((e,s)=>r.jsx(u,{align:"center",sx:{border:"1px solid rgba(224, 224, 224, 1)"},children:e.title},s))}),r.jsx(x,{sx:{backgroundColor:o.blueAccent[700]},children:b(((v=t==null?void 0:t.columns)==null?void 0:v.length)-1).map((e,s)=>r.jsx(u,{align:"center",sx:{border:"1px solid rgba(224, 224, 224, 1)"},children:(e==null?void 0:e.field)||""},s))}),r.jsxs(x,{children:[r.jsx(u,{align:"center",sx:{border:"1px solid rgba(224, 224, 224, 1)",fontWeight:"bold",backgroundColor:o.primary[400]}}),b(((T=t==null?void 0:t.columns)==null?void 0:T.length)-1).map((e,s)=>r.jsx(u,{align:"center",sx:{border:"1px solid rgba(224, 224, 224, 1)",fontWeight:"bold",backgroundColor:o.primary[400],color:o.redAccent[800]},children:(t==null?void 0:t.total[e.field])!==void 0?t==null?void 0:t.total[e.field]:""},s))]})]}),r.jsx(te,{children:y.map((e,s)=>r.jsxs(x,{children:[r.jsx(u,{align:"center",sx:{border:"1px solid rgba(224, 224, 224, 1)"},children:e.room_id}),Object.keys(e).filter(a=>a!=="room_id").map((a,h)=>r.jsx(u,{align:"center",sx:{border:"1px solid rgba(224, 224, 224, 1)"},children:e[a]},h))]},s))})]})})]})]})};export{xe as default};
